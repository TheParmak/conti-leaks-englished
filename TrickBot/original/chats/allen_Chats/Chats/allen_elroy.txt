[29.07.21 10:55:16] elroy:		Приветствую
[29.07.21 13:26:35] allen:		Привет
[29.07.21 13:27:22] allen:		Делаю. Завтра должен закончить с профайлом rundll.
[29.07.21 13:27:27] elroy:		У тебя в криптопанели логин allen ?
[29.07.21 13:27:59] allen:		Да
[29.07.21 13:28:49] elroy:		Я поправил там права, теперь можешь криптовать из панели, динчек там есть и утренние билды, показывает состояние стабов (криптует по утрам и пускает на тест)
[29.07.21 13:29:06] allen:		Ясно
[02.08.21 08:25:16] elroy:		Приветствую
[02.08.21 08:26:18] allen:		Привет. Доделываю. Сражался с SEH exception.
[02.08.21 08:26:57] allen:		Потом попрошу тебя мне помочь разобраться с Дженкинсом.
[02.08.21 08:27:28] elroy:		С дженкинсом без проблем, любые консультации. Я всем с ним помогал)
[02.08.21 08:27:48] elroy:		А есть профили, которые уже готовы и которые можно выложить?
[02.08.21 08:28:34] allen:		Пока только Default полностью.
[02.08.21 08:29:01] allen:		Через час-два будет готов rundll.
[02.08.21 08:29:45] elroy:		Ага, хорошо. Давай завтра тогда прицепим то что есть, а остальное тогда потом доделывай дальше...
[02.08.21 08:31:04] allen:		Цепляй.
[06.08.21 10:52:37] elroy:		Приветствую. Как успехи?
[06.08.21 12:54:23] allen:		Привет. Переделываю генератор, т.к. я использовал функции моей библиотеки для коллекционирования экспортируемых функций. А мне надо возможность коллекционирования из 32-битного приложения 64-битных функций. И наоборот.
[06.08.21 12:54:37] allen:		Отлаживаю код.
[06.08.21 12:55:05] elroy:		Ясно
[06.08.21 12:55:13] elroy:		Какой прогноз по готовности?
[06.08.21 12:55:30] allen:		К понедельнику, я думаю.
[06.08.21 12:55:37] elroy:		Хорошо
[09.08.21 11:14:14] allen:		Привет. Еще вчера закоммитил в ветку test. Надо бы проверить. Дополнитеьные ключи к build системе:
--profile rundll : имя профиля,
--entrypoint old_entry=new_entry,...
[09.08.21 11:15:50] elroy:		Приветствую. Надо проверить криптует или нет?
У дженкинса есть возможность указывать ветку для сборки.. Давай там и проверим
[09.08.21 11:16:12] allen:		Давай.
[09.08.21 11:16:45] allen:		Мне интересно, я не проверял ShelCode. Должно работать...
[09.08.21 11:16:56] elroy:		Я распишу что надо сделать)
[09.08.21 11:17:11] allen:		Давай. Пиши.
[09.08.21 11:21:51] elroy:		Зайди в дженкинс и выбери New item. Далее в поле напиши "crypter3_test_stub", а в поле внизу - crypter3_generic_exe. Нажми "ок".
Откроется страничка с параметрами для нового проекта на основе crypter3_generic_exe
[09.08.21 11:21:51] elroy:		Там надо поправить в Build Triggers поле Authentication Token, должно быть crypter3_test_stub (так же как и проект называется).
[09.08.21 11:23:09] elroy:		Затем пролистать вниз, там есть "Execute windows batch command", это команда вызова скрипта на билд, поправить как нужно
[09.08.21 11:23:43] elroy:		Branches to build и Branch Specifier (blank for 'any') - тут указывается ветка, откуда брать проект для билда
[09.08.21 11:23:48] elroy:		Собственно все)
[09.08.21 11:24:06] elroy:		Дальше "Save"
[09.08.21 11:24:31] elroy:		И можно делать крипт из панели, имя crypter3_test_stub сейчас добавлю в панель
[09.08.21 11:26:19] allen:		А вопрос. Мы же тестируем не generic, а rundll.
[09.08.21 11:27:24] allen:		И не только exe, но и dll?
[09.08.21 11:29:07] elroy:		Тестировать можно просто меняя настройки внутри тестового стаба. Когда оттестировали нужный профиль, то просто создаем его копированием точно так же. Указываем имя нового профиля (вот эти имена я выдаю, они строго должны совпадать), а внизу указываем crypter3_test_stub
[09.08.21 11:29:26] elroy:		У rundll например есть параметр entrypoint
[09.08.21 11:29:33] elroy:		Сейчас напишу как его добавиьт
[09.08.21 11:36:14] elroy:		This project is parameterized
там ниже 3 параметра, потом есть кнопка Add parameter, выбрать String Parameter, вписать в Name "entrypoint". Далее внизу где надо подставить имя этой entrypoint, в параметрах вызова скрипта добавить
```
%entrypoint%
```
[09.08.21 11:51:03] allen:		А как мне добавить параметр типа:
--32 : использовать 32-битную сборку
--64: использовать 64-битную сборку
?
[09.08.21 11:51:42] elroy:		Можно добавить. А скрипт сам не определяет? надо только указывать?
[09.08.21 11:52:54] allen:		А как скрипт может это определить??? И тем более для shellcode, где просто бинарная функция.
[09.08.21 11:53:37] elroy:		Ну именно скрипт - наверное никак) Я имел ввиду сборщик ведь сам определяет, когда крипт готовит?
[09.08.21 11:54:12] allen:		А как сборщик это передаст скрипту??
[09.08.21 11:55:35] elroy:		В текущем твоем проекте сделано автоопределение
[09.08.21 11:55:40] allen:		И shellcode опять же...
[09.08.21 11:55:46] elroy:		payloadgen ведь определяет
[09.08.21 11:55:57] elroy:		А для шеллкода надо только указывать
[09.08.21 11:56:34] allen:		Так как прописать параметры Genkins?
[09.08.21 11:57:27] elroy:		Вот в параметрах вызова, там где скрипт вызывается, там и указываешь, 32 или 64. А в имени проекта просто добавляется разрядность, например:
crypter2_rundll-shellcode_32_dll
crypter2_rundll-shellcode_64_dll
crypter2_shellcode_32_exe
...
[09.08.21 11:57:43] elroy:		Я же выше писал)
[09.08.21 11:58:13] elroy:		> Затем пролистать вниз, там есть "Execute windows batch command", это команда вызова скрипта на билд, поправить как нужно
[09.08.21 11:58:18] allen:		Ладно. Буду переваривать....
[09.08.21 11:58:59] elroy:		Перевари, буду вопросы - все распишу)
[11.08.21 09:42:45] allen:		Привет. А вот интересно, как мне протестить новый конфиг Genkins из криптопанели?
[11.08.21 11:11:00] elroy:		Приветствую. Чтобы сделать билд тестовым профилем из панели нужно открыть панели, выбрать вкладку (например testBuild - это наша тестовая для проверки криптеров, на ней есть тестовая нагрузка) и выбрать файл, справа от него нажать B (значек ключа гаечного), появится меню на билд, выбрать каким профилем и стабом сделать билд, для тестового Payload type - TestStub, а в Stubs profile - testing_crypter3
[11.08.21 11:11:56] elroy:		Справа в столбце Reports нажать ключ - откроется список билдов этого файла
[11.08.21 11:12:29] elroy:		Для каждого из них можно запросить проверку на статику, значек паука (первый), отчеты в столбце Reports
[11.08.21 11:32:10] allen:		Сейчас готовлю тестовый ShellCode....
[11.08.21 11:32:51] allen:		Затем буду у себя прогонять тестовые нагрузки, а потом уже перейду к криптопанели.
[11.08.21 11:37:18] elroy:		Шеллкоды тестовые написаны, лежат на вкладке testBuild, можно использовать.
[11.08.21 11:37:23] elroy:		На низ все криптеры тестили
[11.08.21 12:21:37] allen:		У меня этой вкладки нет.
[11.08.21 12:22:03] elroy:		Есть. Сделай ctr+f5
[11.08.21 12:22:06] allen:		Нет. Есть.
[13.08.21 08:08:17] allen:		Привет. Есть проблема со скриптом:

Я передаю ему параметр: --entrypoint DllRegisterServer=StartW
А он мне пишет: entrypoint DllRegisterServer

Видимо, он считает, что знак "=" - это разделитель параметров. Как быть, не знаешь?
[13.08.21 08:09:39] elroy:		У меня работает, очень странно. Момент, скину как у меня сделана обработка entrypoint
[13.08.21 08:15:04] elroy:		```
IF ["%entrypoint%"] == [""] (exit /B -1) ELSE (build.bat --type exe --payload %input_file% --out %output_file% --entrypoint %entrypoint%)
```
В таком варианте все приходит как строка вместе с =
Запись в дну строку должна быть
[13.08.21 08:21:15] allen:		Так у тебя используется %entrypoint%, а у меня !entrypoint! как переменная.
[13.08.21 08:21:27] allen:		Может, в этом дело?
[13.08.21 08:21:41] elroy:		Возможно
[13.08.21 08:22:57] elroy:		%entrypoint% передается в дженкинс так же как параметр %input_file% и %output_file%, там сверху настраивается строковый параметр
[13.08.21 08:24:56] allen:		Это понятно. у меня используется цикл:
for %%a in (%*) do (
*****
if !entrypointisnext! == 1 (
								if !entrypointisset! == 1 (
									set errormessage="Entry Point is repeated"
									goto error_invalid_argument
								)
								set entrypointisnext=0
								set entrypointisset=1
								set entrypoint=%%a
								echo entrypoint %%a
							) else
[13.08.21 08:26:16] elroy:		Я понял, он внутри скрипта портится
[13.08.21 08:26:29] allen:		И вот echo entrypoint %%a выдает "entrypoint DllRegisterServer". И этот же аргумент и передается дальше.
[13.08.21 08:30:14] elroy:		Понял. Надо его как-то в строку обернуть, за счет кавычек, что-то типа
--entrypoint "%entrypoint%"
или может
set entrypoint="%%a"
[13.08.21 08:32:26] allen:		Поставил set entrypoint="%%a", все равно выдает "DllRegisterServer"
[13.08.21 09:47:40] elroy:		А первый вариант пробовал?
[13.08.21 09:48:14] elroy:		Может удалить этот цикл?
[13.08.21 09:48:22] elroy:		Она не будет повторена
[16.08.21 07:32:56] allen:		Привет. Посмотри, пожалуйста на Дженкинс. Я там сделал кучу проектов. Но у всех у них иконка серая. Как сделать ее голубой?
[16.08.21 07:39:47] elroy:		Станет сама такой, когда пройдет первый билд.
[16.08.21 07:39:48] elroy:		Проекты - это хорошо, там очень важно чтобы были правильные имена. Иена не спрашивал, возможно придется покопировать с новыми именами.
[16.08.21 07:39:48] elroy:		Я напишу позже
[16.08.21 07:40:19] allen:		Хорошо
[16.08.21 07:40:44] allen:		А как ее заставить билдить?
[18.08.21 04:12:45] elroy:		Приветствую. Давай с дженкинсом разберемся
[18.08.21 07:51:30] allen:		Привет. Давай.
[18.08.21 07:52:57] elroy:		crypter3_generic_exe_dll_to_exe и crypter3_generic_exe_dll_to_dll чем по смыслу отличаются?
[18.08.21 07:53:59] allen:		Они отличаются типом сборки: у первого результат - exe, у второго - dll.
[18.08.21 07:54:39] elroy:		Ага, хорошо. А на входе может быть у обоих и exe и dll, так?
[18.08.21 07:54:45] allen:		Да
[18.08.21 07:55:09] elroy:		Скрипту не требуется сообщать что на входе, он сам поймет?
[18.08.21 07:55:18] allen:		Да
[18.08.21 07:55:28] allen:		Кроме ShellCode
[18.08.21 07:55:38] elroy:		А поймет по типу файла или по расширению, т.е. по имени?
[18.08.21 07:55:52] allen:		По заголовку.
[18.08.21 07:55:59] elroy:		Прекрасно.
[18.08.21 07:58:17] elroy:		Касательно имен, я как-то писал, что на каждый порфиль я их выдаю. Это сделано потому как профилей много, и легко сделать хаос. Поэтому я придерживаюсь порядка с именами. Вот касательно этих, должно быть:
crypter3_generic_exe
crypter3_generic_dll
Расширение справа означает обычно формат на выходе.
[18.08.21 07:58:35] elroy:		Поправь пожалуйста их путем копирования с нужным именем
[18.08.21 08:00:30] allen:		Поправил.
[18.08.21 08:01:12] allen:		Путем переименования.
[18.08.21 08:02:23] elroy:		Да, если переименование сработало.. Я как-то искал, не нашел сразу)
Хорошо
[18.08.21 08:02:37] elroy:		Я сейчас скину 3 документа
[18.08.21 08:05:35] elroy:		Download: https://qaz.im/load/rD3ka3/hY8d92
Delete: https://qaz.im/index.php?a=delete&q=1464089050
[18.08.21 08:07:59] elroy:		САИК содержит описание профилей в дженкинсе и дополнительная информация, это максимально-полная инструкция по параметрам, которые надо ставить при создании профилей. Обновение для САИК - это нужно сделать для всех своих профилей.
"точки вход" - это самая свежая версия, если я скидывал раньше - обнови у себя.
[18.08.21 08:09:29] elroy:		Build Triggers -> Authentication Token - это поле должно соответствовать имени профиля. Это надо для панели.
[18.08.21 08:10:52] elroy:		Имя на шеллкод 32 бита в exe на выходе должно быть таким:
crypter2_shellcode_32_exe
[18.08.21 08:15:11] allen:		Готово
[18.08.21 08:15:43] elroy:		Отлично. Теперь я добавлю в панели два профиля.
[18.08.21 08:16:03] elroy:		Разобрался как сделать крипт из панели?
[18.08.21 08:16:28] allen:		Без указания, какой профиль? (crypter3_shellcode_32_exe)
[18.08.21 08:16:54] elroy:		Уточни вопрос
[18.08.21 08:17:56] allen:		Может быть crypter3_generic_shellcode_32_exe для GENERIC? И crypter3_rundll_shellcode_32_exe для RUNDLL?
[18.08.21 08:19:46] elroy:		crypter3_shellcode_32_exe - да, без указания профиля для generic (просто сэкономили длину имени).
[18.08.21 08:20:02] elroy:		crypter7_rundll-shellcode_64_dll
[18.08.21 08:20:11] elroy:		Такое имя например для rundll
[18.08.21 08:21:49] elroy:		А exe криптуется в dll?
[18.08.21 08:22:21] elroy:		Это через hollowing работает в итоге?
[18.08.21 08:24:12] allen:		Не криптуется exe в dll для rundll. Для Generic криптуется.
[18.08.21 08:24:42] elroy:		Ясно
[18.08.21 08:27:05] elroy:		Я добавил профили в панель. Проверь, как оно работает из панели
[18.08.21 08:38:15] allen:		Я вижу, ты добавил dll_generic_crypter3, но не exe_generic_crypter3. Почему?
[18.08.21 08:39:43] elroy:		Такой формат. Так проще смотреть тем, кто криптует и имя в дженкинсе может быть несколько разных на одно и то же имя в панели (работает фильтр, отбирает нужный, но пользователю с одним именем показывается)
[18.08.21 08:40:26] elroy:		Я добавил оба профиля
[18.08.21 08:40:29] elroy:		И шеллкод
[18.08.21 08:40:35] elroy:		Всего в панели три
[19.08.21 07:13:36] allen:		Привет. 2 вопроса:
1) Как из криптопанели запустить криптование?
2) Ты не добавил мне криптование RUNDLL. Только Generic.
[19.08.21 07:18:32] elroy:		Зайти в криптопанель, на вкладке выбрать файл, в столбце Actions нажать B, откроется окошко, там выбрать профиль и стаб
[19.08.21 07:18:36] allen:		Проекты переименованы.
[19.08.21 07:20:53] allen:		У меня на вкладке Actions только скачать файл и удалить файл ((
[19.08.21 07:21:37] elroy:		Извини, не Actions, а Check
[19.08.21 07:22:50] elroy:		В дженкинсе не был настроен фильтр на остальные твои профили, только на 3, я не увидел. Сейчас обновил фильтр, увидел профили, добавлю, возможно сегодня.
[19.08.21 07:24:03] elroy:		Думаю после обеда получится добавить, сейчас пока запарка с другой стороны
[19.08.21 07:24:17] allen:		Ясно
[19.08.21 11:00:21] elroy:		Добавили криптер, проверь
[19.08.21 11:01:34] allen:		Вижу.
[19.08.21 11:01:58] elroy:		Проверь, имею введу, сборку каждого профиля
[20.08.21 10:17:14] allen:		Привет.
1) Удали, пожалуйста, файл dl6_release_nologs_group_6_ver_1_34_x64_rundll32.dll с вкладки Uncrypted (он у меня не удаляется).
2) Почему у меня нет ни одного rundll профиля в выборе действий? Одни generic.
[20.08.21 10:17:36] elroy:		Приветствую. Не видно сообщения
[20.08.21 10:17:39] allen:		Привет.
1) Удали, пожалуйста, файл dl6_release_nologs_group_6_ver_1_34_x64_rundll32.dll с вкладки Uncrypted (он у меня не удаляется).
2) Почему у меня нет ни одного rundll профиля в выборе действий? Одни generic.
[20.08.21 10:18:21] allen:		Хотя в Stubs присутствуют и rundll...
[20.08.21 10:18:44] elroy:		Зависит от выбираемого файла. Выбираешь dll ?
[20.08.21 10:19:04] allen:		Да
[20.08.21 10:19:26] elroy:		dl6_release_nologs_group_6_ver_1_34_x64_rundll32.dll -
[20.08.21 10:19:33] elroy:		это твой файл?
[20.08.21 10:19:47] allen:		Да.
[20.08.21 10:19:58] allen:		Его удали.
[20.08.21 10:20:44] allen:		Мне его Wild дал. Он сказал при билде никакие параметры не ставил.
[20.08.21 10:22:05] elroy:		Смотри, например, rob125.dll
[20.08.21 10:22:21] allen:		Это тоже rundll,
[20.08.21 10:22:29] elroy:		Payload type - там выбираем rundll
[20.08.21 10:22:33] elroy:		Нет
[20.08.21 10:22:47] elroy:		Мы же любой файл можем выбрать на крипт
[20.08.21 10:22:55] elroy:		Это для примера
[20.08.21 10:23:44] allen:		В профиле rundll у меня, если ни одна функция не экспортируется, генерируется ошибка.
[20.08.21 10:25:11] elroy:		Правильно
[20.08.21 10:25:53] allen:		У меня не обрабатывется скриптом команда --entrypoint (пустой)
[20.08.21 10:27:38] allen:		Я, кажется, понял, как это сделать.... Момент...
[20.08.21 10:27:51] elroy:		Я скидывал как это сделать
[20.08.21 10:29:06] allen:		Нет. Дело в порядке команд. Если --entrypoint будет последним, его значение не будет иметь особого смысла...
[20.08.21 10:35:18] allen:		Для rob125.dll выбор тоже только из generic...
[20.08.21 10:36:08] elroy:		Payload type - стоит generic ?
[20.08.21 10:36:54] elroy:		Выбери Payload type - rundll32
Будет список из только rundll
[20.08.21 10:37:11] allen:		Все. Увидел.
[20.08.21 10:38:02] elroy:		На вкладке testBuild есть библиотеки rundll_32 и 64, это тестовые, hello world
[20.08.21 10:38:12] elroy:		Можно криптовать там и смотреть..
[20.08.21 10:38:29] allen:		Ясно
[20.08.21 10:53:26] allen:		А где можно посмотреть резудбтирующий лог билда?
[20.08.21 10:54:28] allen:		И по какому критерию идет оценка, что билд фэйлд?
[20.08.21 11:07:11] elroy:		Если скрипт вернул 0 - success, не 0 - failed
[20.08.21 11:07:33] elroy:		exit /B 0 для bat
[20.08.21 11:10:23] elroy:		Можно посмотреть в дженкинсе вывод в консоль команд билда. Для этого надо открыть профиль, в списке слева внизу выбрать нужный билд, подвести мыш к стрелочке и ам выбрать Console output.
Посмотреть логи сборки можно в workspace, если он ведется, либо в артифактах. Артифакты - так же, выбирается нужный билд в профиле, открываем его и там список файлов - artifacts
[20.08.21 11:16:51] allen:		У меня нет списка билдов...
[20.08.21 11:17:33] elroy:		Если нет - значит профиль не вызывался
[20.08.21 11:17:45] elroy:		Какой профиль?
[20.08.21 11:17:55] allen:		Как не вызывался????
[20.08.21 11:19:06] allen:		Посмотри на имя профиля: crypter3_rudll_dll. Он соответствует тому, что прописан в stubs,
[20.08.21 11:19:29] elroy:		Сейчас, момент
[20.08.21 11:21:43] elroy:		https://43oxsnqlub6aydymkwpn3agaaj7u2qexx4vwybgrwug46c6yldhuheid.onion/crpanel/#/stubList
[20.08.21 11:22:03] elroy:		Найди там crypter3_rundll_dll
[20.08.21 11:22:26] elroy:		Мне показывает по нулям
[20.08.21 11:24:52] elroy:		dll_rundll_crypter3 соответствует dll_rundll_crypter3
[20.08.21 11:25:33] allen:		Понятно. У меня до сих пор крутится в значке BIULD....
[20.08.21 11:26:09] allen:		Хотя в отчетах 4 фейла
[20.08.21 11:26:20] elroy:		Говорил же!
Build Triggers -> Authentication Token
Имя должно соответствовать профилю. Там прописан generic_exe
[20.08.21 11:27:15] elroy:		Проверь во всех профилях. Иначе не будет работать...
[20.08.21 11:42:17] allen:		Проблема. В Console output:

*****
[20.08.21 11:42:19] allen:		1 file(s) copied.
Archiving artifacts
Finished: SUCCESS
[20.08.21 11:43:01] allen:		Это означает, что сборка была успешной! А в криптопанели: FAILED.
[20.08.21 11:43:58] allen:		А, нет все нормально. Я не увидел. Зрение, блин....
[20.08.21 11:45:11] elroy:		ок, т.е. первый есть?
[20.08.21 11:45:27] allen:		Да.
[20.08.21 11:45:36] elroy:		Отлично)
[20.08.21 11:46:15] elroy:		Там же в панели есть скан да ничеке закриптованного файла, там кнопка S первая в столбце
[20.08.21 11:46:22] elroy:		Там же где и B
[20.08.21 11:46:38] allen:		Я понял.
[20.08.21 11:57:51] allen:		У меня по статике нашлась одна проблема:
Webroot SecureAnywhere .........................	Detected [ Malware ]
[20.08.21 11:58:25] elroy:		Это не проблема
[20.08.21 11:58:36] elroy:		Этот АВ исключается обычно из скана
[20.08.21 11:58:52] elroy:		Панель настроена тоже исключать, но там баг и он снова появился
[20.08.21 11:59:02] elroy:		Если других нет - то прекрасно
[20.08.21 11:59:12] allen:		Да
[20.08.21 11:59:42] allen:		Продолжу делать остальные 2 профиля: BK и LEO.
[20.08.21 12:01:46] elroy:		А сами файлы работают закриптованные?
[20.08.21 12:02:39] allen:		Я криптовал свои файлы - все работало.
[20.08.21 12:03:43] allen:		Насчет рабочих нагрузук не пробую, т.к. не знаю, что они должны делать (
[20.08.21 12:04:19] allen:		Это пусть авторы пробуют.
[20.08.21 12:04:36] elroy:		Правильно)
[20.08.21 12:05:32] allen:		Shellcode взял из testBuild. Все работало - отобразился MessageBox Hello world.
[20.08.21 12:05:43] allen:		И для 32 и для 64.
[20.08.21 12:06:53] elroy:		Тогда все отлично
[20.08.21 13:41:45] elroy:		Тебе напишет wild, у него не заработал закриптованный бот. Бот логированный, но даже лог не создается, т.е. файл не запускается. Разеберись почему, на локлаьной машине не запускай, только на тестовой
[20.08.21 13:42:42] allen:		Я понял. Он уже связался со мной.
[24.08.21 08:17:18] allen:		Привет. Я не знаю, что Wild делает, но у меня показывает, что все вызывается.
[24.08.21 08:18:08] elroy:		У знай у него что он делает. Нет ли проблемы со сборкой, версия /MT или /MD
[24.08.21 08:18:19] elroy:		Приветствую)
[24.08.21 08:22:36] allen:		Версия /MT. Я у него спросил, он сказал, что не помнит командную строку, как вызывал. Если он вызывал несуществующую функцию, то естественно, что она не вызвалась. Я сейчас сделаю билды с логированием (OutputDebugStringA). Ты подключишь их в криптопанель (суффикс _log). И пусть Wild снова попробует, но с DebugView.
[24.08.21 08:23:20] elroy:		Хорошо, давай так с делаем
[24.08.21 08:41:04] allen:		Готово.
[24.08.21 08:45:08] elroy:		Добавил
[24.08.21 08:49:17] allen:		Когда Wild появится, крякни ему. Я тоже.
[24.08.21 08:49:52] elroy:		ок
[31.08.21 14:09:28] allen:		Привет. Заработало. Была м а л е н ь к а я ошибка, как всегда. Но найти ее было долго.
[31.08.21 14:10:53] allen:		Мне тут Orval подкинул задачу просчитать hash. Так что остальные 2 профиля откладываются.
[31.08.21 14:11:01] elroy:		А что хоть за ошибка?)
[31.08.21 14:11:01] elroy:		ПРиветствую
[31.08.21 14:11:31] elroy:		В приоритете - да, посчитать хеши. Потом вернись к двум профилям..
[31.08.21 14:12:00] allen:		Ошибка состяля в генераторе исходников: jmp не в том месте.
[31.08.21 14:12:09] elroy:		Хеши можно за пол дня посчитать, он наверное скинул скрипт на питоне.
[31.08.21 14:12:20] elroy:		Ааа))
[31.08.21 14:12:21] elroy:		Бывает)
[31.08.21 14:13:29] allen:		Я потерял, если он и скинул. Не помню. Это было в прошлый четверг, по-моему.
[31.08.21 14:14:56] elroy:		```
Ссылка на скачивания архива с бинарником
https://github.com/ssdeep-project/ssdeep/releases/download/release-2.14.1/ssdeep-2.14.1-win32-binary.zip

1. Распаковываем архив
2. Собираем n (10) криптов одной и той же сборкой
3. Складываем их все в одну папку (samples)
4. Генерируем файл с сигнатурами криптов:
ssdeep\ssdeep.exe -b ssdeep\samples\* > ssdeep\signatures.txt

5. Сравниваем каждую сигнатуру с каждым криптом:
ssdeep\ssdeep.exe -m ssdeep\signatures.txt -b -a -s ssdeep\samples\*

скрипт на питоне для автоматизации

import os
import sys

cryptors_count = 10
cryptor_parameters = 'main.py --profile generic --type exe --payload payloads\\hello86.exe --out ssdeep\\samples\\'
generate_hashes_cmd = 'ssdeep\\ssdeep.exe -b ssdeep\\samples\* > ssdeep\\signatures.txt'
compare_hashes_cmd = 'ssdeep\\ssdeep.exe -m ssdeep\\signatures.txt -b -a -s ssdeep\\samples\*'


def remove_samples():
    for f in os.listdir('ssdeep\\samples'):
        os.remove(os.path.join('ssdeep\\samples', f))


def generate_crypts():
    for i in range(0, cryptors_count):
        os.system(sys.executable + ' ' + cryptor_parameters + str(i) + '.exe')


def compare_hashes():
    os.system(generate_hashes_cmd)
    os.system(compare_hashes_cmd)


def main():
    remove_samples()
    generate_crypts()
    compare_hashes()


if __name__ == "__main__":
    main()

но его под себя надо будет перестраивать
```
[31.08.21 14:18:14] allen:		*Собираем n (10) криптов одной и той же сборкой*
Каких криптов? Моих? С каким профилем?
[31.08.21 14:18:50] elroy:		Каждый профиль 10 криптов
[31.08.21 14:19:30] elroy:		Ну еще и по архитектурам, x86 - 10, x64 - 10
[31.08.21 14:19:55] allen:		Моих криптов?
[31.08.21 14:19:59] elroy:		dll->exe и exe->exe в общем-то одно и то же, там наверное будет лишним...
[31.08.21 14:20:01] elroy:		Да
[31.08.21 14:20:12] elroy:		Возьми любую нагрузку и покриптуй ее
[31.08.21 14:20:29] elroy:		Сделай наборы криптов, посравнивай, как по инструкции
[31.08.21 14:20:50] allen:		Ясно
[02.09.21 07:47:06] elroy:		Приветствую
[02.09.21 09:21:38] allen:		Привет.
[02.09.21 09:22:21] elroy:		Нужен сегодня криптер чистый для порфиля x64 шеллкод exe
[02.09.21 09:22:49] allen:		Есть такой у меня.
[02.09.21 09:23:06] elroy:		На билдмашине он есть?
[02.09.21 09:23:08] allen:		Профиль default/
[02.09.21 09:23:32] allen:		На билд машине.
[02.09.21 09:24:25] elroy:		Хорошо, спасибо, смотрю
[02.09.21 09:29:38] elroy:		Собирал файл, не собрался.
exe_shellcode_64_crypter3
Глянь по логам, что там не так
[02.09.21 09:38:15] allen:		Еще раз, как в логи залезть?
[02.09.21 09:43:05] allen:		Не найден devenv.exe
[02.09.21 09:46:08] elroy:		Поправь адрес в скрипте
[02.09.21 09:46:17] elroy:		Какой там сейчас?
[02.09.21 09:46:49] allen:		set msbuild="C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\devenv.exe"
[02.09.21 09:48:56] elroy:		Странно, адрес правильный. Сейчас гляну
[02.09.21 09:49:29] elroy:		А вручную можешь сделать?
[02.09.21 09:49:37] elroy:		крипт
[02.09.21 09:50:17] allen:		У меня Professional
[03.09.21 08:48:19] elroy:		Приветствую еще раз
[03.09.21 08:48:33] elroy:		Есть требование новое для rundll и для всех зависимых профилей, пропускать при генерации функцию с именем DllMain из таблицы экспорта нагрузки.
Т.е. чтобы это имя не накладывалось на реальную функцию с таким же именем в коде
[03.09.21 08:49:05] elroy:		(обычно у всех ишбка компиляции)
[03.09.21 08:50:44] allen:		Это еще что? Функция DllMain в таблице экспорта? Это кто придумал?
[03.09.21 08:50:57] elroy:		Кто-то придумал))
[03.09.21 08:51:07] elroy:		И теперь у нас криптеры не собираются))
[03.09.21 08:51:49] allen:		Ясно. Момент. Поправлю...)
[03.09.21 08:52:09] allen:		Кстати, когда зп? Не в курсе?
[03.09.21 08:53:28] elroy:		frances обещал до пятницы
[03.09.21 08:53:35] elroy:		Сам жду
[03.09.21 08:54:10] allen:		Это только обещал. А где он сам? Не в отпуске?
[03.09.21 08:54:19] elroy:		Не, не в отпуске
[03.09.21 08:54:41] elroy:		Он ближе к ночи появляется
[03.09.21 08:54:55] elroy:		Занят чем-то наверное...
[03.09.21 08:55:07] allen:		Наверное...
[03.09.21 09:02:49] allen:		Готово
[03.09.21 10:59:00] elroy:		На месте?
[07.09.21 06:50:21] allen:		Привет. Еще раз, опиши проблему моей уязвимости.
[07.09.21 06:51:05] allen:		Я сегодня и вчера работаю с elijah по его проблеме.
[07.09.21 06:53:51] elroy:		Привет. Какой именно проблемы? Я что-то слабо помню..
[07.09.21 07:22:10] allen:		Проблемы с его нагрузкой, что мой стаб плохо работает с его ProcessHolowing.
[07.09.21 07:28:16] elroy:		Будет wild, около 12.00 мск, сделают сборку еще раз проверят, скажут что не так
[07.09.21 07:28:58] elroy:		Из прошлых проблем
```
elijah писал что в 3 стабе какие-то проверки делаются, из-за них не работает когда он крипт перезапускает бесфайлово
```
[08.09.21 07:01:18] elroy:		Приветствую. Если что-то писал, не пришло
[08.09.21 07:03:43] allen:		Привет. Ничего не писал. Что ты мне говорил по поводу детектов? Типа того, что с ними встречались, они по причине пустой DllMain в нагрузке. Что это значит и как с этим бороться?
[08.09.21 07:05:21] elroy:		А, эти два детекта у нас проявлялись вот именно со стандартной DllMain. Бороться просто, набить ее мусором каким-то
[08.09.21 07:07:49] allen:		В нагрузке? Как я-то набью???
[08.09.21 07:08:38] elroy:		Никак) Не в нагрузке, а в стабе криптера
[08.09.21 07:09:07] elroy:		Если на exe, то там тоже, надо расширить main()
[08.09.21 07:12:36] allen:		Только у меня в DllMain как раз вся магия и осуществяется...
[08.09.21 07:13:33] allen:		Нало чесать репу...
[08.09.21 14:23:07] allen:		Ты включил лог только для rundll у меня. Включи еще для generic exe/
[14.09.21 14:36:01] elroy:		Приветствую
[15.09.21 09:10:00] allen:		Привет
[15.09.21 09:10:27] elroy:		Приветствую
[15.09.21 09:10:44] allen:		Привет
[15.09.21 09:11:20] elroy:		Я с 16 по 30 в отпуске, вместо меня collin и orval
(не помню писал или нет)
[15.09.21 09:12:22] allen:		Хорошо. Я сейчас нормально переделываю криптор. Будет CR3. На асме. C кода не будет.
[15.09.21 09:13:18] elroy:		А си код вызывает проблемы?
[15.09.21 09:13:35] allen:		Слишком большой.
[15.09.21 09:13:49] allen:		И толстый.
[15.09.21 09:13:59] elroy:		Меня больше беспокоит чистота от детектов.
[15.09.21 09:14:11] elroy:		Делать будешь долго, но эффективно ли...
[15.09.21 09:14:11] allen:		Уже чистый.
[15.09.21 09:14:31] allen:		Нет. Не долго..
[15.09.21 09:14:39] elroy:		А как насчет шеллкода профилем rundll, будет чистый тоже?
[15.09.21 09:14:49] allen:		Да
[15.09.21 09:15:51] elroy:		Ок, спасибо, попробуем. Хорошо, делай cr3 )
[22.10.21 08:09:17] allen:		Привет. ОТР?
[25.10.21 14:59:25] elroy:		Приветствую. Пришло пустое сообщение
[25.10.21 14:59:59] elroy:		Приветствую. Пришло пустое сообщение
[25.10.21 15:02:21] elroy:		Пробуй
[25.10.21 15:03:14] elroy:		Но разбавлять придется постоянно.. Криптеры приходится переписывать.
Поищи обфускаторы ассемблерного кода
[25.10.21 15:03:45] elroy:		Значит видит что код делает
[25.10.21 15:06:21] elroy:		Пробуй все идеи
[28.10.21 12:22:43] elroy:		Приветствую
[28.10.21 14:20:38] elroy:		Приветствую
[28.10.21 14:21:52] elroy:		Профиль bk, закриптовал нагрузку, запустили, получилось это:
```
после старта через батник, cmd не закрылся, висит два rundll32.exe видимо не завершился первичный процесс, поэтому и окно висит. А функционал полностью выполнился
```
[28.10.21 14:22:43] elroy:		Что может быть, глянешь?
[28.10.21 14:34:17] elroy:		Не исключено, что был вызван ExitProcess, скорее всего. Ты бы мог починить это место?
[28.10.21 14:37:37] elroy:		Могу файлик скинуть
[28.10.21 14:40:23] elroy:		Скорее всего вот это делает
[28.10.21 14:40:27] elroy:		```
case DLL_PROCESS_ATTACH:


aaa = hinstDLL;
cmdl = GetCommandLine();


if (cmdl) {
if (StrStrA(cmdl, _STR("rundll32"))) {


if (!StrStrA(cmdl, _STR(",#1"))) {

char fname[MAX_PATH] = "";

GetModuleFileNameA((HMODULE)hinstDLL, fname, sizeof(fname));

debug_printf("%s(): fname = %s", __FUNCTION__, fname);

char cmd_path[1024];
char cmd_arg[1024];

lstrcpyA(cmd_path, _STR("C:\\Windows\\SysWOW64\\rundll32.exe"));
lstrcpyA(cmd_arg, cmd_path);
lstrcatA(cmd_arg, " ");
lstrcatA(cmd_arg, fname);
lstrcatA(cmd_arg, _STR(",#1"));


STARTUPINFO si;
PROCESS_INFORMATION pi;

ZeroMemory(&si, sizeof(si));
si.cb = sizeof(si);
ZeroMemory(&pi, sizeof(pi));
CreateProcess(cmd_path, cmd_arg, NULL, NULL, FALSE, 0, NULL, NULL, &si, &pi);
ExitProcess(0);
}

}
}
break;
```
[28.10.21 14:46:16] elroy:		Сделай обработчик закрытия.
[29.10.21 07:55:48] allen:		Привет. ОТР?
[29.10.21 07:58:24] elroy:		В приоритете почситить профиль бк и переделать дежурку, потом x86
[29.10.21 08:04:42] elroy:		Да, нагрузка 32 битная таки
[29.10.21 08:04:57] elroy:		Да, согласен, значит в приоритете все вышеописанное))
[29.10.21 09:54:36] elroy:		Скажи, а ты обрабатываешь ошибки на асме, скажем, вызов не существующего опкоду куда приведет?
[29.10.21 11:02:29] elroy:		Вот скажем есть инструкция rdrand, она на одних цп реализована, на других нет.
Мысль такая, проверить ее поддержку через cpuid и вызвать, если ее нет. Куда попадем? Есть обработчик у тебя?
Подобная техника позволяет бороться с эмуляторами АВ. Например, может быть так, что на цп, где инструкция не поддерживается она отработате корректно на эмуляторе, можно будет понять, что мы в эмуляции.
[29.10.21 11:03:27] elroy:		Ну именно эта нет.. Я про саму идею
[29.10.21 11:03:36] elroy:		Бороться с эмуляторами ведь надо
[29.10.21 11:14:40] elroy:		А мютекс рандомный?
[29.10.21 11:14:57] elroy:		Имя ы смысле
[02.11.21 08:07:49] allen:		Привет. По просьбе orval сделал профайл ET. Создай, пожалуйста, стаб.
[02.11.21 08:08:21] elroy:		Приветствую. Ок, сейчас)
[02.11.21 08:08:35] elroy:		Как с чисткой дела?
[02.11.21 08:09:31] allen:		32- битный пока никак. Не побежу никак AhnLab V3 Light. Даже с пустым криптором выдает: Malware/Win32.Generic. ((
[02.11.21 08:09:55] allen:		Чешу репу, что сделать...
[02.11.21 08:11:06] elroy:		А проблему с мютексом решил?
[02.11.21 08:11:46] allen:		Пока не решал.
[02.11.21 08:12:14] elroy:		В профиле ET это критично
[02.11.21 08:22:31] allen:		Значит, вперед решить. Но сегодня у меня д.р. Нверное я в субботу отработаю за сегодня. Хотя, может быть и сделаю. Кстати, на что делать хук для закрытия приложения? На ExitProcess?
[02.11.21 08:23:21] elroy:		Возможно.
[02.11.21 08:23:32] elroy:		Хорошо. Поздравляю!))
[02.11.21 08:23:52] allen:		Спасибо.
[02.11.21 10:49:44] elroy:		Как будешь - напиши
[02.11.21 10:51:36] allen:		Я тут. Изучаю. вопрос.
[02.11.21 10:52:24] elroy:		Новая задача от silver
Нужно хранить сделанные крипты минимум две недели.
Нужно вести учет билдов и нагрузок.
Что за нагрузка, от кого получена + дата и время, чем закриптована, хеши.
Нужно иметь возможность выдать такую информацию по запросу (за последние две неделеи).
Это для ручных криптов, для панели что-то придумаем
[02.11.21 10:52:32] elroy:		Хеши считать sha1
[02.11.21 10:53:05] allen:		Понял.
[02.11.21 10:53:45] allen:		У меня дома сервер на линухе. На нем можно собирать всю эту инфу.
[02.11.21 10:54:32] elroy:		Шифруй только хорошенько)
[03.11.21 10:32:30] elroy:		Вот
[03.11.21 10:32:33] elroy:		Это хорошо
[03.11.21 10:32:51] elroy:		Проблема со сборкой крипта профилем et - не собирается
[03.11.21 10:33:01] elroy:		Поправь
[03.11.21 10:33:19] allen:		Посмотрю.
[03.11.21 11:57:40] allen:		Вроде сделал.
[03.11.21 12:16:25] elroy:		Теперь почистить надо
[03.11.21 12:16:40] elroy:		```
https://dyncheck.com/scan/id/1b577d0ecd5da4691de8a0362403d2e6
https://dyncheck.com/scan/id/da1b3e5f6bf686695c2542dca48b298c
```
[03.11.21 12:18:15] elroy:		В автокриптах ET-Loader-x86
[03.11.21 12:32:16] allen:		Я же сказал, что для x86 еще не готово.
[10.11.21 08:19:32] allen:		Привет. ОТР?
[10.11.21 08:20:12] elroy:		Приветствую
[10.11.21 08:22:47] allen:		Я тут вчера с Wild'ом работал и выяснилось, что если билдить на билд машине стабильно идут 2 детекта, если вручную, то детектов нет:

На билд-машине: https://dyncheck.com/scan/id/fd0544d05a9e3417c9410395503b6e29
Вручную: https://dyncheck.com/scan/id/f189e6de0cf8bdb18fc7c6858730037c
[10.11.21 08:23:27] allen:		Похоже, проблема с ГИТ. Он выкачивает не ту версию.
[10.11.21 08:24:18] elroy:		Повтори собщения пожалуйста, похоже не все пришли
[10.11.21 08:24:34] allen:		Я тут вчера с Wild'ом работал и выяснилось, что если билдить на билд машине стабильно идут 2 детекта, если вручную, то детектов нет:

На билд-машине: https://dyncheck.com/scan/id/fd0544d05a9e3417c9410395503b6e29
Вручную: https://dyncheck.com/scan/id/f189e6de0cf8bdb18fc7c6858730037c
Похоже, проблема с ГИТ. Он выкачивает не ту версию.
[10.11.21 08:26:52] allen:		Причем, ручная сборка - это:
git clone
Изменение build.bat на VS Professional
build.bat

И все.
[10.11.21 08:27:40] allen:		build.bat с параметрами из лога на Jenkins
[10.11.21 08:29:02] elroy:		Есть такая проблема, что детекты разнятся. Это происходит из-за следа, котторый оставляет машина. Вот конкретно эти два у нас почти на всех криптерах побывали, причем. именно при таких вот обстоятельствах. И это интересно.
Но вот насчет гита, не думаю, что проблема в нем. Уверен что именно в гите проблема? Как вариант, создай новый профиль, укажи ветку и сделай билд. Будет тоже самое?
[10.11.21 08:30:56] elroy:		И сравни два файла. Где-то может увидишь отличие
[10.11.21 08:32:57] elroy:		Мало того, silver назначил премию для тех, кто точно найдет след машины и опишет как он цепляется
[10.11.21 08:35:41] elroy:		Из найденных на сегодня следов, это версия linker`а, тут предположительно порядок линковки символов и точно версия в PE заголовке. Также Rich хидер
[10.11.21 08:40:17] allen:		Следа машины нет. Там выполняются следующие команды:
git.exe rev-parse --is-inside-work-tree
git.exe config remote.origin.url https://95.179.129.40/fed/cryptor3
git.exe rev-parse --verify HEAD
git.exe reset --hard
git.exe clean -fdx
git.exe --version
git --version
git.exe fetch --tags --force --progress -- https://95.179.129.40/fed/cryptor3 +refs/heads/*:refs/remotes/origin/*
git.exe rev-parse "refs/remotes/origin/master^{commit}"
git.exe config core.sparsecheckout
git.exe checkout -f НОМЕР_ПОЛУЧЕННОЙ_ВЕРСИИ
git.exe rev-list --no-walk НОМЕР_ПОЛУЧЕННОЙ_ВЕРСИИ
[10.11.21 08:41:39] allen:		Это вместо просто команд 
git clone https://95.179.129.40/fed/cryptor3
git checkout master/master
[10.11.21 08:42:53] elroy:		Так что, в итоге другое содержимое извлекается из гита?
[10.11.21 08:43:19] allen:		Да, очень на то похоже.
[10.11.21 08:43:32] elroy:		git.exe checkout -f  - затирает все, что не в коммите
[10.11.21 08:44:47] allen:		Это да. Но в результате у меня не появилось ни одного файла, но что самое интересное, команды дальше выполняются.
[10.11.21 08:45:11] elroy:		Интересно. Я посмотрю.
[10.11.21 08:45:21] allen:		Посмотри.
[10.11.21 08:46:38] allen:		Дальше вызывается батник, который копирует исходник и батник, который вызывает build.bat
[10.11.21 09:20:08] elroy:		У дженкинса адрес обновился
```
https://abhfcascgppcauw3sbrszzqivkuwqrqfqxlsmjalzmcm37zom2soipyd.onion
```
[10.11.21 09:52:41] elroy:		Скажи, а какой профиль?
[10.11.21 10:46:50] allen:		RUNDLL
[10.11.21 10:50:05] allen:		Я думаю все профили.
[10.11.21 13:21:01] elroy:		Я сделал проверку фалов, что извлекает гит
[10.11.21 13:21:42] elroy:		Напиши, обсудим
[10.11.21 13:22:04] elroy:		Файлы идентичны, но я перед этим изменил настройки слегка профиля
[10.11.21 14:47:04] allen:		Чего написать?
[10.11.21 14:47:41] elroy:		Проверь сам, что гит извлекается верно
[10.11.21 14:47:46] elroy:		Давай инструкцию напишу
[10.11.21 14:49:31] elroy:		Выбери любой профиль и исправь, в настройках профиля перед вызовом билда добавь Execute bath ... и в поле вписать надо это
```
fciv -add %cd% -r -bp %cd% -sha1 -xml fciv_db.xml
exit /B 0
```
Затем сбилди этим профилеме файлик из панели и скачай из артифактов fciv_db.xml
Извлеки ту же самую векту у себя на на машине, кинь туда файлик и из консоли в каталоге выполни команду
```
fciv -v -bp %cd% -sha1 -xml fciv_db.xml
```
Оно сверит файлы (хеш суммы по базе)
fciv могу или скинуть или на сайте майкрософта если получится скачать (на сервере уже установлен)
[10.11.21 15:17:22] allen:		Файл Windows-KB841290-x86-ENU.exe c fciv недоступен больше...
[10.11.21 15:19:35] elroy:		Скинуть?
[10.11.21 15:23:41] allen:		Давай
[10.11.21 15:25:14] elroy:		```
https://file.io/hxAsxNfq6Dk0
DyGc6djJjshdgG
```
[10.11.21 15:27:45] allen:		Спасибо.
[10.11.21 15:43:58] allen:		Результат:

//
// File Checksum Integrity Verifier version 2.05.
//
Starting checksums verification : 11/10/2021 at 18h42'35



List of modified files:

-----------------------

.git\config 

	Hash is		: 3d0ecc4279865748a4bb86c4dcad99780522d2ad

	It should be	: 45a11039237e6e5042483c9ed80fcf3f47892602


Unable to Hash file .git\FETCH_HEAD



	Error msg  : Не удается найти указанный файл.

	Error code : 2



.git\HEAD 

	Hash is		: 92c132ba61359c0257c7339bc0d89bdbc0f5f22e

	It should be	: acbaef275e46a7f14c1ef456fff2c8bbe8c84724


Unable to Hash file .git\hooks\push-to-checkout.sample



	Error msg  : Не удается найти указанный файл.

	Error code : 2



.git\index 

	Hash is		: 4666395ebaa8c43c79fc8cdb50eed4b11b536b0b

	It should be	: 74cd96971427206d853155db1f0f1fc765b5c9f2


.git\logs\HEAD 

	Hash is		: 7882a21d65a07ca535aa65777c3895fd1d100fe8

	It should be	: 01f1014f95a77c93d57c3833f8362ac8fcdb9008


Unable to Hash file .git\logs\refs\remotes\origin\develop



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file .git\logs\refs\remotes\origin\master



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file .git\logs\refs\remotes\origin\test



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file .git\refs\remotes\origin\develop



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file .git\refs\remotes\origin\master



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file .git\refs\remotes\origin\test



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file 88221_47537_crp_input.dll



	Error msg  : Не удается найти указанный файл.

	Error code : 2



Unable to Hash file fciv_db.xml



	Error msg  : Не удается найти указанный файл.

	Error code : 2





End Verification : 11/10/2021 at 18h42'37
[10.11.21 15:44:53] elroy:		Это папка .git
[10.11.21 15:44:58] elroy:		Она может отличаться
[10.11.21 15:45:59] allen:		Я подал команду D:\Work\HackerWork\Cryptor__\payloads\detect\cryptor3>fciv -v -bp %cd% -sha1 -xml ..\fciv_db.xml >> my.txt
[10.11.21 15:46:43] elroy:		Все файлы проекта на месте. Отличия только в папке .git/ и в том что нет 88221_47537_crp_input.dll и  fciv_db.xml
[10.11.21 15:49:15] allen:		Запустил сканирование проекта на статику....
[10.11.21 15:49:41] allen:		Того что сбилдил в криптопанели.
[10.11.21 15:50:15] elroy:		А для стаба веь студию используешь, да?
[10.11.21 15:51:20] allen:		Да. У меня Professional...
[10.11.21 15:51:25] allen:		https://dyncheck.com/scan/id/b06208dd383099787984724d0f554b90
[10.11.21 15:51:35] allen:		2 Детекта.
[10.11.21 15:53:33] allen:		Есть мысль проверить компилятор. Я сейчас вставлю в build.bat дополнительные команды для сохранения результата payloadgen. И проверим.
[10.11.21 15:59:48] allen:		Можешь поставить на Jenkins PSCP.EXE из пакета PUTTY?
[10.11.21 16:03:15] allen:		Вернее, на Jenkins+Cryptopanel.
[10.11.21 16:03:33] elroy:		А в каком сценраии он нужен?
[10.11.21 16:04:37] allen:		Пусть будет. Эта прога позволяет копировать по SSH. Аналог линухового scp
[10.11.21 16:05:07] elroy:		Я хнаю что это) Мне не ясно зачем оно там.
[10.11.21 16:08:33] elroy:		Эти два детекта скорее всего связаны с версией линкера. Та версия студии что на машине и что у тебя в работе - разные. Я могу скинуть линкеры, что на дженкинсе используются, скопируй себе (забекапь оригинальные). Будет те же самые два детекта
[10.11.21 16:08:41] allen:		Мне надо для эксперимента: я модифицирую build.bat, чтобы после использования payloadgen, он передал сгенерированные файлы payloadgen ко мне на сервер. Я тут сбилжу с этими файлами тоже. Потом fc /b с файлом, сбилженным из криптопанели. И посмотреть результат. Отличие должно быть максимум в 2 кусках по 183 байта.
[10.11.21 16:10:35] elroy:		Можно не париться ос криптом. Файлы можно скачать из дженкинса, те самые, что использовались для билда
[10.11.21 16:10:46] elroy:		*со скриптом
[10.11.21 16:11:02] elroy:		Там же среди артифактов
[10.11.21 16:11:11] elroy:		Все равно нужен scp ?
[10.11.21 16:14:08] allen:		Они удаляются моим скриптом.(
[10.11.21 16:14:38] elroy:		Так поправь скрипт, не удаляй
[10.11.21 16:14:47] allen:		Можно закомментить удаление....
[10.11.21 16:14:57] allen:		Секунду.
[10.11.21 17:00:27] allen:		Ну вот и поймали проблему:
В криптопанели: https://dyncheck.com/scan/id/2f3155e6fa09007d2b7bf3c2e7526167
У меня: https://dyncheck.com/scan/id/5accf00038dc33d5a9c82201d6384893

Разница: https://file.io/zusyBaHsbkfD
[10.11.21 17:01:09] allen:		При том, что размеры файлов совпадают.
[10.11.21 17:03:13] allen:		Из разницы видно, что разница уже в NT заголовке....
[10.11.21 17:03:55] allen:		Могу map файл прислать.
[10.11.21 17:04:19] elroy:		А ожешь найти что именно отличается и дает детект?
[10.11.21 17:04:28] elroy:		Последние байты тоже интересны
[10.11.21 17:04:54] allen:		Попробую. Но уже завтра.
[10.11.21 17:05:27] elroy:		Хорошо
[15.11.21 06:47:56] elroy:		Писал в пятницу насчет сравнения двух файлов. Меня отвлекли, я так и не понял что там. Извини. Можешь еще раз рассказать что получилось?
[15.11.21 06:49:03] allen:		Цитируюсебя же:

 Объясни мне пожалуйста:
Вот DOS Header у DLL:

<DOS Header>
Magic number: 5A4D (MZ)
Bytes on last page of file: 0090 (144)
Pages in file: 0003 (3)
Relocations: 0000 (0)
Size of header in paragraphs: 0004 (4)
Minimum extra paragraphs needed: 0000 (0)
Maximum extra paragraphs needed: FFFF (65535)
Initial (relative) SS value: 0000 (0)
Initial SP value: 00B8 (184)
Checksum: 0000 (0)
Initial IP value: 0000 (0)
Initial (relative) CS value: 0000 (0)
File address of relocation table: 0040 (64)
Overlay number: 0000 (0)
Reserved words (4): x0000,x0000,x0000,x0000
OEM identifier: 0000 (0)
OEM information: 0000 (0)
File address of new exe header: 0118 (280)
Reserved words (10): x0000,x0000,x0000,x0000,x0000,x0000,x0000,x0000,x0000,x0000

Тут написано:
Bytes on last page of file: 0090 (144)
Pages in file: 0003 (3)

Значит, размер модуля 512 * (3 - 1) + 144 = 1168 байт. При этом смещение PE заголовка 280 байт от начала. Это как понимать?
5:56 AM
[15.11.21 06:52:53] elroy:		Ну по идее ведь не фиксирован порядок заголовков. File address of new exe header - как раз поэтому и используется. А вот что там в промежутке, инетресно
[15.11.21 06:56:32] allen:		Это да. Но если я пишу прогу для сравнения 2-х файлов, разумно будет и написать сравнение DOS EXE. У нас первое различие начинается с RVA 0x003C. А это DOS часть.
[15.11.21 06:58:25] elroy:		Сам PE файл собирается линкером. В зависимости отверсии он может собирать по разному файл. Найди еще разницу, типа версии
[16.11.21 09:35:31] allen:		Привет. ОТР?
[16.11.21 09:36:21] allen:		Я закончил анализ.
[16.11.21 09:37:18] elroy:		Приветствую
[16.11.21 09:45:41] elroy:		Приветствую еще раз) Давай отр
[16.11.21 09:45:44] elroy:		Коннект пропадал..
[16.11.21 09:56:18] allen:		Я закончил анализ.
[16.11.21 10:04:03] elroy:		Отправляй лучше частями. В этом чате большой текст не отправится
[16.11.21 10:04:26] elroy:		Или сохрани перед отправкой, иначе он собъется в поле ввода
[16.11.21 10:04:33] elroy:		Зашифруется и не отправится
[16.11.21 10:07:23] allen:		Различия следующие:

1. DOS секция. Смещение PE заголовка разное отличается на 8 байт. Содержимое отличается. (По-моему в MS как всегда хранят ошметки неинициализированной области памяти).
2. Секция .flat - секция создается fasm. Отличие - 2*177 байт. Это нормально, так как я в 2-х местах генерирую случайные числа по 177 байт.
2. Секция .text:
00011E7C: 0E 29
00011E85: 23 04
00011E8C: 7D 5A
00011E90: 6F 48
00011E94: 78 5F
00011E98: 6B 4C
00011E9C: 51 76
00011EA0: 7E 59
00011EA4: 6F 48
00011EA8: 77 50
00011EAC: 62 45
00011EB0: 61 46
00011EB4: 6F 48
00011EB8: 6A 4D

Сдесь смещения (1-е число) относительно начала секции. Так как размер итогового файла совпадает, то 8 байт различий в DOS секции, видимо, где-то догоняется.

Итак в нашем случае есть 2 места, которые могут послужить сигналом АВ:
1. DOS секция
2. 14 байт в секции .text

Как работать с map файлом? Участок 11E7C в IDA указывает на левые данные.
[16.11.21 10:17:17] elroy:		В мап файле табличка с адресами, виртуальный и rva + база, по этим и смотрим адресам (по rva+base).
[16.11.21 10:18:02] allen:		Пример?
[16.11.21 10:18:46] allen:		0002:00013df0       MyLoadLibrary              0000000180016df0 f   myloadlibrary.obj
[16.11.21 10:19:26] allen:		0002:00000000 00011db0H .text                   CODE
[16.11.21 10:19:52] elroy:		В иде бывает отличается от мапа.
Бывает пропустил смещение.
Бывает из-за багов иды/линкера
Я сам натыкался на это.
Нужно выяснить что ты видишь, в данном случае я так понимаю это адреса смещения. Ида показывает корректно, в иде надо перейти на File Offset.
После перехода рядом будет написан Виртуальный.
[16.11.21 10:19:57] elroy:		Момент, гляну
[16.11.21 10:23:18] allen:		А ЗП будет сегодня? Франц ни вчера ни сегодня не ответил мне ничего.
[16.11.21 10:23:34] elroy:		Это только ему известно
[16.11.21 10:23:40] elroy:		Я тоже не получал
[16.11.21 10:27:33] elroy:		в мап файле такая табличка
```
 Address         Publics by Value              Rva+Base       Lib:Object

 0000:00000000       ___guard_fids_count        00000000     <absolute>
...
```

Address - это смещение в файле
Rva + base - это адрес, куда развернется, с учетом базы
[16.11.21 10:28:14] elroy:		А мап файлы одинаковые?
[16.11.21 10:28:54] allen:		Не знаю. Я его не сохранил на build-машине.
[16.11.21 10:30:29] elroy:		```
Итак в нашем случае есть 2 места, которые могут послужить сигналом АВ:
1. DOS секция
2. 14 байт в секции .text
```
Замени на грязном 14 байт из чистого. Детект уйдет? Значит дело в них.
Если нет - дело в первом.
(самая простая проверка)
[16.11.21 10:30:51] elroy:		Но скорее всего оно работает вместе как сигнатура
[16.11.21 10:31:08] elroy:		Проведи тест, сохрани оба мап файла чтобы сравнить
[17.11.21 08:14:43] elroy:		Приветствую
[17.11.21 11:15:52] allen:		Привет.
[18.11.21 09:11:51] allen:		Привет. Выяснилось, что на АВ влияет DOS секция. И только. Сейчас попробую ее збить нулями.
[18.11.21 09:12:36] elroy:		Именно дос секция, может какие-то конкретные поля?
[18.11.21 09:14:39] allen:		Нет. Пустое пространство между Надписью This program cannot run in DOS mode! и PE заголовком.
[18.11.21 09:15:43] allen:		Там какие-то байты присутствуют
[18.11.21 09:15:48] elroy:		0x80 - 0чEF ?
[18.11.21 09:17:16] allen:		PE заголовок смещен в случае Cryptopanel на 8 байт назад.
[18.11.21 09:17:42] elroy:		Это ты нашел Rich заголовок
[18.11.21 09:18:10] allen:		Наверное.
[18.11.21 09:18:21] elroy:		Минуту, дам статью на него
[18.11.21 09:19:12] elroy:		```
https://bytepointer.com/articles/the_microsoft_rich_header.htm
https://www.ntcore.com/files/richsign.htm
```
[18.11.21 09:19:19] elroy:		Для ознакомления
[18.11.21 09:19:24] elroy:		Да, его надо править
[18.11.21 09:19:35] elroy:		Но нулями он не забивается, иначе детект
[18.11.21 09:20:07] elroy:		Проще всего взять с любого файла майкрософта, из explorer.exe или еще откуда-то
[18.11.21 09:20:18] elroy:		Я так делаю. Детекты уходят
[18.11.21 09:20:50] elroy:		Обычно он по смещению
```
0x80 - 0xEF
```
[19.11.21 13:25:16] elroy:		Приветствую
[19.11.21 13:31:42] allen:		Привет. Пишу избавитель от Rich заголовка.
[19.11.21 13:33:38] allen:		Я посмотрел, файлы сделанные при помощи fasm, без этого заголовка. Размером 0x80 байт. Как раз.
[19.11.21 13:34:54] elroy:		Скажи, а как планируешь чистить модули, где код на асме?
[19.11.21 13:35:04] elroy:		Там загрузчик холовинга
[19.11.21 13:35:59] allen:		Нормально они чистятся. Вклиниванием левого кода при помощи макросов.
[19.11.21 13:36:34] elroy:		При компиляции кода на асме, вклинивается в него левый код?
[19.11.21 13:36:50] allen:		Да.
[19.11.21 13:37:14] elroy:		А загрузчик dll тоде на асме?
[19.11.21 13:37:51] allen:		Нет. Я не успел его в asm переделать (
[19.11.21 13:38:11] elroy:		Ясно
[19.11.21 13:38:52] elroy:		А сколько бы ремени ушло переложить и его на асм, в том числе с добавлением обфускации кода (вклинивания макросами) ?
[19.11.21 13:39:33] allen:		Неделю-две
[19.11.21 13:41:19] allen:		Вклинивание макросами мнего не занимает. Пару часов. В основном это преобразование C в asm. Для 2-х архитектур.
[19.11.21 13:42:32] allen:		Ведь в асме по-разному и вызовы происходят для 32 и 64 бит.
[19.11.21 13:43:22] elroy:		Мне понадобились шеллкоды для шифрования, запуска dll и exe, которые можно положить в другой проект, но они должны быть защищены. Пока рассматриваю варианты
[19.11.21 13:44:31] allen:		Можно реализовать на асме.
[22.11.21 08:02:54] allen:		Привет. ОТР?
[22.11.21 08:04:24] allen:		Я закончил с StripRichHeader. Могут все пользоваться. В моем каталоге crypter3 так и называется.
[22.11.21 08:05:55] allen:		Чтобы не мучаться с переносом RVA ВСЕХ данных я поставил смещение (забил нулями) недостающую область сразу после заголовков секций.
[22.11.21 08:06:48] allen:		Вроде все чисто: https://dyncheck.com/scan/id/1d3264a5e83b742a8f453ba316a500ca
[22.11.21 08:07:08] allen:		Проверил на своей DLL - все работает.
[22.11.21 08:07:45] elroy:		Хорошо. Спасибо, посмотрю на StripRichHeader
[22.11.21 08:08:07] elroy:		Там в crypters пишут что не корректно профиль отрабатывает
[22.11.21 08:08:12] elroy:		Профиль ET
[22.11.21 08:09:19] allen:		Почему @dolran возмущается? Что за dll_et_crypter3 выдает ошибку Нет точки входа: AnyString? Что за функция такая AnyString?
[22.11.21 08:11:18] allen:		От orval в задании не было ее.
[22.11.21 08:12:13] elroy:		Сейчас поясню, момент
[22.11.21 08:17:28] elroy:		Профиль ET имеет такую вот интересную хитромудрость, когда вызывается библиотека (полезная нагрузка), она сама смотрит с какими параметрами была вызвнаа rundll32.exe
При этом, rundll32.exe сначала вызывает DllMain библиотеки, а потом функцию, которую указали. Она не проверяет существует ли такая функция до вызова DllMain.
Поэтому крипт должен в своей DllMain развернуть полезную нагрузку, вызвать ее DllMain и пробросить результат выполнения функции.
Этот профиль сделан на основе профиля BK, который в свою очередь делается на основе профиля rundll. Профиль rundll предусмаривает проброс экспорта нагрузки в экспорт крипта. Профиль ET дополнительно учитывает номер ординала при пробросе (номера из экспорта полезной нагрузки должны совпадать с номерами крипта).

Затем ребята вызывают крипт воттак
```
rundll32 file.dll,#1
```
Что означает вызов по ординалу. Логика полезной нагрузки сама проверит параметры, перезапустит себя с нужным именем, и завершит текущий процесс.
[22.11.21 08:19:02] elroy:		А AnyString - это значит, что он вызывал воттак
```
rundll32 file.dll,AnyString
```
В данном случае получается, что крипт не развернул полезную нагрузку и не передал управление в ее DllMain.
[22.11.21 08:20:15] allen:		У меня была ошибка в x64. Если нагрузка x64, то она завершалась до выпонения всего. Я ее поправил.
[22.11.21 08:20:33] allen:		Пусть перепроверит.
[22.11.21 08:20:38] elroy:		Нагрузка x86
[22.11.21 08:21:09] allen:		Тогда странно. Посмотрю.
[22.11.21 08:21:23] elroy:		Отпишись в чат crypters, напиши "перепроверь ...", согласуйте, должно работать. У всех работает)
[22.11.21 08:22:10] allen:		Вопрос, что мне делать в случае `rundll32 file.dll,AnyString`?
[22.11.21 08:23:05] allen:		Экспортировать функцию AnyString? И что в ней делать?
[22.11.21 08:23:08] elroy:		При таком вызове будет вызвана Entrypoint твоего крипта, в ней надо развернуть нагрузку и вызвать Entrypoint ее, вернуть результат ее выполнения.
[22.11.21 08:23:21] elroy:		Экспортировать ничего не нужно
[22.11.21 08:23:54] elroy:		Нужно к себе в экспорт пробросить экспорт из исходника, точно так же, как это делается в профиле rundll
[22.11.21 08:25:42] allen:		Это делается. В смысле экспорта... Я посмотрю, чтобы вызывалась Entrypoint нагрузки из EntryPoint крипта.
[23.11.21 08:45:36] allen:		Привет. ОТР,
[23.11.21 08:46:48] allen:		Привет. ОТР?
[23.11.21 08:47:07] elroy:		Приветствую
[23.11.21 08:48:55] allen:		Привет. Я не понял, как dolran собирал проект. У меня последний лог сборки от 22.11 от 11:03 PM.
[23.11.21 08:54:35] elroy:		Лучше у него уточни...
[23.11.21 08:54:51] elroy:		Или собери сам, возьми у него исходник
[23.11.21 09:00:48] allen:		Я только что собрал из сборки, той что у меня последняя прогнал на ав. Все норм. Не знаю, что он хочет.
[23.11.21 09:01:18] allen:		https://dyncheck.com/scan/id/6bf7d40e658d3dc8b4add4dd6ccb314a
[23.11.21 09:02:05] elroy:		Trojan:Win32/Wacatac.B!ml
Этот детект проявляется на defender, на Windows10, надо от него избавляться
[23.11.21 09:02:25] elroy:		Динчек некорректно показывает детект дефендера
[23.11.21 09:02:59] elroy:		Чтобы воспроизвести у себя нужно поставить на вирт. маишну вин10,обновить ее до самого свежего состояния
[23.11.21 09:03:09] elroy:		Скинуть на нее файл. Если удалиться - детект по статика
[23.11.21 09:03:31] elroy:		Если по статике - надо чистить стаб, улучшать алгоритм его генерации
[23.11.21 09:03:46] elroy:		Если детект по динамике, т.е. после запуска, тот ту вопрос спортный.
[23.11.21 09:04:07] elroy:		То ли динамика криптера, то ли динамика полезной нагрузки, то ли в совокупности
[23.11.21 09:04:33] elroy:		В любом случае если там детект в динамике, то криптер должен почистить только свою (динамику своих алгоритмов)
[23.11.21 09:05:43] allen:		Это понятно. У меня последняя 10 ка стоит. При этом дефендер ни слова не говорит. Я его даже не выключал. На нагрузку - да. Он реагирует. Ко на Крипт нет.
[23.11.21 09:06:40] elroy:		Тогда напиши ему и скинь ему этот крипт, пусть проверит у себя
[23.11.21 09:06:58] allen:		Хорошо.
[25.11.21 08:40:14] elroy:		Приветствую
[25.11.21 09:01:59] allen:		Привет
[25.11.21 09:02:24] elroy:		Стала сыпаться сборка rundll профиля
[25.11.21 09:02:41] elroy:		```
 Привет. Не могу закритовать длл dll_rundll_crypter3
Пишит failed
Хотя час назад делал крипты. Помоги пожалуйста
```
[25.11.21 09:02:57] elroy:		Посмотри пожалуйста, почему оно стало падать
[25.11.21 09:03:10] allen:		Сейчас посмотрю...
[25.11.21 09:19:56] allen:		Он в исходнике экспортирует функцию DllGetClassObject. Поэтому и не собирается. Такая функция уже есть в #include <windows.h>.
[25.11.21 09:26:23] elroy:		Совсем не давно было требование исправить проблему такую, когда поступают стандартные функции в экспорте. Должен пробросить ее имя как есть, даже если оно стандартное. Исправь пожалуйста
[25.11.21 09:59:01] allen:		И как мне это сделать?
[25.11.21 10:00:08] elroy:		У тебя сборка стаба делается с тудией, там надо использовать lib.def файлик
[25.11.21 10:00:45] elroy:		В нем пишешь какая функция какой сопоставлена, т.е. как видна в экспорте
[25.11.21 10:01:41] elroy:		У себя в исходниках берешьимя функции и добавляешь к ней префикс, например, или окончание
DllGetClassObject_hfjdhfjdhsjf
[25.11.21 10:01:52] elroy:		И через lib.def сопоставляешь
[25.11.21 10:03:34] elroy:		Напомни пожалуйста как развернуть ассемблер для криптера? Настраиваем новый сервер. Ассемблер просто в корень диска кладется или нужно еще что-то?
[29.11.21 08:20:58] elroy:		Приветствую
[29.11.21 08:27:15] allen:		Приивет
[29.11.21 08:28:21] elroy:		Скажи, а вот если вызвать билдскрипт криптера, сделать крипт, затем повторить, не делая очистки. Будет работать?
[29.11.21 08:28:54] allen:		Должен.
[29.11.21 08:29:52] allen:		Он удаляет все внутренние файлы сам. А что?
[29.11.21 08:30:17] elroy:		Хочу скрипт на серию написать.
[29.11.21 08:30:33] elroy:		Сколько приблизительно будет делаться 1 тыс штук?
[29.11.21 08:31:03] allen:		Напиши. Хеш суммы будут разные каждй раз.
[29.11.21 08:31:23] elroy:		Ну да, и нечеткий же проверяли тоже.
[29.11.21 08:31:29] elroy:		Проверяли же?)
[29.11.21 08:32:20] elroy:		Есть просто заказ на 1 тыс пару раз в неделю. Им разные надо...
[29.11.21 08:33:15] allen:		Только выходной файл копируй.
[29.11.21 08:33:44] elroy:		Так и хотел, потом наборы в архив и на выдачу в панель
[29.11.21 11:47:21] elroy:		Скажи, а впараллель можно запустить криптование, если в разных папках лежит?
[29.11.21 11:47:31] elroy:		*лежит криптер
[29.11.21 13:47:03] allen:		Вряд ли.
[29.11.21 13:47:24] allen:		Не предусмотрено.
[29.11.21 13:47:48] elroy:		Напиши еще раз
[29.11.21 13:48:01] allen:		Вряд ли.
Не предусмотрено.
[29.11.21 13:48:41] elroy:		А что не предусмотрено? В чем там заты происходит?
[29.11.21 13:48:48] elroy:		*затык
[29.11.21 13:50:14] allen:		В последовательности команд. Билд генератора. Генерация кода. Билд криптера. Постфикс крипта.
[29.11.21 13:50:42] elroy:		Так если это делается в разных папках
[29.11.21 13:51:19] allen:		Если криптор лежит в разных папках, тогда, наверное, можно.
[29.11.21 13:53:01] elroy:		Я наверное глупость спросил, ведь по профилям же работает впараллель
[17.12.21 07:44:08] allen:		Привет. Вчера у меня не было связи. Совсем. Что-то с вышкой случилось.
[17.12.21 07:46:00] elroy:		Да, я видел в чате ты писал.
[17.12.21 07:46:10] elroy:		Хорошо что появилась
[17.12.21 07:46:32] elroy:		Переехал или вышку починили?
[17.12.21 07:46:32] allen:		Да. Без телефона вчера сидел.
[17.12.21 07:46:53] allen:		Вышку видимо починили.
[17.12.21 07:47:08] elroy:		Появились дополнения по криптеру
[17.12.21 07:47:20] allen:		Какие?
[17.12.21 07:47:31] elroy:		```
Функция "решето"

Функционал размещения в стабе фрагментов данных, которые могут быть
пропатчены внешней утилитой без нанесения вреда функциональности стаба.
Внешняя утилита ориентируется на мачки, размещенные в стабе.

Фича включается опцией для билд-системы криптера.

Ожидается, что созданное решето будет заполняться рандомом с помощью
внешней утилиты. Т.е. будет создаваться серия криптов на основе одного крипта.
При этом, решето должно иметь размер и форму, позволяющие обеспечить
максимально-возможное или полное отличие образцов по нечетким
хешам в созданной серии. И это обязательное условие.

Решето должно размещаться во всех секциях стаба.

В случае если фича активна, то билд-система готовит файл с фрагментами
под заполнение и размещает в каждом фрагменте маячки следующего содержимого:
struct beacon
{
  DWORD64 signature; // Обычно равно 0x11223344FFEDA5D0
  DWORD   size;      // Размер фрагмента (маячок находится во фрагенте,
                     // значит с учетом размера маячка)
  DWORD   crc;       // Контрольная сумма полей signature и size
}
Контрольная сумма рассчитывается следующим образом:
DWORD ComputeBeaconCRC(beacon* bcn)
{
  DWORD crc = 0;
  BYTE *p = (BYTE*)bcn;
  for (int i = 0; i < sizeof(beacon) - sizeof(DWORD); i++)
    crc += *p++;
  return crc;
}  

В случае если фича не активна, то билд-система все равно готовит файл с
фрагментами, но фрагменты заполняет самостоятельно случайными данным.
Случайные данные должны быть сгенерированы с помощью аппаратного
рандома, например микрокоманда rdrand.
(Исходный код случайного генератор имеется на С++, можно запросить).
В таком случае маяки не создаются, либо создаются и затираются билд-системой
во время заполнения.

Стоит учесть, что при генерации криптов важным моментов является рандомизация,
поэтому рекомендуется готовить решето из фрагментов разных размеров на каждый
новый билд.
```
[17.12.21 07:47:44] elroy:		Это касается всех профилей
[17.12.21 07:50:39] allen:		Ясно. Это под 64 бита и 32 бита?
[17.12.21 07:50:49] elroy:		Да
[21.12.21 07:00:09] elroy:		Приветствую
[21.12.21 07:27:38] allen:		Привет.
[21.12.21 07:31:19] elroy:		Нужна консультация по асму. Пдскажи один момент, пожалуйста)
[21.12.21 07:31:35] allen:		Давай.
[21.12.21 07:33:44] elroy:		Есть 32 бита код
```
proc FUNC uses ebx edx, dwTicks,dwHasInterface
...
  mov edx,[dwHasInterface]
  mov DWORD [edx],eax
...
endp
```
Это ничто иное как работа с передачей параметров по ссылке.
Как сделать тоже самое для x64 ?
[21.12.21 07:34:38] elroy:		```
mov rdx,[dwHasInterface]
mov DWORD [rdx],eax
```
Вот этот код собирается, но падает)
[21.12.21 07:43:41] allen:		В 64 бит передаются первые 4 параметра в регистрах, соответственно:
rcx
rdx
r8
r9
И при вызове функции нам надо их сохранить. Тем более, на стеке ЗАРЕЗЕРВИРОВАНО 0x20 байт под них.
Никаких uses нет.

Функция выглядит:

proc FUNC dwTicks, dwHasInterface
        mov [dwTicks], ecx
        mov [dwInterface], edx
****
        mov edx, [dwHasInterface]
        mov [edx], eax ; Тут указание DWORD не надо, т.к. за размер отвечает EAX
*****
endp
[21.12.21 07:46:10] elroy:		Спасибо, попробую
[21.12.21 07:54:09] allen:		Сохраняй на стеке все испоьзуемые регистры, кроме rax, rcx, rdx, r8, r9
[21.12.21 07:54:47] elroy:		Что-то не работает..
[21.12.21 07:54:54] elroy:		Жалуется на operand size
[21.12.21 07:55:21] allen:		Какой компилятор?
[21.12.21 07:55:30] elroy:		fasm
[21.12.21 07:56:18] allen:		В fasm не надо указывать размер при передаче из регистров. Пришли код.
[21.12.21 07:58:30] allen:		Наверное, тебе надо объявлять в параметрах proc FUNC, DWORD dwTicks, DWORD dwHasInterface.
[21.12.21 07:59:50] allen:		Не помню точно. Посмотри по документации. Либо так, м.б. dwTicks:DWORD надо.
[21.12.21 08:00:07] elroy:		Вот полный код
[21.12.21 08:00:12] elroy:		```
format PE64 GUI 5.0
entry start

include 'win64a.inc'

section '.text' code readable executable

	  start:
		sub	rsp,8		; Make stack dqword aligned
  
        fastcall CheckAV,ticks,hyps
		
        mov eax, DWORD [hyps]
        cmp eax,1234
        je one
        invoke  MessageBoxA,NULL,_no,_title_msghyp,MB_OK
        invoke  ExitProcess,0
		jmp two
one:
        invoke  MessageBoxA,NULL,_yes,_title_msghyp,MB_OK
        invoke  ExitProcess,0
		;jmp two
two:
		
		invoke  ExitProcess,0
    
proc CheckAV dwOne,dwTwo
	mov [dwOne], 0
	mov [dwTwo], 1234
	ret
endp

section '.data' data readable writeable
  _title TCHAR ': Win64 program',0
  _class TCHAR 'Hello from ASM',0
  
  _title_msghyp db 'HYP',0
  _yes db 'YES',0
  _no db 'NO',0
  
  ticks dd 0
  hyps dd 0
  
section '.idata' import data readable writeable

  library kernel32,'KERNEL32.DLL',\
          user32,'USER32.DLL'

  include 'api\kernel32.inc'
  include 'api\user32.inc'
```
[21.12.21 08:00:53] allen:		Ок. Щас пришлю работающий вариант.
[21.12.21 08:01:32] elroy:		Этот код собрался, просто не работает. Я так понял 1234 не передалось в hyps
[21.12.21 08:08:06] allen:		Рабочий вариант функции:

`proc CheckAV dwOne,dwTwo
	mov DWORD [rcx], 0
	mov DWORD [rdx], 1234
	ret
endp`
[21.12.21 08:08:37] elroy:		Спасибо.
[21.12.21 08:08:48] elroy:		Получается, rcx и rdx заняты...
[21.12.21 08:09:35] elroy:		А что используется вместо них? r0-r8
[21.12.21 08:13:09] allen:		Я написал, что в 64 битах первые 4 параметра передаются через регистры: rcx, rdx, r8, r9. Для работы с ними сохраняешь их на стеке:
proc FUNC, param1, param2, param3,param4,param5, param6
mov [param1], rcx
mov [patam2], rdx
mov [param3], r8
mov [param4], r9
****
mov rax, [param5]
mov [param6], rax
****
[21.12.21 08:15:34] elroy:		Спасибо
[21.12.21 11:18:44] elroy:		Проверка связи
[21.12.21 11:22:16] elroy:		Есть дополнение к криптеру.
```
Download: https://qaz.im/load/YfAFDh/dNb49e
XdS6d8!hDw@hdiW1!kwpW0-W-doW2
```
Нужно добавить. Но по умолчанию функционал не должен применяться. Применять только по требованию.
Доработка важная, просьба добавить в ближайшее время.
Описание внутри, плюс для тебя там дополнительно код на асме имеется (си или сам, что удобно).
[21.12.21 11:23:20] elroy:		Подтверди получение, пожалуйста
[21.12.21 11:34:59] allen:		Ясно.
[23.12.21 09:54:10] elroy:		Приветствую
[23.12.21 09:54:38] allen:		Привет.
[23.12.21 09:55:12] elroy:		Скажи, как с криптами идут дела? Что спрашивает manuel и что получается сделать?
[23.12.21 09:58:52] allen:		Сейчас делаю крипты для manuel. Вчера делал крипты для nick и manuel. Долго. Не дают понять, что у меня с криптом: то все AV набрасываюся, то несколько, то чисто. Прямо задолбался криптовать: на один крипт уходит до часа из-за того, что проверять надо на чистоту. И если не чисто, криптовать заново.
[23.12.21 09:59:33] elroy:		У тебя есть доступ к авчек?
[23.12.21 09:59:48] allen:		Нет
[23.12.21 10:00:23] elroy:		Могу скинуть в pgp, готов принять?
[23.12.21 10:00:30] allen:		Да
[23.12.21 10:00:51] allen:		Не pgp, а gpg
[23.12.21 10:01:43] elroy:		-----BEGIN PGP MESSAGE-----

hQIMAzK4/v3JrWW+AQ/9FiuHpIMLQ0Ph/KpZPLXgqxoi+JluvVFgEdOaDyV+HYfi
7Qflvs5LKZPoQHOGPFRT198etf8RHTofZ1qQZwYjfHBsWTvKjqBOgQdjM1yCuEvN
OOq42b/3R3nHKgxymAQZ4u6TCdxnBIvzagU1Xa4OdZkXcbWkkybcAiQl1GsBLJFq
HfNwe6CoXyBZCbujgH0AZZES7ddkZfrqXMSLTgxgDpjbz+ssUhqCNUCkyr7+fGfi
l5iFc1sfSrdmwDkuYJHH72R/VMFeH631Sjk6QfmeVBN2A5WOV1rT57DorePM0plU
9nuP/pdQtJeJK7d3bTIMV+fWkUbqmD41JNgpN1mVqfXzIwWfyTicu4OH7pWP+tWU
bdMZZy1kgpW6HitvBf8C1siXGSVMXAiQnN7nNiqBX+1cf0HZxMDIR52gsGett0sI
weKJco4FcNjuSEdE7jfuQauosOhl3uCAABiZz2bTbdDlZIMXUmbKcdtHZ33rg6/C
8a25+pYPSZ891q0e55mALnJkFZPOMpSQLCb8zIVMSX4xGPc4LGoERtbwQiRMxfEf
Sipe5grhpRL8mscjsPLE+DCqirzXs1YiRcni6SaR0kdyzCfmjdzqc/iCbNkPpO3G
LEe7qD/qsj1+DWczMI5QVCI1Q64M8ISTtaodnsBvUaYQJVHUNthAujWvcTbNvJjS
6QHHrUdad/rK+WPkNvgHpxcJlt5v15RivCP6n8V+PvzWDYJSECLsvkJchulf5MYX
WnqTqZ7LO4pVSpX1GH4SmV8CV0sYoYiIKw2fxqqj0v/Sv8QeRjkCZyT6UwJXh5fR
pAML8roYcs7LnBTNYQT2FtqWOtvGftNHgIwurNuQenxa2y6CdtlxIwZCn8sEmB2o
cJOV+VmGJqKXeme/PTx6KMvfMiK1sprlmwCjVtSOnPNG3E3gayUHptg4IO3fFJiN
wTI4E9BlkEHJ67ZIwuPE0+aeUjy8yYtss9GBS/6iqiOoxboKN6c0b2lT0aHAAJQA
4LNxERUiWomL9dJEG7Er10wMQp7chylCNdiDrSuROZhYoK4ic1ldVNGzuxfb33P5
hcyIpNquo0WYdqdAgeEx6ic0zxYnK/YlQOWpoLsIwdW/5Ap0dRZ89jWA5WJ6uNm1
+QyZRL3He26SNy2rsoqG3DzklpQM/QIMtilIvco4NLu/D/yyyfMRln9c2CfALeb0
w+l1yva+JBFnhcx7LCD2OSML/SNlMt7NB5byJpKVZr/hKgj6Fcz5f3W+Mw8saU2f
Aeb5J7iD5mspB2LQfYfnpEl7QaGPJpnq1TQWltNQUHVepbw34tsTlndRbPOjjZX5
WvZOUW8cyahUryIA+NcexwqK7sTcYIiHS/T39a4tDMn3qYEPoPispHep2Owlzwu4
Vj8e+dBwTAu+Eo5S1D53GIs1r0RVMULQX07X1/FyFkBbwJ0PaU/XAXgoRWqPRVr6
AEEPr50FqdLIQpE/yesgqvyLQ0WD2G2KwAWAtRuzFwFQW/xRNM2tuQxB4XP2YdOy
ntFwwc5FllZfGdMmPwM6jHmcXBWV/no+dTgdFzuKmFuzsp2tZfiaTWwdDFy7pq9Z
X7r23Zzi0tM6njo=
=bbnV
-----END PGP MESSAGE-----
[23.12.21 10:03:36] elroy:		Напиши мне список профилей которыми просят криптовать и которые у тебя самые чистые. Я попробую разделить нагрузку между криптерами. Я так понял. скидывают все и всем, и у кого лучше получится выбирают.
[23.12.21 10:03:41] elroy:		Это плохой вариант...
[23.12.21 10:04:02] elroy:		Поэтому нужен список того, что у тебя просят и что ты можешь чситое сделать.
[23.12.21 10:07:35] allen:		И что мне с присланными логином/паролем делать?
[23.12.21 10:08:46] elroy:		Это доступ на 
```
avcheck.net
```
[23.12.21 10:08:59] elroy:		Используй когда чуствуешь, что динчек барахлит
[23.12.21 10:09:17] elroy:		А то он чстенько фигню показывает
[23.12.21 10:09:56] allen:		Динчек не барахлит. А, кстати, как на криптопанели проводится сканирование на АВ?
[23.12.21 10:10:08] elroy:		На динчеке
[23.12.21 10:10:13] elroy:		Через апи
[23.12.21 10:10:29] allen:		Какое АПИ у него?
[23.12.21 10:11:29] allen:		Может мне легче написать скрипт, по которому я собираю, проверяю, если не прошло, то пересбираю?
[23.12.21 10:11:35] elroy:		Панель связывается с динчеком посредством http запросов (веб апи), проверяет файли и получает результат
[23.12.21 10:11:45] elroy:		Может
[23.12.21 10:11:52] elroy:		Но это не дёшево
[23.12.21 10:11:59] elroy:		Там платные апи...
[23.12.21 10:12:09] allen:		Ясно.
[23.12.21 10:12:31] elroy:		Вот я скинула авчек акк, специально для апи аккаунт делали
[23.12.21 10:12:43] elroy:		Можешь написать....
[23.12.21 10:13:36] elroy:		> Поэтому нужен список того, что у тебя просят и что ты можешь чситое сделать. 
Сформируй пожалуйста, упростит работу всем нам
[23.12.21 10:14:35] allen:		У меня просит, в основном manuel для LEO, nick для rundll.
[23.12.21 10:15:05] elroy:		Эти профили чистые или как ты говоришь, надо смотреть каждый?
[23.12.21 10:15:16] allen:		32-Бит пока не принимаю. Пока ни одной сборки чистой не получилось (
[23.12.21 10:15:39] allen:		Надо проверять после каждой сборки.
[23.12.21 10:18:17] allen:		Я не пойму, в чем дело. Но на сборке разные файлы выходят всякий раз: по рандомным ключам шифрую пэйлоад, плюс у меня заведер рандом генератор на генерацию кода. Я на второе грешил. Но заменил рандом на nop, и словил кучу АВ.
[23.12.21 10:19:06] elroy:		А что насчет рича? Тот вариант что ты используешь мне не понравился)
[23.12.21 10:19:13] elroy:		Есть проект, который рандомит рич
[23.12.21 10:19:16] elroy:		Я могу скинуть
[23.12.21 10:19:25] elroy:		(если не скидывал еще)
[23.12.21 10:19:33] elroy:		Там на вход просто exe указываешь
[23.12.21 10:19:45] allen:		Не скидывал. Скинь.
[23.12.21 10:21:16] elroy:		момент
[23.12.21 10:31:35] elroy:		```
https://file.io/ONVLaXVCLaaN
Nd6DFSRxfSfxrSxgchShwhSHg.Jhsgfrd
```
[23.12.21 13:25:22] allen:		Давай повторим подключение по ОТР.
[23.12.21 13:29:01] allen:		Сейчас у меня была беседа с Мануэлем. Похоже AVCHECK миксует статический тест с динамическим.
```
12:58 PM
ага

https://avcheck.net/id/rFnYuyVLtKmU

Говорят грязные файлы
1:03 PM
Я проверял на dyncheck. Все были чистые.
1:03 PM
эхх.
1:04 PM
От какого файла присланная ссылка?
1:04 PM
ехе
и длл говрят так же
1:05 PM
Имя файла.
1:06 PM
говорят все файлы с такими же детектами
124 & 1499
loader_exe_64_audi.exe.crypted_1.exe (172 kb)
https://avcheck.net/id/rLadnV8zo4Sz
Получистя почистить или это на долго?
1:15 PM
Странно. На dyncheck все чисто https://dyncheck.com/scan/id/e96ed4d26dae7c69f9c8de6d41f06c46 Этот же файл. Может, на avcheck используется динамическое сканирование?
На dyncheck тоже вылазят детекты на динамическом сканировании. https://dyncheck.com/scan/id/893b98e63cbef59ec76c42542a8176e8
Но я должен проверять только статику.

```
[23.12.21 13:30:23] elroy:		Думаешь авчек динамику прогоняет?
[23.12.21 13:33:54] allen:		Да. В миксе со статикой. Там нет отдельного выбора.
[23.12.21 13:41:36] elroy:		Там нигде не написано тп сканирования
[23.12.21 13:41:52] elroy:		Вообще как-то ситали что там статика
[23.12.21 13:43:00] allen:		Не похоже. Потому что dyncheck и avcheck показывают одинаковые результаты в динамике...
[23.12.21 13:58:09] allen:		Не вижу
[23.12.21 13:58:34] allen:		Сообщения
[23.12.21 14:04:04] elroy:		Странно, я не писал ничего вроде
[23.12.21 14:04:39] elroy:		Я вижу свои пустые сообщения, но не помню чтобы что-то писал.....
[23.12.21 14:05:05] elroy:		По делу сказать мне нечего. Считали что авчек смотрит статику...
[24.12.21 14:09:19] elroy:		Приветствую
[24.12.21 14:18:21] elroy:		Напиши
[24.12.21 14:20:33] allen:		Чего написать?
[24.12.21 14:20:56] elroy:		В гит ничего не пуш
[24.12.21 14:21:08] elroy:		Коммиты локально делай, но в гит не пуш!
[24.12.21 14:21:20] allen:		Понял
[06.01.22 09:54:48] elroy:		Приветствую
[06.01.22 09:55:29] allen:		Привет. Я на чистке.
[06.01.22 09:55:39] elroy:		Это хорошо)
[06.01.22 09:55:46] elroy:		Восстановили билд-сервер
[06.01.22 09:56:02] elroy:		Добавь пожалуйста профили
[06.01.22 09:56:20] elroy:		В дженкинсе я делал шаблон, на основе него добавляется.
[06.01.22 09:56:36] elroy:		Орвал скидывал доступ?
[06.01.22 09:56:40] allen:		Понял. Сделаю.
[06.01.22 09:56:47] allen:		Да.
[06.01.22 09:56:54] elroy:		Хорошо
[06.01.22 09:57:16] allen:		А как бы я залил туда свой код?
[06.01.22 09:57:44] elroy:		Если добавть профили сегодня, как есть, можно завтра последний день недели устроить свободный график
[06.01.22 09:58:17] allen:		Это понятно.
[06.01.22 09:58:23] elroy:		ок
[10.01.22 11:16:20] allen:		Привет
[10.01.22 11:16:37] elroy:		Приветствую
[10.01.22 11:16:44] allen:		С праздниками.
[10.01.22 11:16:50] elroy:		И тебя )
[10.01.22 11:17:07] allen:		Я не могу залогиниться в Дженкинс....
[10.01.22 11:17:36] allen:		Ни один и присланных Orval паролей не работает.
[10.01.22 11:18:11] elroy:		Именно не подходит или что-то иное происходит?
[10.01.22 11:18:52] allen:		Похоже, не подходит.
[10.01.22 11:19:56] elroy:		Ок, я посмотрю
[10.01.22 12:51:14] elroy:		Сменить пароль?
[10.01.22 12:51:37] elroy:		Или просто после авторизации страница недоступна?
[10.01.22 12:57:57] allen:		После авторизации страница недоступна.
[10.01.22 12:58:30] allen:		Попытка соединения не удалась. Пишет.
[10.01.22 13:32:25] elroy:		Все правильно. Там просто дженкинс открывает http, вместо https, поэтому падает. Там доступен только https. Решение такое, что когда он так падает, просто в адресе дописываем https:// и энтер
[10.01.22 13:32:46] elroy:		Я админам об этом говорил, пока что-то тихо
[11.01.22 08:09:46] allen:		Привет.
[11.01.22 08:10:16] allen:		Привет
[11.01.22 08:10:28] elroy:		Приветствую
[11.01.22 08:11:39] allen:		Дженкинс по-прежнему барахлит. Проблема с гитом. Он выдает:
```
Failed to connect to repository : Command "git ls-remote -h -- http://xwn22msnqp22pjyez6a4y5w5p4lbhlwvi6c3bd3g42ai4qke6ikmtdyd.onion/user3/project3.git HEAD" returned status code 128:
stdout:
stderr: fatal: unable to access 'http://xwn22msnqp22pjyez6a4y5w5p4lbhlwvi6c3bd3g42ai4qke6ikmtdyd.onion/user3/project3.git/': Could not resolve host: xwn22msnqp22pjyez6a4y5w5p4lbhlwvi6c3bd3g42ai4qke6ikmtdyd.onion
```
[11.01.22 08:11:57] allen:		Что туда надо прописать?
[11.01.22 08:13:03] elroy:		1) Просил не писать в этот чат линки никакие. Нас недавно взломали, эта информация в чате помогает тем кто нас взламывает.
[11.01.22 08:13:16] elroy:		2). Говорил, что то что там прописано - это правильно
[11.01.22 08:13:28] allen:		Мы же по OTR...
[11.01.22 08:14:12] elroy:		Я сейчас скопирую еще раз профиль рабочий, это правильный. И адрес там будет прописан правильный, не смотря даже на ошибку, что он будет показывать.
[11.01.22 08:14:34] allen:		Понял.
[11.01.22 08:19:16] elroy:		Готово. Путсь адрес прописанный тебя не смущает, он во время билда будет работать.
[11.01.22 08:21:30] allen:		Понял
[11.01.22 09:41:17] allen:		Профили готовы. Продолжаю чистку криптора для x86 и x64.
[11.01.22 09:41:44] allen:		Профили готовы. Продолжаю чистку криптора для x86 и x64.
[11.01.22 09:43:49] elroy:		Ок, посмотрю
[11.01.22 09:45:24] elroy:		Там был параметр test
[11.01.22 09:45:30] elroy:		Типа параметра - файл
[11.01.22 09:45:48] elroy:		Похоже ты его убрал. Это сам файл.
[11.01.22 09:45:53] elroy:		Из-за этого не билдится
[11.01.22 09:46:31] allen:		Понял. Вернуть взад?
[11.01.22 09:46:46] elroy:		Да, тип параметра File
[11.01.22 10:16:08] allen:		Вернул.
[11.01.22 10:16:39] elroy:		Спасибо)
[13.01.22 09:58:36] allen:		Привет. У меня утилита не просто редактирует RICH - она его вытирает полностью. Причем пустое место вместо RICH заголовка пересохраняется в межсекционном пространстве.
[13.01.22 10:02:29] elroy:		Я помню. Беда только в том, что это дает детект...
[13.01.22 10:02:38] elroy:		Или не дает?
[13.01.22 10:02:44] elroy:		Приветствую
[13.01.22 10:18:26] allen:		Моя чистка не дает.
[13.01.22 10:22:08] elroy:		Если уверен, то используй свой вариант.
[13.01.22 10:25:17] allen:		Я его и использую. У меня проблема детектов по тому, что защита от АВ единственная стоит: создаю именной мьютекс. И если он успешно создан, перезапускаю крипт. Но перед этим надо бы потестить на наличие АВ. Причем не старые варианты тестов (они уже не работают), а новые. Вопрос, какие.
[13.01.22 10:37:12] elroy:		Имеешь введу избавиться от детекта по эмуляции?
[13.01.22 10:37:36] allen:		Да.
[13.01.22 10:38:54] elroy:		Самый простой способ запросить какое-то значение, которое точно будет тебе известно (что вернется оно). Заетм подставить его в указатель и вызвать. Так как ты точно знаешь какое значение вернется - то вызов пройдет правильно. А эмулятор сделает некорректный вызов. т.к. он не все ответы из системы эмулирует.
[13.01.22 10:40:17] elroy:		Не должно быть проверки условия типа "если в ответ это, то идем сюда, если нет - сюда". Продвинутые эмуляторы, в чтом числе есет, они идут по дву еткам сразу...
[13.01.22 10:47:58] allen:		Это у меня сделано с мьютексом. Я ассембоере вызываю CreateMutex, затем сразу GetLastError. Мне известно, что GetLastError в этом случае возвращает либо 0, либо 187. Я добавляю это число к значению на стеке и выхожу. Но возврат происходит на одно и предопределенных адресов.
[13.01.22 10:49:08] elroy:		Попробуй вот просто заменить этот момент чем-то другим. Просто сравнить
[24.01.22 14:49:28] allen:		Похоже на build машине нет FASM или он там не той версии.
[24.01.22 14:50:02] allen:		Не могу посмотреть build log. Файла нет.
[24.01.22 14:50:15] elroy:		Он там есть.. Напиши Орвалу пожалуйста, он теперь криптерами занимается
[31.01.22 09:39:45] allen:		Привет. Я сейчас переписываю крипт. Он будет почти без импорта.
[31.01.22 09:41:16] elroy:		Напиши Мануэлю, там что-то закриптовать надо было
[31.01.22 09:42:02] allen:		Уже.
[02.02.22 16:14:58] elroy:		Приветствую
[02.02.22 16:29:22] allen:		Привет.
[02.02.22 16:31:06] elroy:		отр?
[02.02.22 16:31:25] allen:		Давай
[02.02.22 16:31:57] elroy:		Похоже по криптерам показатели у тебя не очень.
[02.02.22 16:32:13] elroy:		Как-то мало-эффективно получается.
[02.02.22 16:32:33] elroy:		Напиши мне список своих навыков (скилы), я попробую распределить на другой проект.
[02.02.22 16:33:09] allen:		Я его написал, он был эффективен. Сейчас пришло время менять стратегию.
[02.02.22 16:33:44] allen:		Скиллы = ASM + C/C++
[02.02.22 16:36:25] elroy:		ок, попробую
[02.02.22 16:36:35] elroy:		Ты сам согласен сменить проект?
[02.02.22 16:37:39] allen:		Согласен. Криптеры задолбали, честно сказать.
[03.02.22 07:47:31] allen:		Привет
[03.02.22 07:47:55] elroy:		Приветствую
[03.02.22 07:47:58] allen:		Так какой проект ты мне предложишь?
[03.02.22 07:48:44] elroy:		Пока в списке на распределение. Сейчас согласовываются вообще все проекты, после этого распределю
[03.02.22 07:49:11] allen:		Хорошо. Жду.
[03.02.22 07:49:38] elroy:		Пока работай над криптером, как только смогу распределить - сообщу
[03.02.22 07:49:50] allen:		Понял.
[14.02.22 13:01:24] allen:		Привет. Вчера залил свой комп чаем. Пока все установил на другой, прошло время.
[14.02.22 13:01:50] elroy:		Приветствую. Жаль...
[14.02.22 13:01:56] elroy:		Вопрос такой
[14.02.22 13:02:09] elroy:		команда cpuid серийник процессора возвращает?
[14.02.22 13:02:23] allen:		Теперь вечером отдам в ремонт.
[14.02.22 13:02:40] allen:		Да, вроде.
[14.02.22 13:03:48] elroy:		Черкани прогу, которая черех эту команду получит и покажет (любом способом) серийник проца.
[14.02.22 14:35:12] allen:		Написал. Вот мои CPUID:
CPUID: on input eax=00000000 on output eax=00000016, ebx=756E6547, ecx=6C65746E, edx=49656E69
CPUID: on input eax=00000001 on output eax=000806EC, ebx=00100800, ecx=7FFAFBFF, edx=BFEBFBFF
CPUID: on input eax=00000002 on output eax=76036301, ebx=00F0B5FF, ecx=00000000, edx=00C30000
CPUID: on input eax=00000003 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000004 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000005 on output eax=00000040, ebx=00000040, ecx=00000003, edx=11142120
CPUID: on input eax=00000006 on output eax=000027F7, ebx=00000002, ecx=00000009, edx=00000000
CPUID: on input eax=00000007 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000008 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000009 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=0000000A on output eax=07300404, ebx=00000000, ecx=00000000, edx=00000603
CPUID: on input eax=0000000B on output eax=00000000, ebx=00000000, ecx=00000058, edx=00000000
CPUID: on input eax=0000000C on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=0000000D on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=0000000E on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=0000000F on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000010 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000011 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000012 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000013 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000014 on output eax=00000000, ebx=00000000, ecx=00000000, edx=00000000
CPUID: on input eax=00000015 on output eax=00000002, ebx=000000B8, ecx=00000000, edx=00000000
[14.02.22 14:54:55] elroy:		отр?
[14.02.22 15:03:40] elroy:		Это ты прогнал получается инструкцию cpuid с параметрами в eax от 0 до 0x15
[14.02.22 15:03:46] elroy:		Это конечно нтересно...
[14.02.22 15:04:44] elroy:		Мне интересен номер цп, его серийник. Только пожалуйста, не пости публично тут.
[14.02.22 15:05:00] allen:		При первом запуске с eax==0 в eax возвращается значение максимума для eax.
[14.02.22 15:05:00] elroy:		Его то ли в биосе можно найти, то ли софтом
[14.02.22 15:06:10] allen:		Так в чем проблема с cpuid?
[14.02.22 15:08:02] elroy:		Как-то не то
[14.02.22 15:08:02] elroy:		у cpuid большое назначение
[14.02.22 15:08:02] elroy:		Там и имя возвращается
[14.02.22 15:08:03] elroy:		И фичи
[14.02.22 15:08:03] elroy:		А мне нужен именно серийник
[14.02.22 15:10:23] allen:		Нет cpuid это:

```
2.1	EAX=0: Highest Function Parameter and Manufacturer ID
2.2	EAX=1: Processor Info and Feature Bits
2.3	EAX=2: Cache and TLB Descriptor information
2.4	EAX=3: Processor Serial Number
2.5	EAX=4 and EAX=Bh: Intel thread/core and cache topology
2.6	EAX=6: Thermal and power management
2.7	EAX=7, ECX=0: Extended Features
2.8	EAX=7, ECX=1: Extended Features
2.9	EAX=80000000h: Get Highest Extended Function Implemented
2.10	EAX=80000001h: Extended Processor Info and Feature Bits
2.11	EAX=80000002h,80000003h,80000004h: Processor Brand String
2.12	EAX=80000005h: L1 Cache and TLB Identifiers
2.13	EAX=80000006h: Extended L2 Cache Features
2.14	EAX=80000007h: Advanced Power Management Information
2.15	EAX=80000008h: Virtual and Physical address Sizes
2.16	EAX=8FFFFFFFh: AMD Easter Egg
```
[14.02.22 15:11:37] elroy:		EAX=3: Processor Serial Number
[14.02.22 15:11:47] allen:		По этим данным серийник возвращается при eax == 3
[14.02.22 15:12:16] allen:		Но не всегда. Как видишь у меня в этом случае все нули.
[14.02.22 15:13:08] elroy:		Мог бы ты запустить программу от имени администратора и глянуть вернет ли ID, и еще, сделать тоже самое на виртуалке
[14.02.22 15:13:29] elroy:		?
[14.02.22 15:14:02] allen:		EAX=3: Processor Serial Number
See also: Pentium III § Controversy about privacy issues
This returns the processor's serial number. The processor serial number was introduced on Intel Pentium III, but due to privacy concerns, this feature is no longer implemented on later models (the PSN feature bit is always cleared). Transmeta's Efficeon and Crusoe processors also provide this feature. AMD CPUs however, do not implement this feature in any CPU models.

For Intel Pentium III CPUs, the serial number is returned in the EDX:ECX registers. For Transmeta Efficeon CPUs, it is returned in the EBX:EAX registers. And for Transmeta Crusoe CPUs, it is returned in the EBX register only.

Note that the processor serial number feature must be enabled in the BIOS setting in order to function.
[14.02.22 15:15:00] allen:		Должен быть включена в биосе. У меня видимо отключена.
[14.02.22 15:15:22] elroy:		Ясно
[14.02.22 15:16:12] elroy:		Я все понял, спасибо. тут написано что версии моложе пентиума 3 уже не имеют фичи
[14.02.22 15:16:48] allen:		Это тоже
